
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>Fermions and the Jordan-Wigner transformation &#8212; TeNPy 0.4.1 documentation</title>
    <link rel="stylesheet" href="_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/language_data.js"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <link rel="shortcut icon" href="_static/logo.ico"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Contributing" href="contributing.html" />
    <link rel="prev" title="Introduction to models" href="intro_model.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="contributing.html" title="Contributing"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="intro_model.html" title="Introduction to models"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">TeNPy 0.4.1 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="userguide.html" accesskey="U">User Guide</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="fermions-and-the-jordan-wigner-transformation">
<h1>Fermions and the Jordan-Wigner transformation<a class="headerlink" href="#fermions-and-the-jordan-wigner-transformation" title="Permalink to this headline">¶</a></h1>
<p>The <a class="reference external" href="https://en.wikipedia.org/wiki/Jordan-Wigner_transformation">Jordan-Wigner tranformation</a>
maps fermionic creation- and annihilation operators to (bosonic) spin-operators.</p>
<div class="section" id="spinless-fermions-in-1d">
<h2>Spinless fermions in 1D<a class="headerlink" href="#spinless-fermions-in-1d" title="Permalink to this headline">¶</a></h2>
<p>Let’s start by explicitly writing down the transformation.
With the Pauli matrices <span class="math notranslate nohighlight">\(\sigma^{x,y,z}_j\)</span> and <span class="math notranslate nohighlight">\(\sigma^{\pm}_j = (\sigma^x_j \pm \mathrm{i} \sigma^y_j)/2\)</span> on each site,
we can map</p>
<div class="math notranslate nohighlight">
\[\begin{split}n_j         &amp;\leftrightarrow (\sigma^{z}_j + 1)/2        \\
c_j         &amp;\leftrightarrow (-1)^{\sum_{l &lt; j} n_l} \sigma^{-}_j             \\
c_j^\dagger &amp;\leftrightarrow (-1)^{\sum_{l &lt; j} n_l} \sigma^{+}_j\end{split}\]</div>
<p>The <span class="math notranslate nohighlight">\(n_l\)</span> in the second and third row are defined in terms of Pauli matrices according to the first row.
We do not interpret the Pauli matrices as spin-1/2; they have nothing to do with the spin in the spin-full case.
If you really want to interpret them physically, you might better think of them as hard-core bosons
(<span class="math notranslate nohighlight">\(b_j =\sigma^{-}_j, b^\dagger_j=\sigma^{+}_j\)</span>),
with a spin of the fermions mapping to a spin of the hard-core bosons.</p>
<p>Note that this transformation maps the fermionic operators <span class="math notranslate nohighlight">\(c_j\)</span> and <span class="math notranslate nohighlight">\(c^\dagger_j\)</span> to <em>global</em> operators; although they carry an index <cite>j</cite> indicating
a site, they actually act on all sites <code class="docutils literal notranslate"><span class="pre">l</span> <span class="pre">&lt;=</span> <span class="pre">j</span></code>!
Thus, clearly the operators <code class="docutils literal notranslate"><span class="pre">C</span></code> and <code class="docutils literal notranslate"><span class="pre">Cd</span></code> defined in the <a class="reference internal" href="reference/tenpy.networks.site.FermionSite.html#tenpy.networks.site.FermionSite" title="tenpy.networks.site.FermionSite"><code class="xref py py-class docutils literal notranslate"><span class="pre">FermionSite</span></code></a> do <em>not</em> directly correspond to <span class="math notranslate nohighlight">\(c_j\)</span> and
<span class="math notranslate nohighlight">\(c^\dagger_j\)</span>.
The part <span class="math notranslate nohighlight">\((-1)^{\sum_{l &lt; j} n_l}\)</span> is called Jordan-Wigner string and in the <a class="reference internal" href="reference/tenpy.networks.site.FermionSite.html#tenpy.networks.site.FermionSite" title="tenpy.networks.site.FermionSite"><code class="xref py py-class docutils literal notranslate"><span class="pre">FermionSite</span></code></a> is given by the local operator
<span class="math notranslate nohighlight">\(JW := (-1)^{n_l}\)</span> acting all sites <code class="docutils literal notranslate"><span class="pre">l</span> <span class="pre">&lt;</span> <span class="pre">j</span></code>.
Since this important, let me stress it again:</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The fermionic operator <span class="math notranslate nohighlight">\(c_j\)</span> (and similar <span class="math notranslate nohighlight">\(c^\dagger_j\)</span>) maps to a <em>global</em> operator consisting of
the Jordan-Wigner string built by the local operator <code class="docutils literal notranslate"><span class="pre">JW</span></code> on sites <code class="docutils literal notranslate"><span class="pre">l</span> <span class="pre">&lt;</span> <span class="pre">j</span></code> <em>and</em> the local operator <code class="docutils literal notranslate"><span class="pre">C</span></code> (or <code class="docutils literal notranslate"><span class="pre">Cd</span></code>, respectively) on site <code class="docutils literal notranslate"><span class="pre">j</span></code>.</p>
</div>
<p>On the sites itself, the onsite operators <code class="docutils literal notranslate"><span class="pre">C</span></code> and <code class="docutils literal notranslate"><span class="pre">Cd</span></code> in the <a class="reference internal" href="reference/tenpy.networks.site.FermionSite.html#tenpy.networks.site.FermionSite" title="tenpy.networks.site.FermionSite"><code class="xref py py-class docutils literal notranslate"><span class="pre">FermionSite</span></code></a> fulfill the correct anti-commutation relation, without the need to include <code class="docutils literal notranslate"><span class="pre">JW</span></code> strings.
The <code class="docutils literal notranslate"><span class="pre">JW</span></code> string is necessary to ensure the anti-commutation for operators acting on different sites.</p>
<p>Written in terms of <cite>onsite</cite> operators defined in the <a class="reference internal" href="reference/tenpy.networks.site.FermionSite.html#tenpy.networks.site.FermionSite" title="tenpy.networks.site.FermionSite"><code class="xref py py-class docutils literal notranslate"><span class="pre">FermionSite</span></code></a>,
with the <cite>i</cite>-th entry entry in the list acting on site <cite>i</cite>, the relations are thus:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="s2">&quot;JW&quot;</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="s2">&quot;JW&quot;</span><span class="p">,</span> <span class="s2">&quot;C&quot;</span><span class="p">,</span>  <span class="s2">&quot;Id&quot;</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="s2">&quot;Id&quot;</span><span class="p">]</span>   <span class="c1"># for the annihilation operator</span>
<span class="p">[</span><span class="s2">&quot;JW&quot;</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="s2">&quot;JW&quot;</span><span class="p">,</span> <span class="s2">&quot;Cd&quot;</span><span class="p">,</span> <span class="s2">&quot;Id&quot;</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="s2">&quot;Id&quot;</span><span class="p">]</span>   <span class="c1"># for the creation operator</span>
</pre></div>
</div>
<p>Note that <code class="docutils literal notranslate"><span class="pre">&quot;JW&quot;</span></code> squares to the identity, <code class="docutils literal notranslate"><span class="pre">&quot;JW</span> <span class="pre">JW&quot;</span> <span class="pre">==</span> <span class="pre">&quot;Id&quot;</span></code>,
which is the reason that the Jordan-wigner string completely cancels in <span class="math notranslate nohighlight">\(n_j = c^\dagger_j c_j\)</span>.
In the above notation, this can be written as:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="s2">&quot;JW&quot;</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="s2">&quot;JW&quot;</span><span class="p">,</span> <span class="s2">&quot;Cd&quot;</span><span class="p">,</span>  <span class="s2">&quot;Id&quot;</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="s2">&quot;Id&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="p">[</span><span class="s2">&quot;JW&quot;</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="s2">&quot;JW&quot;</span><span class="p">,</span> <span class="s2">&quot;C&quot;</span><span class="p">,</span> <span class="s2">&quot;Id&quot;</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="s2">&quot;Id&quot;</span><span class="p">]</span>
<span class="o">==</span> <span class="p">[</span><span class="s2">&quot;JW JW&quot;</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="s2">&quot;JW JW&quot;</span><span class="p">,</span> <span class="s2">&quot;Cd C&quot;</span><span class="p">,</span>  <span class="s2">&quot;Id Id&quot;</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="s2">&quot;Id Id&quot;</span><span class="p">]</span>      <span class="c1"># by definition of the tensorproduct</span>
<span class="o">==</span> <span class="p">[</span><span class="s2">&quot;Id&quot;</span><span class="p">,</span>    <span class="o">...</span><span class="p">,</span> <span class="s2">&quot;Id&quot;</span><span class="p">,</span>    <span class="s2">&quot;N&quot;</span><span class="p">,</span>     <span class="s2">&quot;Id&quot;</span><span class="p">,</span>    <span class="o">...</span><span class="p">,</span> <span class="s2">&quot;Id&quot;</span><span class="p">]</span>         <span class="c1"># by definition of the local operators</span>
<span class="c1"># (&quot;X Y&quot; stands for the local operators X and Y applied on the same site. We assume that the &quot;Cd&quot; and &quot;C&quot; on the first line act on the same site.)</span>
</pre></div>
</div>
<p>For a pair of operators acting on different sites, <code class="docutils literal notranslate"><span class="pre">JW</span></code> strings have to be included for every site between the operators.
For example, taking <code class="docutils literal notranslate"><span class="pre">i</span> <span class="pre">&lt;</span> <span class="pre">j</span></code>,
<span class="math notranslate nohighlight">\(c^\dagger_i c_j \leftrightarrow \sigma_i^{+} (-1)^{\sum_{i &lt;=l &lt; j} n_l}  \sigma_j^{-}\)</span>.
More explicitly, for <code class="docutils literal notranslate"><span class="pre">j</span> <span class="pre">=</span> <span class="pre">i+2</span></code> we get:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="s2">&quot;JW&quot;</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="s2">&quot;JW&quot;</span><span class="p">,</span> <span class="s2">&quot;Cd&quot;</span><span class="p">,</span> <span class="s2">&quot;Id&quot;</span><span class="p">,</span> <span class="s2">&quot;Id&quot;</span><span class="p">,</span> <span class="s2">&quot;Id&quot;</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="s2">&quot;Id&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="p">[</span><span class="s2">&quot;JW&quot;</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="s2">&quot;JW&quot;</span><span class="p">,</span> <span class="s2">&quot;JW&quot;</span><span class="p">,</span> <span class="s2">&quot;JW&quot;</span><span class="p">,</span> <span class="s2">&quot;C&quot;</span><span class="p">,</span> <span class="s2">&quot;Id&quot;</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="s2">&quot;Id&quot;</span><span class="p">]</span>
<span class="o">==</span> <span class="p">[</span><span class="s2">&quot;JW JW&quot;</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="s2">&quot;JW JW&quot;</span><span class="p">,</span> <span class="s2">&quot;Cd JW&quot;</span><span class="p">,</span>  <span class="s2">&quot;Id JW&quot;</span><span class="p">,</span> <span class="s2">&quot;Id C&quot;</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="s2">&quot;Id&quot;</span><span class="p">]</span>
<span class="o">==</span> <span class="p">[</span><span class="s2">&quot;Id&quot;</span><span class="p">,</span>    <span class="o">...</span><span class="p">,</span> <span class="s2">&quot;Id&quot;</span><span class="p">,</span>    <span class="s2">&quot;Cd JW&quot;</span><span class="p">,</span>  <span class="s2">&quot;JW&quot;</span><span class="p">,</span>    <span class="s2">&quot;C&quot;</span><span class="p">,</span>    <span class="o">...</span><span class="p">,</span> <span class="s2">&quot;Id&quot;</span><span class="p">]</span>
</pre></div>
</div>
<p>In other words, the Jordan-Wigner string appears only in the range <code class="docutils literal notranslate"><span class="pre">i</span> <span class="pre">&lt;=</span> <span class="pre">l</span> <span class="pre">&lt;</span> <span class="pre">j</span></code>, i.e. between the two sites <em>and</em> on the smaller/left one of them.
(You can easily generalize this rule to cases with more than two <span class="math notranslate nohighlight">\(c\)</span> or <span class="math notranslate nohighlight">\(c^\dagger\)</span>.)</p>
<p>This last line (as well as the last line of the previous example) can be rewritten by changing the order of the operators <code class="docutils literal notranslate"><span class="pre">Cd</span> <span class="pre">JW</span></code> to <code class="docutils literal notranslate"><span class="pre">&quot;JW</span> <span class="pre">Cd&quot;</span> <span class="pre">==</span> <span class="pre">-</span> <span class="pre">&quot;Cd&quot;</span></code>.
(This is valid because either site <code class="docutils literal notranslate"><span class="pre">i</span></code> is occupied, yielding a minus sign from the <code class="docutils literal notranslate"><span class="pre">JW</span></code>, or it is empty, yielding a 0 from the <code class="docutils literal notranslate"><span class="pre">Cd</span></code>.)</p>
<p>This is also the case for <code class="docutils literal notranslate"><span class="pre">j</span> <span class="pre">&lt;</span> <span class="pre">i</span></code>, say <code class="docutils literal notranslate"><span class="pre">j</span> <span class="pre">=</span> <span class="pre">i-2</span></code>:
<span class="math notranslate nohighlight">\(c^\dagger_i c_j \leftrightarrow (-1)^{\sum_{j &lt;=l &lt; i} n_l} \sigma_i^{+} \sigma_j^{-}\)</span>.
As shown in the following, the <code class="docutils literal notranslate"><span class="pre">JW</span></code> again appears on the left site,
but this time acting <em>after</em> <code class="docutils literal notranslate"><span class="pre">C</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="s2">&quot;JW&quot;</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="s2">&quot;JW&quot;</span><span class="p">,</span> <span class="s2">&quot;JW&quot;</span><span class="p">,</span> <span class="s2">&quot;JW&quot;</span><span class="p">,</span> <span class="s2">&quot;Cd&quot;</span><span class="p">,</span> <span class="s2">&quot;Id&quot;</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="s2">&quot;Id&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="p">[</span><span class="s2">&quot;JW&quot;</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="s2">&quot;JW&quot;</span><span class="p">,</span> <span class="s2">&quot;C&quot;</span><span class="p">,</span> <span class="s2">&quot;Id&quot;</span><span class="p">,</span> <span class="s2">&quot;Id&quot;</span><span class="p">,</span> <span class="s2">&quot;Id&quot;</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="s2">&quot;Id&quot;</span><span class="p">]</span>
<span class="o">==</span> <span class="p">[</span><span class="s2">&quot;JW JW&quot;</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="s2">&quot;JW JW&quot;</span><span class="p">,</span> <span class="s2">&quot;JW C&quot;</span><span class="p">,</span>  <span class="s2">&quot;JW&quot;</span><span class="p">,</span> <span class="s2">&quot;Cd Id&quot;</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="s2">&quot;Id&quot;</span><span class="p">]</span>
<span class="o">==</span> <span class="p">[</span><span class="s2">&quot;Id&quot;</span><span class="p">,</span>    <span class="o">...</span><span class="p">,</span> <span class="s2">&quot;Id&quot;</span><span class="p">,</span>    <span class="s2">&quot;JW C&quot;</span><span class="p">,</span>  <span class="s2">&quot;JW&quot;</span><span class="p">,</span> <span class="s2">&quot;Cd&quot;</span><span class="p">,</span>    <span class="o">...</span><span class="p">,</span> <span class="s2">&quot;Id&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="section" id="higher-dimensions">
<h2>Higher dimensions<a class="headerlink" href="#higher-dimensions" title="Permalink to this headline">¶</a></h2>
<p>For an MPO or MPS, you always have to define an ordering of all your sites. This ordering effectifely maps the
higher-dimensional lattice to a 1D chain, usually at the expence of long-range hopping/interactions.
With this mapping, the Jordan-Wigner transformation generalizes to higher dimensions in a straight-forward way.</p>
</div>
<div class="section" id="spinful-fermions">
<h2>Spinful fermions<a class="headerlink" href="#spinful-fermions" title="Permalink to this headline">¶</a></h2>
<img alt="_images/JordanWignerSpinHalf.png" src="_images/JordanWignerSpinHalf.png" />
<p>As illustrated in the above picture, you can think of spin-1/2 fermions on a chain as spinless fermions living on a ladder (and analogous mappings for higher dimensional lattices).
Each rung (a blue box in the picture) forms a <a class="reference internal" href="reference/tenpy.networks.site.SpinHalfFermionSite.html#tenpy.networks.site.SpinHalfFermionSite" title="tenpy.networks.site.SpinHalfFermionSite"><code class="xref py py-class docutils literal notranslate"><span class="pre">SpinHalfFermionSite</span></code></a>
which is composed of two <a class="reference internal" href="reference/tenpy.networks.site.FermionSite.html#tenpy.networks.site.FermionSite" title="tenpy.networks.site.FermionSite"><code class="xref py py-class docutils literal notranslate"><span class="pre">FermionSite</span></code></a> (the circles in the picture) for spin-up and spin-down.
The mapping of the spin-1/2 fermions onto the ladder induces an ordering of the spins, as the final result must again be a one-dimensional chain, now containing both spin species.
The solid line indicates the convention for the ordering, the dashed lines indicate spin-preserving hopping <span class="math notranslate nohighlight">\(c^\dagger_{s,i} c_{s,i+1} + h.c.\)</span>
and visualize the ladder structure.
More generally, each species of fermions appearing in your model gets a separate label, and its Jordan-Wigner string
includes the signs <span class="math notranslate nohighlight">\((-1)^{n_l}\)</span> of <em>all</em> species of fermions to the ‘left’ of it (in the sense of the ordering indicated by the solid line in the picture).</p>
<p>In the case of spin-1/2 fermions labeled by <span class="math notranslate nohighlight">\(\uparrow\)</span> and <span class="math notranslate nohighlight">\(\downarrow\)</span> on each <cite>site</cite>, the complete mapping is given (where <cite>j</cite> and <cite>l</cite> are indices of the <a class="reference internal" href="reference/tenpy.networks.site.FermionSite.html#tenpy.networks.site.FermionSite" title="tenpy.networks.site.FermionSite"><code class="xref py py-class docutils literal notranslate"><span class="pre">FermionSite</span></code></a>):</p>
<div class="math notranslate nohighlight">
\[\begin{split}n_{\uparrow,j} &amp;\leftrightarrow (\sigma^{z}_{\uparrow,j} + 1)/2                                                                                  \\
n_{\downarrow,j} &amp;\leftrightarrow (\sigma^{z}_{\downarrow,j} + 1)/2                                                                              \\
c_{\uparrow,j} &amp;\leftrightarrow (-1)^{\sum_{l &lt; j} n_{\uparrow,l} + n_{\downarrow,l}} \sigma^{-}_{\uparrow,j}                                    \\
c^\dagger_{\uparrow,j} &amp;\leftrightarrow (-1)^{\sum_{l &lt; j} n_{\uparrow,l} + n_{\downarrow,l}} \sigma^{+}_{\uparrow,j}                           \\
c_{\downarrow,j} &amp;\leftrightarrow (-1)^{\sum_{l &lt; j} n_{\uparrow,l} + n_{\downarrow,l}} (-1)^{n_{\uparrow,j}} \sigma^{-}_{\downarrow,j}          \\
c^\dagger_{\downarrow,j} &amp;\leftrightarrow (-1)^{\sum_{l &lt; j} n_{\uparrow,l} + n_{\downarrow,l}} (-1)^{n_{\uparrow,j}} \sigma^{+}_{\downarrow,j} \\\end{split}\]</div>
<p>In each of the above mappings the operators on the right hand sides commute; we can rewrite
<span class="math notranslate nohighlight">\((-1)^{\sum_{l &lt; j} n_{\uparrow,l} + n_{\downarrow,l}} = \prod_{l &lt; j} (-1)^{n_{\uparrow,l}} (-1)^{n_{\downarrow,l}}\)</span>,
which resembles the actual structure in the code more closely.
The parts of the operator acting in the same box of the picture, i.e. which have the same index <cite>j</cite> or <cite>l</cite>,
are the ‘onsite’ operators in the <a class="reference internal" href="reference/tenpy.networks.site.SpinHalfFermionSite.html#tenpy.networks.site.SpinHalfFermionSite" title="tenpy.networks.site.SpinHalfFermionSite"><code class="xref py py-class docutils literal notranslate"><span class="pre">SpinHalfFermionSite</span></code></a>:
for example <code class="docutils literal notranslate"><span class="pre">JW</span></code> on site <cite>j</cite> is given by <span class="math notranslate nohighlight">\((-1)^{n_{\uparrow,j}} (-1)^{n_{\downarrow,j}}\)</span>,
<code class="docutils literal notranslate"><span class="pre">Cu</span></code> is just the <span class="math notranslate nohighlight">\(\sigma^{-}_{\uparrow,j}\)</span>, <code class="docutils literal notranslate"><span class="pre">Cdu</span></code> is <span class="math notranslate nohighlight">\(\sigma^{+}_{\uparrow,j}\)</span>,
<code class="docutils literal notranslate"><span class="pre">Cd</span></code> is <span class="math notranslate nohighlight">\((-1)^{n_{\uparrow,j}} \sigma^{-}_{\downarrow,j}\)</span>.
and <code class="docutils literal notranslate"><span class="pre">Cdd</span></code> is <span class="math notranslate nohighlight">\((-1)^{n_{\uparrow,j}} \sigma^{+}_{\downarrow,j}\)</span>.
Note the asymmetry regarding the spin in the definition of the onsite operators:
the spin-down operators include Jordan-Wigner signs for the spin-up fermions on the same site.
This asymetry stems from the ordering convention introduced by the solid line in the picture, according to which the spin-up site
is “left” of the spin-down site. With the above definition, the operators within the same <a class="reference internal" href="reference/tenpy.networks.site.SpinHalfFermionSite.html#tenpy.networks.site.SpinHalfFermionSite" title="tenpy.networks.site.SpinHalfFermionSite"><code class="xref py py-class docutils literal notranslate"><span class="pre">SpinHalfFermionSite</span></code></a> fulfill the expected commutation relations,
for example <code class="docutils literal notranslate"><span class="pre">&quot;Cu</span> <span class="pre">Cdd&quot;</span> <span class="pre">==</span> <span class="pre">-</span> <span class="pre">&quot;Cdd</span> <span class="pre">Cu&quot;</span></code>, but again the <code class="docutils literal notranslate"><span class="pre">JW</span></code> on sites left of the operator pair is crucial to get the correct
commutation relations globally.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Again, the fermionic operators <span class="math notranslate nohighlight">\(c_{\downarrow,j}, c^\dagger_{\downarrow,j}, c_{\downarrow,j}, c^\dagger_{\downarrow,j}\)</span> correspond to  <em>global</em> operators consisting of
the Jordan-Wigner string built by the local operator <code class="docutils literal notranslate"><span class="pre">JW</span></code> on sites <code class="docutils literal notranslate"><span class="pre">l</span> <span class="pre">&lt;</span> <span class="pre">j</span></code> <em>and</em> the local operators <code class="docutils literal notranslate"><span class="pre">'Cu',</span> <span class="pre">'Cdu',</span> <span class="pre">'Cd',</span> <span class="pre">'Cdd'</span></code> on site <code class="docutils literal notranslate"><span class="pre">j</span></code>.</p>
</div>
<p>Written explicitly in terms of onsite operators defined in the <code class="xref py py-class docutils literal notranslate"><span class="pre">FermionSite</span></code>,
with the <cite>j</cite>-th entry entry in the list acting on site <cite>j</cite>, the relations are:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="s2">&quot;JW&quot;</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="s2">&quot;JW&quot;</span><span class="p">,</span> <span class="s2">&quot;Cu&quot;</span><span class="p">,</span>  <span class="s2">&quot;Id&quot;</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="s2">&quot;Id&quot;</span><span class="p">]</span>    <span class="c1"># for the annihilation operator spin-up</span>
<span class="p">[</span><span class="s2">&quot;JW&quot;</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="s2">&quot;JW&quot;</span><span class="p">,</span> <span class="s2">&quot;Cd&quot;</span><span class="p">,</span>  <span class="s2">&quot;Id&quot;</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="s2">&quot;Id&quot;</span><span class="p">]</span>    <span class="c1"># for the annihilation operator spin-down</span>
<span class="p">[</span><span class="s2">&quot;JW&quot;</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="s2">&quot;JW&quot;</span><span class="p">,</span> <span class="s2">&quot;Cdu&quot;</span><span class="p">,</span>  <span class="s2">&quot;Id&quot;</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="s2">&quot;Id&quot;</span><span class="p">]</span>   <span class="c1"># for the creation operator spin-up</span>
<span class="p">[</span><span class="s2">&quot;JW&quot;</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="s2">&quot;JW&quot;</span><span class="p">,</span> <span class="s2">&quot;Cdd&quot;</span><span class="p">,</span>  <span class="s2">&quot;Id&quot;</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="s2">&quot;Id&quot;</span><span class="p">]</span>   <span class="c1"># for the creation operator spin-down</span>
</pre></div>
</div>
<p>As you can see, the asymmetry regaring the spins in the definition of the local onsite operators <code class="docutils literal notranslate"><span class="pre">&quot;Cu&quot;,</span> <span class="pre">&quot;Cd&quot;,</span> <span class="pre">&quot;Cdu&quot;,</span> <span class="pre">&quot;Cdd&quot;</span></code> lead to a symmetric definition in the global sense.
If you look at the definitions very closely, you can see that in terms like <code class="docutils literal notranslate"><span class="pre">[&quot;Id&quot;,</span> <span class="pre">&quot;Cd</span> <span class="pre">JW&quot;,</span> <span class="pre">&quot;JW&quot;,</span> <span class="pre">&quot;Cd&quot;]</span></code> the
Jordan-Wigner sign <span class="math notranslate nohighlight">\((-1)^{n_\uparrow,2}\)</span> appears twice (namely once in the definition of <code class="docutils literal notranslate"><span class="pre">&quot;Cd&quot;</span></code> and once in the <code class="docutils literal notranslate"><span class="pre">&quot;JW&quot;</span></code> on site
2) and could in principle be canceled, however in favor of a simplified handling in the code we do not recommend you to cancel it.
Similar, within a spinless <a class="reference internal" href="reference/tenpy.networks.site.FermionSite.html#tenpy.networks.site.FermionSite" title="tenpy.networks.site.FermionSite"><code class="xref py py-class docutils literal notranslate"><span class="pre">FermionSite</span></code></a>, one can simplify <code class="docutils literal notranslate"><span class="pre">&quot;Cd</span> <span class="pre">JW&quot;</span> <span class="pre">==</span> <span class="pre">&quot;Cd&quot;</span></code> and <code class="docutils literal notranslate"><span class="pre">&quot;JW</span> <span class="pre">C&quot;</span> <span class="pre">==</span> <span class="pre">&quot;C&quot;</span></code>,
but these relations do <em>not</em> hold in the <a class="reference internal" href="reference/tenpy.networks.site.SpinHalfSite.html#tenpy.networks.site.SpinHalfSite" title="tenpy.networks.site.SpinHalfSite"><code class="xref py py-class docutils literal notranslate"><span class="pre">SpinHalfSite</span></code></a>,
and for consistency we recommend to explicitly keep the <code class="docutils literal notranslate"><span class="pre">&quot;JW&quot;</span></code> operator string even in nearest-neighbor models where it is not strictly necessary.</p>
</div>
<div class="section" id="how-to-handle-jordan-wigner-strings-in-practice">
<h2>How to handle Jordan-Wigner strings in practice<a class="headerlink" href="#how-to-handle-jordan-wigner-strings-in-practice" title="Permalink to this headline">¶</a></h2>
<p>There are only a few pitfalls where you have to keep the mapping in mind:
When <strong>building a model</strong>, you map the physical fermionic operators to the usual spin/bosonic operators.
The algorithms don’t care about the mapping, they just use the given Hamiltonian, be it given as MPO for DMRG or as nearest neighbor couplings for TEBD.
Only when you do a <strong>measurement</strong> (e.g. by calculating an expectation value or a correlation function), you have to reverse this mapping.
Be aware that in certain cases, e.g. when calculating the entanglement entropy on a certain bond,
you cannot reverse this mapping (in a straightforward way), and thus your results might depend on how you defined the Jordan-Wigner string.</p>
<p>Whatever you do, you should first think about if (and how much of) the Jordan-Wigner string cancels.
For example for many of the onsite operators (like the particle number operator <code class="docutils literal notranslate"><span class="pre">N</span></code> or the spin operators in the <a class="reference internal" href="reference/tenpy.networks.site.SpinHalfFermionSite.html#tenpy.networks.site.SpinHalfFermionSite" title="tenpy.networks.site.SpinHalfFermionSite"><code class="xref py py-class docutils literal notranslate"><span class="pre">SpinHalfFermionSite</span></code></a>)
the Jordan-Wigner string cancels completely and you can just ignore it both in onsite-terms and couplings.
To check, whether the Jordan-Wigner string cancels for a given operator,
take a look at <code class="xref py py-attr docutils literal notranslate"><span class="pre">need_JW_string</span></code> and <a class="reference internal" href="reference/tenpy.networks.site.Site.html#tenpy.networks.site.Site.op_needs_JW" title="tenpy.networks.site.Site.op_needs_JW"><code class="xref py py-meth docutils literal notranslate"><span class="pre">op_needs_JW()</span></code></a>.
In case of operators acting on different sites, you typically have a Jordan-Wigner string inbetween (e.g. for the
<span class="math notranslate nohighlight">\(c^\dagger_i c_j\)</span> examples described above and below) or no Jordan-Wigner strings at all (e.g. for density-density
interactions <span class="math notranslate nohighlight">\(n_i n_j\)</span>).
In fact, the case that the Jordan Wigner string on the left of the first non-trivial operator does not cancel is currently not supported
for models and expectation values, as it usually doesn’t appear in practice.</p>
<p>When <strong>building a model</strong> with the <a class="reference internal" href="reference/tenpy.models.model.CouplingModel.html#tenpy.models.model.CouplingModel" title="tenpy.models.model.CouplingModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">CouplingModel</span></code></a>,
<em>onsite</em> terms for which the Jordan-Wigner string cancels can be added directly.
Care has to be taken when adding <em>couplings</em> with <a class="reference internal" href="reference/tenpy.models.model.CouplingModel.html#tenpy.models.model.CouplingModel.add_coupling" title="tenpy.models.model.CouplingModel.add_coupling"><code class="xref py py-meth docutils literal notranslate"><span class="pre">add_coupling()</span></code></a>.
When you need a Jordan-Wigner string inbetween the operators, set the optional arguments <code class="docutils literal notranslate"><span class="pre">op_string='JW',</span> <span class="pre">str_on_first=True</span></code>.
Then, the function automatically takes care of the Jordan-Wigner string in the correct way, adding it on the left
operator. With the default arguments, it is checked automatically whether the model</p>
<p>Obviously, you should be careful about the convention which of the two coupling terms is applied first (in a physical
sense as an operator acting on a state), as this corresponds to a sign. We follow the convention that the operator given
as argument <cite>op2</cite> is applied first, independent of wheter it ends up left or right in the MPS ordering sense.</p>
<p>As a concrete example, let us specify a hopping
<span class="math notranslate nohighlight">\(\sum_{\langle i, j\rangle} (c^\dagger_i c_j + h.c.) = \sum_{\langle i, j\rangle} (c^\dagger_i c_j + c^\dagger_j c_i)\)</span>
in a 1D chain of <a class="reference internal" href="reference/tenpy.networks.site.FermionSite.html#tenpy.networks.site.FermionSite" title="tenpy.networks.site.FermionSite"><code class="xref py py-class docutils literal notranslate"><span class="pre">FermionSite</span></code></a> with <a class="reference internal" href="reference/tenpy.models.model.CouplingModel.html#tenpy.models.model.CouplingModel.add_coupling" title="tenpy.models.model.CouplingModel.add_coupling"><code class="xref py py-meth docutils literal notranslate"><span class="pre">add_coupling()</span></code></a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">add_coupling</span><span class="p">(</span><span class="n">strength</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Cd&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;JW&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">add_coupling</span><span class="p">(</span><span class="n">strength</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Cd&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;JW&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
<span class="c1"># (without the last 2 arguments, add_coupling checks for necessary JW strings automatically)</span>
</pre></div>
</div>
<p>Slightly more complicated, to specify the hopping
<span class="math notranslate nohighlight">\(\sum_{\langle i, j\rangle, s} (c^\dagger_{s,i} c_{s,j} + h.c.)\)</span>
in the Fermi-Hubbard model on a 2D square lattice, we would need more terms:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="p">(</span><span class="n">dx</span><span class="p">,</span> <span class="n">dy</span><span class="p">)</span> <span class="ow">in</span> <span class="p">[(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)]:</span>
    <span class="n">add_coupling</span><span class="p">(</span><span class="n">strength</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Cdu&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Cu&#39;</span><span class="p">,</span> <span class="p">(</span><span class="n">dx</span><span class="p">,</span> <span class="n">dy</span><span class="p">),</span> <span class="s1">&#39;JW&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
    <span class="n">add_coupling</span><span class="p">(</span><span class="n">strength</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Cdd&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Cd&#39;</span><span class="p">,</span> <span class="p">(</span><span class="n">dx</span><span class="p">,</span> <span class="n">dy</span><span class="p">),</span> <span class="s1">&#39;JW&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>If you want to build a model directly as an MPO or with nearest-neighbor bonds only, <em>you</em> have to care about how to handle the Jordan-Wigner string correctly.</p>
<p>The most important functions for doing <strong>measurements</strong> are probably <a class="reference internal" href="reference/tenpy.networks.mps.MPS.html#tenpy.networks.mps.MPS.expectation_value" title="tenpy.networks.mps.MPS.expectation_value"><code class="xref py py-meth docutils literal notranslate"><span class="pre">expectation_value()</span></code></a>
and <a class="reference internal" href="reference/tenpy.networks.mps.MPS.html#tenpy.networks.mps.MPS.correlation_function" title="tenpy.networks.mps.MPS.correlation_function"><code class="xref py py-meth docutils literal notranslate"><span class="pre">correlation_function()</span></code></a>. Again, if all the Jordan-Wigner strings cancel, you don’t have
to worry about them at all, e.g. for many onsite operators or correlation functions involving only number operators.
If you measure operators involving multiple sites with <cite>expectation_value</cite>, take care to include the Jordan-Wigner
string correctly while building these operators.</p>
<p>The <a class="reference internal" href="reference/tenpy.networks.mps.MPS.html#tenpy.networks.mps.MPS.correlation_function" title="tenpy.networks.mps.MPS.correlation_function"><code class="xref py py-meth docutils literal notranslate"><span class="pre">correlation_function()</span></code></a> supports a Jordan-Wigner string in between the two operators to
be measured. As for <a class="reference internal" href="reference/tenpy.models.model.CouplingModel.html#tenpy.models.model.CouplingModel.add_coupling" title="tenpy.models.model.CouplingModel.add_coupling"><code class="xref py py-meth docutils literal notranslate"><span class="pre">add_coupling()</span></code></a>, you should set the optional arguments <code class="docutils literal notranslate"><span class="pre">op_string='JW',</span> <span class="pre">str_on_first=True</span></code> in that case.
Functions like <a class="reference internal" href="reference/tenpy.networks.mps.MPS.html#tenpy.networks.mps.MPS.expectation_value_term" title="tenpy.networks.mps.MPS.expectation_value_term"><code class="xref py py-meth docutils literal notranslate"><span class="pre">expectation_value_term()</span></code></a> also care about the Jordan Wigner string (if specified in the documentation).</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="index.html">
              <img class="logo" src="_static/logo.png" alt="Logo"/>
            </a></p>
  <h3><a href="index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Fermions and the Jordan-Wigner transformation</a><ul>
<li><a class="reference internal" href="#spinless-fermions-in-1d">Spinless fermions in 1D</a></li>
<li><a class="reference internal" href="#higher-dimensions">Higher dimensions</a></li>
<li><a class="reference internal" href="#spinful-fermions">Spinful fermions</a></li>
<li><a class="reference internal" href="#how-to-handle-jordan-wigner-strings-in-practice">How to handle Jordan-Wigner strings in practice</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="intro_model.html"
                        title="previous chapter">Introduction to models</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="contributing.html"
                        title="next chapter">Contributing</a></p>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
<h3><a href="index.html">Table of Contents</a></h3>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="userguide.html">User Guide</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="userguide.html#content">Content</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="INSTALL.html">Installation instructions</a></li>
<li class="toctree-l3"><a class="reference internal" href="overview.html">Overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="literature.html">Literature</a></li>
<li class="toctree-l3"><a class="reference internal" href="intro_npc.html">Introduction to np_conserved</a></li>
<li class="toctree-l3"><a class="reference internal" href="intro_model.html">Introduction to models</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Fermions and the Jordan-Wigner transformation</a></li>
<li class="toctree-l3"><a class="reference internal" href="contributing.html">Contributing</a></li>
<li class="toctree-l3"><a class="reference internal" href="todo.html">To-Do list</a></li>
<li class="toctree-l3"><a class="reference internal" href="changelog.html">CHANGELOG</a></li>
<li class="toctree-l3"><a class="reference internal" href="license.html">TeNPy developer team</a></li>
<li class="toctree-l3"><a class="reference internal" href="license.html#license">License</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="reference.html">Tenpy Reference</a></li>
</ul>

        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="contributing.html" title="Contributing"
             >next</a> |</li>
        <li class="right" >
          <a href="intro_model.html" title="Introduction to models"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">TeNPy 0.4.1 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="userguide.html" >User Guide</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2016-2019, TeNPy Developers.
      Last updated on Nov 21, 2019.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 2.2.1.
    </div>
  </body>
</html>