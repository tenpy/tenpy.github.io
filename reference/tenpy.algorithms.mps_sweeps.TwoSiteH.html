
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>TwoSiteH &#8212; TeNPy 0.4.1 documentation</title>
    <link rel="stylesheet" href="../_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/language_data.js"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <link rel="shortcut icon" href="../_static/logo.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="tebd" href="tenpy.algorithms.tebd.html" />
    <link rel="prev" title="Sweep" href="tenpy.algorithms.mps_sweeps.Sweep.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="tenpy.algorithms.tebd.html" title="tebd"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="tenpy.algorithms.mps_sweeps.Sweep.html" title="Sweep"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">TeNPy 0.4.1 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../reference.html" >Tenpy Reference</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="tenpy.algorithms.html" >algorithms</a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="tenpy.algorithms.mps_sweeps.html" accesskey="U">mps_sweeps</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="twositeh">
<h1>TwoSiteH<a class="headerlink" href="#twositeh" title="Permalink to this headline">¶</a></h1>
<ul class="simple">
<li><p>full name: tenpy.algorithms.mps_sweeps.TwoSiteH</p></li>
<li><p>parent module: <a class="reference internal" href="tenpy.algorithms.mps_sweeps.html#module-tenpy.algorithms.mps_sweeps" title="tenpy.algorithms.mps_sweeps"><code class="xref py py-mod docutils literal notranslate"><span class="pre">tenpy.algorithms.mps_sweeps</span></code></a></p></li>
<li><p>type: class</p></li>
</ul>
<dl class="class">
<dt id="tenpy.algorithms.mps_sweeps.TwoSiteH">
<em class="property">class </em><code class="sig-prename descclassname">tenpy.algorithms.mps_sweeps.</code><code class="sig-name descname">TwoSiteH</code><span class="sig-paren">(</span><em class="sig-param">env</em>, <em class="sig-param">i0</em>, <em class="sig-param">combine=False</em>, <em class="sig-param">move_right=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tenpy/algorithms/mps_sweeps.html#TwoSiteH"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tenpy.algorithms.mps_sweeps.TwoSiteH" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="tenpy.algorithms.mps_sweeps.EffectiveH.html#tenpy.algorithms.mps_sweeps.EffectiveH" title="tenpy.algorithms.mps_sweeps.EffectiveH"><code class="xref py py-class docutils literal notranslate"><span class="pre">tenpy.algorithms.mps_sweeps.EffectiveH</span></code></a></p>
<p>Class defining the two-site effective Hamiltonian for Lanczos.</p>
<p>The effective two-site Hamiltonian looks like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">|</span>        <span class="o">.---</span>       <span class="o">---.</span>
<span class="o">|</span>        <span class="o">|</span>    <span class="o">|</span>   <span class="o">|</span>    <span class="o">|</span>
<span class="o">|</span>       <span class="n">LP</span><span class="o">----</span><span class="n">W0</span><span class="o">--</span><span class="n">W1</span><span class="o">---</span><span class="n">RP</span>
<span class="o">|</span>        <span class="o">|</span>    <span class="o">|</span>   <span class="o">|</span>    <span class="o">|</span>
<span class="o">|</span>        <span class="o">.---</span>       <span class="o">---.</span>
</pre></div>
</div>
<p>This class defines <cite>LHeff</cite> and <cite>RHeff</cite>, which are the contractions of <cite>LP</cite> with <cite>W0</cite>, and <cite>RP</cite>
with <cite>W1</cite>, respectively.</p>
<div class="admonition-todo admonition" id="id1">
<p class="admonition-title">Todo</p>
<p>orthogonal theta’s.</p>
</div>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>env</strong><span class="classifier"><a class="reference internal" href="tenpy.networks.mpo.MPOEnvironment.html#tenpy.networks.mpo.MPOEnvironment" title="tenpy.networks.mpo.MPOEnvironment"><code class="xref py py-class docutils literal notranslate"><span class="pre">MPOEnvironment</span></code></a></span></dt><dd><p>Environment for contraction <code class="docutils literal notranslate"><span class="pre">&lt;psi|H|psi&gt;</span></code>.</p>
</dd>
<dt><strong>i0</strong><span class="classifier">int</span></dt><dd><p>Index of the active site if length=1, or of the left-most active site if length&gt;1.</p>
</dd>
<dt><strong>combine</strong><span class="classifier">bool</span></dt><dd><p>Whether to combine legs into pipes. This combines the virtual and
physical leg for the left site (when moving right) or right side (when moving left)
into pipes. This reduces the overhead of calculating charge combinations in the
contractions, but one <a class="reference internal" href="#tenpy.algorithms.mps_sweeps.TwoSiteH.matvec" title="tenpy.algorithms.mps_sweeps.TwoSiteH.matvec"><code class="xref py py-meth docutils literal notranslate"><span class="pre">matvec()</span></code></a> is formally more expensive, <span class="math notranslate nohighlight">\(O(2 d^3 \chi^3 D)\)</span>.
Is originally from the wo-site method; unclear if it works well for 1 site.</p>
</dd>
<dt><strong>move_right</strong><span class="classifier">bool</span></dt><dd><p>Wheter the the sweep is moving right or left for the next update.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Attributes</dt>
<dd class="field-even"><dl>
<dt><strong>combine</strong><span class="classifier">bool</span></dt><dd><p>Whether to combine legs into pipes. This combines the virtual and
physical leg for the left site and right site into pipes. This reduces
the overhead of calculating charge combinations in the contractions,
but one <a class="reference internal" href="#tenpy.algorithms.mps_sweeps.TwoSiteH.matvec" title="tenpy.algorithms.mps_sweeps.TwoSiteH.matvec"><code class="xref py py-meth docutils literal notranslate"><span class="pre">matvec()</span></code></a> is formally more expensive, <span class="math notranslate nohighlight">\(O(2 d^3 \chi^3 D)\)</span>.</p>
</dd>
<dt><strong>length</strong><span class="classifier">int</span></dt><dd><p>Number of (MPS) sites the effective hamiltonian covers.</p>
</dd>
<dt><strong>LHeff</strong><span class="classifier"><a class="reference internal" href="tenpy.linalg.np_conserved.Array.html#tenpy.linalg.np_conserved.Array" title="tenpy.linalg.np_conserved.Array"><code class="xref py py-class docutils literal notranslate"><span class="pre">Array</span></code></a></span></dt><dd><p>Left part of the effective Hamiltonian.
Labels <code class="docutils literal notranslate"><span class="pre">'(vR*.p0)',</span> <span class="pre">'wR',</span> <span class="pre">'(vR.p0*)'</span></code> for bra, MPO, ket.</p>
</dd>
<dt><strong>RHeff</strong><span class="classifier"><a class="reference internal" href="tenpy.linalg.np_conserved.Array.html#tenpy.linalg.np_conserved.Array" title="tenpy.linalg.np_conserved.Array"><code class="xref py py-class docutils literal notranslate"><span class="pre">Array</span></code></a></span></dt><dd><p>Right part of the effective Hamiltonian.
Labels <code class="docutils literal notranslate"><span class="pre">'(vL.p1*)',</span> <span class="pre">'wL',</span> <span class="pre">'(vL*.p1)'</span></code> for ket, MPO, bra.</p>
</dd>
<dt><strong>LP</strong><span class="classifier"><a class="reference internal" href="tenpy.linalg.np_conserved.Array.html#tenpy.linalg.np_conserved.Array" title="tenpy.linalg.np_conserved.Array"><code class="xref py py-class docutils literal notranslate"><span class="pre">Array</span></code></a></span></dt><dd><p>Left part of the environment.</p>
</dd>
<dt><strong>RP</strong><span class="classifier"><a class="reference internal" href="tenpy.linalg.np_conserved.Array.html#tenpy.linalg.np_conserved.Array" title="tenpy.linalg.np_conserved.Array"><code class="xref py py-class docutils literal notranslate"><span class="pre">Array</span></code></a></span></dt><dd><p>Right part of the environment</p>
</dd>
<dt><strong>W1</strong><span class="classifier"><a class="reference internal" href="tenpy.linalg.np_conserved.Array.html#tenpy.linalg.np_conserved.Array" title="tenpy.linalg.np_conserved.Array"><code class="xref py py-class docutils literal notranslate"><span class="pre">Array</span></code></a></span></dt><dd><p>Left MPO tensor, applied to the ‘p0’ leg of theta</p>
</dd>
<dt><strong>W2</strong><span class="classifier"><a class="reference internal" href="tenpy.linalg.np_conserved.Array.html#tenpy.linalg.np_conserved.Array" title="tenpy.linalg.np_conserved.Array"><code class="xref py py-class docutils literal notranslate"><span class="pre">Array</span></code></a></span></dt><dd><p>Right MPO tensor, applied to the ‘p1’ leg of theta</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#tenpy.algorithms.mps_sweeps.TwoSiteH.combine_Heff" title="tenpy.algorithms.mps_sweeps.TwoSiteH.combine_Heff"><code class="xref py py-obj docutils literal notranslate"><span class="pre">combine_Heff</span></code></a>(self)</p></td>
<td><p>Combine LP and RP with W to form LHeff and RHeff.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#tenpy.algorithms.mps_sweeps.TwoSiteH.matvec" title="tenpy.algorithms.mps_sweeps.TwoSiteH.matvec"><code class="xref py py-obj docutils literal notranslate"><span class="pre">matvec</span></code></a>(self, theta)</p></td>
<td><p>Apply the effective Hamiltonian to <cite>theta</cite>.</p></td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="tenpy.algorithms.mps_sweeps.TwoSiteH.matvec">
<code class="sig-name descname">matvec</code><span class="sig-paren">(</span><em class="sig-param">self</em>, <em class="sig-param">theta</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tenpy/algorithms/mps_sweeps.html#TwoSiteH.matvec"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tenpy.algorithms.mps_sweeps.TwoSiteH.matvec" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply the effective Hamiltonian to <cite>theta</cite>.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>theta</strong><span class="classifier"><a class="reference internal" href="tenpy.linalg.np_conserved.Array.html#tenpy.linalg.np_conserved.Array" title="tenpy.linalg.np_conserved.Array"><code class="xref py py-class docutils literal notranslate"><span class="pre">Array</span></code></a></span></dt><dd><p>Labels: <code class="docutils literal notranslate"><span class="pre">vL,</span> <span class="pre">p0,</span> <span class="pre">p1,</span> <span class="pre">vR</span></code> if combine=False, <code class="docutils literal notranslate"><span class="pre">(vL.p0),</span> <span class="pre">(p1.vR)</span></code> if True</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt>theta <a class="reference internal" href="tenpy.linalg.np_conserved.Array.html#tenpy.linalg.np_conserved.Array" title="tenpy.linalg.np_conserved.Array"><code class="xref py py-class docutils literal notranslate"><span class="pre">Array</span></code></a></dt><dd><p>Product of <cite>theta</cite> and the effective Hamiltonian.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="tenpy.algorithms.mps_sweeps.TwoSiteH.combine_Heff">
<code class="sig-name descname">combine_Heff</code><span class="sig-paren">(</span><em class="sig-param">self</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tenpy/algorithms/mps_sweeps.html#TwoSiteH.combine_Heff"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tenpy.algorithms.mps_sweeps.TwoSiteH.combine_Heff" title="Permalink to this definition">¶</a></dt>
<dd><p>Combine LP and RP with W to form LHeff and RHeff.</p>
<p>Combine LP with W1 and RP with W2 to get the effective parts of the Hamiltonian with piped
legs.</p>
</dd></dl>

</dd></dl>

</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/logo.png" alt="Logo"/>
            </a></p>
  <h4>Previous topic</h4>
  <p class="topless"><a href="tenpy.algorithms.mps_sweeps.Sweep.html"
                        title="previous chapter">Sweep</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="tenpy.algorithms.tebd.html"
                        title="next chapter">tebd</a></p>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
<h3><a href="../index.html">Table of Contents</a></h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../userguide.html">User Guide</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../reference.html">Tenpy Reference</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="tenpy.algorithms.html">algorithms</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="tenpy.algorithms.truncation.html">truncation</a></li>
<li class="toctree-l3"><a class="reference internal" href="tenpy.algorithms.dmrg.html">dmrg</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="tenpy.algorithms.mps_sweeps.html">mps_sweeps</a></li>
<li class="toctree-l3"><a class="reference internal" href="tenpy.algorithms.tebd.html">tebd</a></li>
<li class="toctree-l3"><a class="reference internal" href="tenpy.algorithms.tdvp.html">tdvp</a></li>
<li class="toctree-l3"><a class="reference internal" href="tenpy.algorithms.purification_tebd.html">purification_tebd</a></li>
<li class="toctree-l3"><a class="reference internal" href="tenpy.algorithms.network_contractor.html">network_contractor</a></li>
<li class="toctree-l3"><a class="reference internal" href="tenpy.algorithms.exact_diag.html">exact_diag</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="tenpy.linalg.html">linalg</a></li>
<li class="toctree-l2"><a class="reference internal" href="tenpy.models.html">models</a></li>
<li class="toctree-l2"><a class="reference internal" href="tenpy.networks.html">networks</a></li>
<li class="toctree-l2"><a class="reference internal" href="tenpy.tools.html">tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="tenpy.version.html">version</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="tenpy.algorithms.tebd.html" title="tebd"
             >next</a> |</li>
        <li class="right" >
          <a href="tenpy.algorithms.mps_sweeps.Sweep.html" title="Sweep"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">TeNPy 0.4.1 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../reference.html" >Tenpy Reference</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="tenpy.algorithms.html" >algorithms</a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="tenpy.algorithms.mps_sweeps.html" >mps_sweeps</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2016-2019, TeNPy Developers.
      Last updated on Nov 24, 2019.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 2.2.1.
    </div>
  </body>
</html>