
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>mps &#8212; TeNPy 0.4.1 documentation</title>
    <link rel="stylesheet" href="../_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/language_data.js"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <link rel="shortcut icon" href="../_static/logo.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="MPS" href="tenpy.networks.mps.MPS.html" />
    <link rel="prev" title="multi_sites_combine_charges" href="tenpy.networks.site.multi_sites_combine_charges.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="tenpy.networks.mps.MPS.html" title="MPS"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="tenpy.networks.site.multi_sites_combine_charges.html" title="multi_sites_combine_charges"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">TeNPy 0.4.1 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../reference.html" >Tenpy Reference</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="tenpy.networks.html" accesskey="U">networks</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="mps">
<h1>mps<a class="headerlink" href="#mps" title="Permalink to this headline">¶</a></h1>
<ul class="simple">
<li><p>full name: tenpy.networks.mps</p></li>
<li><p>parent module: <a class="reference internal" href="tenpy.networks.html#module-tenpy.networks" title="tenpy.networks"><code class="xref py py-mod docutils literal notranslate"><span class="pre">tenpy.networks</span></code></a></p></li>
<li><p>type: module</p></li>
</ul>
<p class="rubric">Classes</p>
<table class="longtable docutils align-center">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="tenpy.networks.mps.MPS.html#tenpy.networks.mps.MPS" title="tenpy.networks.mps.MPS"><code class="xref py py-obj docutils literal notranslate"><span class="pre">MPS</span></code></a>(sites, Bs, SVs[, bc, form, norm])</p></td>
<td><p>A Matrix Product State, finite (MPS) or infinite (iMPS).</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="tenpy.networks.mps.MPSEnvironment.html#tenpy.networks.mps.MPSEnvironment" title="tenpy.networks.mps.MPSEnvironment"><code class="xref py py-obj docutils literal notranslate"><span class="pre">MPSEnvironment</span></code></a>(bra, ket[, init_LP, init_RP, …])</p></td>
<td><p>Stores partial contractions of <span class="math notranslate nohighlight">\(&lt;bra|Op|ket&gt;\)</span> for local operators <cite>Op</cite>.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="tenpy.networks.mps.TransferMatrix.html#tenpy.networks.mps.TransferMatrix" title="tenpy.networks.mps.TransferMatrix"><code class="xref py py-obj docutils literal notranslate"><span class="pre">TransferMatrix</span></code></a>(bra, ket[, shift_bra, …])</p></td>
<td><p>Transfer matrix of two MPS (bra &amp; ket).</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Functions</p>
<table class="longtable docutils align-center">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="tenpy.networks.mps.build_initial_state.html#tenpy.networks.mps.build_initial_state" title="tenpy.networks.mps.build_initial_state"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_initial_state</span></code></a>(size, states, filling[, …])</p></td>
<td><p>Build an “initial state” list</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Module description</p>
<span class="target" id="module-tenpy.networks.mps"></span><p>This module contains a base class for a Matrix Product State (MPS).</p>
<p>An MPS looks roughly like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">|</span>   <span class="o">--</span> <span class="n">B</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">--</span> <span class="n">B</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">--</span> <span class="n">B</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">--</span> <span class="o">...</span>
<span class="o">|</span>       <span class="o">|</span>       <span class="o">|</span>      <span class="o">|</span>
</pre></div>
</div>
<p>We use the following label convention for the <cite>B</cite> (where arrows indicate <cite>qconj</cite>):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">|</span>  <span class="n">vL</span> <span class="o">-&gt;-</span> <span class="n">B</span> <span class="o">-&gt;-</span> <span class="n">vR</span>
<span class="o">|</span>         <span class="o">|</span>
<span class="o">|</span>         <span class="o">^</span>
<span class="o">|</span>         <span class="n">p</span>
</pre></div>
</div>
<p>We store one 3-leg tensor <cite>_B[i]</cite> with labels <code class="docutils literal notranslate"><span class="pre">'vL',</span> <span class="pre">'vR',</span> <span class="pre">'p'</span></code> for each of the <cite>L</cite> sites
<code class="docutils literal notranslate"><span class="pre">0</span> <span class="pre">&lt;=</span> <span class="pre">i</span> <span class="pre">&lt;</span> <span class="pre">L</span></code>.
Additionally, we store <code class="docutils literal notranslate"><span class="pre">L+1</span></code> singular value arrays <cite>_S[ib]</cite> on each bond <code class="docutils literal notranslate"><span class="pre">0</span> <span class="pre">&lt;=</span> <span class="pre">ib</span> <span class="pre">&lt;=</span> <span class="pre">L</span></code>,
independent of the boundary conditions.
<code class="docutils literal notranslate"><span class="pre">_S[ib]</span></code> gives the singlur values on the bond <code class="docutils literal notranslate"><span class="pre">i-1,</span> <span class="pre">i</span></code>.
However, be aware that e.g. <a class="reference internal" href="tenpy.networks.mps.MPS.html#tenpy.networks.mps.MPS.chi" title="tenpy.networks.mps.MPS.chi"><code class="xref py py-attr docutils literal notranslate"><span class="pre">chi</span></code></a> returns only the dimensions of the
<a class="reference internal" href="tenpy.networks.mps.MPS.html#tenpy.networks.mps.MPS.nontrivial_bonds" title="tenpy.networks.mps.MPS.nontrivial_bonds"><code class="xref py py-attr docutils literal notranslate"><span class="pre">nontrivial_bonds</span></code></a> depending on the boundary conditions.</p>
<p>The matrices and singular values always represent a normalized state
(i.e. <code class="docutils literal notranslate"><span class="pre">np.linalg.norm(psi._S[ib])</span> <span class="pre">==</span> <span class="pre">1</span></code> up to roundoff errors),
but (for finite MPS) we keep track of the norm in <code class="xref py py-attr docutils literal notranslate"><span class="pre">norm</span></code>
(which is respected by <a class="reference internal" href="tenpy.networks.mps.MPS.html#tenpy.networks.mps.MPS.overlap" title="tenpy.networks.mps.MPS.overlap"><code class="xref py py-meth docutils literal notranslate"><span class="pre">overlap()</span></code></a>, …).</p>
<p>Valid MPS boundary conditions (not to confuse with <cite>bc_coupling</cite> of
<a class="reference internal" href="tenpy.models.model.CouplingModel.html#tenpy.models.model.CouplingModel" title="tenpy.models.model.CouplingModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">tenpy.models.model.CouplingModel</span></code></a>)  are the following:</p>
<table class="docutils align-center">
<colgroup>
<col style="width: 11%" />
<col style="width: 89%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p><cite>bc</cite></p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>‘finite’</p></td>
<td><p>Finite MPS, <code class="docutils literal notranslate"><span class="pre">G0</span> <span class="pre">s1</span> <span class="pre">G1</span> <span class="pre">...</span> <span class="pre">s{L-1}</span> <span class="pre">G{l-1}</span></code>. This is acchieved
by using a trivial left and right bond <code class="docutils literal notranslate"><span class="pre">s[0]</span> <span class="pre">=</span> <span class="pre">s[-1]</span> <span class="pre">=</span> <span class="pre">np.array([1.])</span></code>.</p></td>
</tr>
<tr class="row-odd"><td><p>‘segment’</p></td>
<td><p>Generalization of ‘finite’, describes an MPS embedded in left and right
environments. The left environment is described by <code class="docutils literal notranslate"><span class="pre">chi[0]</span></code> <em>orthonormal</em> states
which are weighted by the singular values <code class="docutils literal notranslate"><span class="pre">s[0]</span></code>. Similar, <code class="docutils literal notranslate"><span class="pre">s[L]</span></code> weight some
right orthonormal states. You can think of the left and right states to be
generated by additional MPS, such that the overall structure is something like
<code class="docutils literal notranslate"><span class="pre">...</span> <span class="pre">s</span> <span class="pre">L</span> <span class="pre">s</span> <span class="pre">L</span> <span class="pre">[s0</span> <span class="pre">G0</span> <span class="pre">s1</span> <span class="pre">G1</span> <span class="pre">...</span> <span class="pre">s{L-1}</span> <span class="pre">G{L-1}</span> <span class="pre">s{L}]</span> <span class="pre">R</span> <span class="pre">s</span> <span class="pre">R</span> <span class="pre">s</span> <span class="pre">R</span> <span class="pre">...</span></code>
(where we save the part in the brackets <code class="docutils literal notranslate"><span class="pre">[</span> <span class="pre">...</span> <span class="pre">]</span></code> ).</p></td>
</tr>
<tr class="row-even"><td><p>‘infinite’</p></td>
<td><p>infinite MPS (iMPS): we save a ‘MPS unit cell’ <code class="docutils literal notranslate"><span class="pre">[s0</span> <span class="pre">G0</span> <span class="pre">s1</span> <span class="pre">G1</span> <span class="pre">...</span> <span class="pre">s{L-1}</span> <span class="pre">G{L-1}]</span></code>
which is repeated periodically, identifying all indices modulo <code class="docutils literal notranslate"><span class="pre">self.L</span></code>.
In particular, the last bond <code class="docutils literal notranslate"><span class="pre">L</span></code> is identified with <code class="docutils literal notranslate"><span class="pre">0</span></code>.
(The MPS unit cell can differ from a lattice unit cell).
bond is identified with the first one.</p></td>
</tr>
</tbody>
</table>
<p>An MPS can be in different ‘canonical forms’ (see <a class="reference internal" href="../literature.html#vidal2004" id="id1"><span>[Vidal2004]</span></a>, <a class="reference internal" href="../literature.html#schollwoeck2011" id="id2"><span>[Schollwoeck2011]</span></a>).
To take care of the different canonical forms, algorithms should use functions like
<a class="reference internal" href="tenpy.networks.mps.MPS.html#tenpy.networks.mps.MPS.get_theta" title="tenpy.networks.mps.MPS.get_theta"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_theta()</span></code></a>, <a class="reference internal" href="tenpy.networks.mps.MPS.html#tenpy.networks.mps.MPS.get_B" title="tenpy.networks.mps.MPS.get_B"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_B()</span></code></a>
and <a class="reference internal" href="tenpy.networks.mps.MPS.html#tenpy.networks.mps.MPS.set_B" title="tenpy.networks.mps.MPS.set_B"><code class="xref py py-meth docutils literal notranslate"><span class="pre">set_B()</span></code></a> instead of accessing them directly,
as they return the <cite>B</cite> in the desired form (which can be chosen as an argument).
The values of the tuples for the form correspond to the exponent of the singular values
on the left and right.
To keep track of a “mixed” canonical form <code class="docutils literal notranslate"><span class="pre">A</span> <span class="pre">A</span> <span class="pre">A</span> <span class="pre">s</span> <span class="pre">B</span> <span class="pre">B</span></code>, we save the tuples for each
site of the MPS in <code class="xref py py-attr docutils literal notranslate"><span class="pre">MPS.form</span></code>.</p>
<table class="docutils align-center">
<colgroup>
<col style="width: 9%" />
<col style="width: 11%" />
<col style="width: 80%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p><cite>form</cite></p></th>
<th class="head"><p>tuple</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">'B'</span></code></p></td>
<td><p>(0, 1)</p></td>
<td><p>right canonical: <code class="docutils literal notranslate"><span class="pre">_B[i]</span> <span class="pre">=</span> <span class="pre">--</span> <span class="pre">Gamma[i]</span> <span class="pre">--</span> <span class="pre">s[i+1]--</span></code>
The default form, which algorithms asssume.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">'C'</span></code></p></td>
<td><p>(0.5, 0.5)</p></td>
<td><p>symmetric form: <code class="docutils literal notranslate"><span class="pre">_B[i]</span> <span class="pre">=</span> <span class="pre">--</span> <span class="pre">s[i]**0.5</span> <span class="pre">--</span> <span class="pre">Gamma[i]</span> <span class="pre">--</span> <span class="pre">s[i+1]**0.5--</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">'A'</span></code></p></td>
<td><p>(1, 0)</p></td>
<td><p>left canonical: <code class="docutils literal notranslate"><span class="pre">_B[i]</span> <span class="pre">=</span> <span class="pre">--</span> <span class="pre">s[i]</span> <span class="pre">--</span> <span class="pre">Gamma[i]</span> <span class="pre">--</span></code>.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">'G'</span></code></p></td>
<td><p>(0, 0)</p></td>
<td><p>Save only <code class="docutils literal notranslate"><span class="pre">_B[i]</span> <span class="pre">=</span> <span class="pre">--</span> <span class="pre">Gamma[i]</span> <span class="pre">--</span></code>.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">'Th'</span></code></p></td>
<td><p>(1, 1)</p></td>
<td><p>Form of a local wave function <cite>theta</cite> with singular value on both sides.
<code class="docutils literal notranslate"><span class="pre">psi.get_B(i,</span> <span class="pre">'Th')</span> <span class="pre">is</span> <span class="pre">equivalent</span> <span class="pre">to</span> <span class="pre">``psi.get_theta(i,</span> <span class="pre">n=1)</span></code>.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">None</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">None</span></code></p></td>
<td><p>General non-canoncial form.
Valid form for initialization, but you need to call
<a class="reference internal" href="tenpy.networks.mps.MPS.html#tenpy.networks.mps.MPS.canonical_form" title="tenpy.networks.mps.MPS.canonical_form"><code class="xref py py-meth docutils literal notranslate"><span class="pre">canonical_form()</span></code></a> (or similar)
before using algorithms.</p></td>
</tr>
</tbody>
</table>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/logo.png" alt="Logo"/>
            </a></p>
  <h4>Previous topic</h4>
  <p class="topless"><a href="tenpy.networks.site.multi_sites_combine_charges.html"
                        title="previous chapter">multi_sites_combine_charges</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="tenpy.networks.mps.MPS.html"
                        title="next chapter">MPS</a></p>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
<h3><a href="../index.html">Table of Contents</a></h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../userguide.html">User Guide</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../reference.html">Tenpy Reference</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="tenpy.algorithms.html">algorithms</a></li>
<li class="toctree-l2"><a class="reference internal" href="tenpy.linalg.html">linalg</a></li>
<li class="toctree-l2"><a class="reference internal" href="tenpy.models.html">models</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="tenpy.networks.html">networks</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="tenpy.networks.site.html">site</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">mps</a></li>
<li class="toctree-l3"><a class="reference internal" href="tenpy.networks.mpo.html">mpo</a></li>
<li class="toctree-l3"><a class="reference internal" href="tenpy.networks.terms.html">terms</a></li>
<li class="toctree-l3"><a class="reference internal" href="tenpy.networks.purification_mps.html">purification_mps</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="tenpy.tools.html">tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="tenpy.version.html">version</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="tenpy.networks.mps.MPS.html" title="MPS"
             >next</a> |</li>
        <li class="right" >
          <a href="tenpy.networks.site.multi_sites_combine_charges.html" title="multi_sites_combine_charges"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">TeNPy 0.4.1 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../reference.html" >Tenpy Reference</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="tenpy.networks.html" >networks</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2016-2019, TeNPy Developers.
      Last updated on Sep 21, 2019.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 2.0.0.
    </div>
  </body>
</html>