
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>MPSEnvironment &#8212; TeNPy 0.5.0.dev41+e0e9515 documentation</title>
    <link rel="stylesheet" href="../_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css" />
    
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/language_data.js"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <link rel="shortcut icon" href="../_static/logo.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="TransferMatrix" href="tenpy.networks.mps.TransferMatrix.html" />
    <link rel="prev" title="MPS" href="tenpy.networks.mps.MPS.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="tenpy.networks.mps.TransferMatrix.html" title="TransferMatrix"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="tenpy.networks.mps.MPS.html" title="MPS"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">TeNPy 0.5.0.dev41+e0e9515 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="tenpy.networks.html" >networks</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="tenpy.networks.mps.html" accesskey="U">mps</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="mpsenvironment">
<h1>MPSEnvironment<a class="headerlink" href="#mpsenvironment" title="Permalink to this headline">¶</a></h1>
<ul class="simple">
<li><p>full name: tenpy.networks.mps.MPSEnvironment</p></li>
<li><p>parent module: <a class="reference internal" href="tenpy.networks.mps.html#module-tenpy.networks.mps" title="tenpy.networks.mps"><code class="xref py py-mod docutils literal notranslate"><span class="pre">tenpy.networks.mps</span></code></a></p></li>
<li><p>type: class</p></li>
</ul>
<p class="rubric">Inheritance Diagram</p>
<div class="graphviz"><img src="../_images/inheritance-0a60fe2be41458ea52d2323942338ce8c660abc2.png" alt="Inheritance diagram of tenpy.networks.mps.MPSEnvironment" usemap="#inheritance46f9681cc9" class="inheritance graphviz" /></div>
<map id="inheritance46f9681cc9" name="inheritance46f9681cc9">
<area shape="rect" id="node1" href="#tenpy.networks.mps.MPSEnvironment" target="_top" title="Stores partial contractions of :math:`&lt;bra|Op|ket&gt;` for local operators `Op`." alt="" coords="5,5,137,31"/>
</map><p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">MPSEnvironment.__init__</span></code>(bra, ket[, init_LP, …])</p></td>
<td><p>Initialize self.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#tenpy.networks.mps.MPSEnvironment.del_LP" title="tenpy.networks.mps.MPSEnvironment.del_LP"><code class="xref py py-obj docutils literal notranslate"><span class="pre">MPSEnvironment.del_LP</span></code></a>(i)</p></td>
<td><p>Delete stored part strictly to the left of site <cite>i</cite>.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#tenpy.networks.mps.MPSEnvironment.del_RP" title="tenpy.networks.mps.MPSEnvironment.del_RP"><code class="xref py py-obj docutils literal notranslate"><span class="pre">MPSEnvironment.del_RP</span></code></a>(i)</p></td>
<td><p>Delete storde part scrictly to the right of site <cite>i</cite>.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#tenpy.networks.mps.MPSEnvironment.expectation_value" title="tenpy.networks.mps.MPSEnvironment.expectation_value"><code class="xref py py-obj docutils literal notranslate"><span class="pre">MPSEnvironment.expectation_value</span></code></a>(ops[, …])</p></td>
<td><p>Expectation value <code class="docutils literal notranslate"><span class="pre">&lt;bra|ops|ket&gt;</span></code> of (n-site) operator(s).</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#tenpy.networks.mps.MPSEnvironment.full_contraction" title="tenpy.networks.mps.MPSEnvironment.full_contraction"><code class="xref py py-obj docutils literal notranslate"><span class="pre">MPSEnvironment.full_contraction</span></code></a>(i0)</p></td>
<td><p>Calculate the overlap by a full contraction of the network.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#tenpy.networks.mps.MPSEnvironment.get_LP" title="tenpy.networks.mps.MPSEnvironment.get_LP"><code class="xref py py-obj docutils literal notranslate"><span class="pre">MPSEnvironment.get_LP</span></code></a>(i[, store])</p></td>
<td><p>Calculate LP at given site from nearest available one (including <cite>i</cite>).</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#tenpy.networks.mps.MPSEnvironment.get_LP_age" title="tenpy.networks.mps.MPSEnvironment.get_LP_age"><code class="xref py py-obj docutils literal notranslate"><span class="pre">MPSEnvironment.get_LP_age</span></code></a>(i)</p></td>
<td><p>Return number of physical sites in the contractions of get_LP(i).</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#tenpy.networks.mps.MPSEnvironment.get_RP" title="tenpy.networks.mps.MPSEnvironment.get_RP"><code class="xref py py-obj docutils literal notranslate"><span class="pre">MPSEnvironment.get_RP</span></code></a>(i[, store])</p></td>
<td><p>Calculate RP at given site from nearest available one (including <cite>i</cite>).</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#tenpy.networks.mps.MPSEnvironment.get_RP_age" title="tenpy.networks.mps.MPSEnvironment.get_RP_age"><code class="xref py py-obj docutils literal notranslate"><span class="pre">MPSEnvironment.get_RP_age</span></code></a>(i)</p></td>
<td><p>Return number of physical sites in the contractions of get_RP(i).</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#tenpy.networks.mps.MPSEnvironment.init_LP" title="tenpy.networks.mps.MPSEnvironment.init_LP"><code class="xref py py-obj docutils literal notranslate"><span class="pre">MPSEnvironment.init_LP</span></code></a>(i)</p></td>
<td><p>Build initial left part <code class="docutils literal notranslate"><span class="pre">LP</span></code>.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#tenpy.networks.mps.MPSEnvironment.init_RP" title="tenpy.networks.mps.MPSEnvironment.init_RP"><code class="xref py py-obj docutils literal notranslate"><span class="pre">MPSEnvironment.init_RP</span></code></a>(i)</p></td>
<td><p>Build initial right part <code class="docutils literal notranslate"><span class="pre">RP</span></code> for an MPS/MPOEnvironment.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#tenpy.networks.mps.MPSEnvironment.set_LP" title="tenpy.networks.mps.MPSEnvironment.set_LP"><code class="xref py py-obj docutils literal notranslate"><span class="pre">MPSEnvironment.set_LP</span></code></a>(i, LP, age)</p></td>
<td><p>Store part to the left of site <cite>i</cite>.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#tenpy.networks.mps.MPSEnvironment.set_RP" title="tenpy.networks.mps.MPSEnvironment.set_RP"><code class="xref py py-obj docutils literal notranslate"><span class="pre">MPSEnvironment.set_RP</span></code></a>(i, RP, age)</p></td>
<td><p>Store part to the right of site <cite>i</cite>.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#tenpy.networks.mps.MPSEnvironment.test_sanity" title="tenpy.networks.mps.MPSEnvironment.test_sanity"><code class="xref py py-obj docutils literal notranslate"><span class="pre">MPSEnvironment.test_sanity</span></code></a>()</p></td>
<td><p>Sanity check, raises ValueErrors, if something is wrong.</p></td>
</tr>
</tbody>
</table>
<dl class="class">
<dt id="tenpy.networks.mps.MPSEnvironment">
<em class="property">class </em><code class="sig-prename descclassname">tenpy.networks.mps.</code><code class="sig-name descname">MPSEnvironment</code><span class="sig-paren">(</span><em class="sig-param">bra</em>, <em class="sig-param">ket</em>, <em class="sig-param">init_LP=None</em>, <em class="sig-param">init_RP=None</em>, <em class="sig-param">age_LP=0</em>, <em class="sig-param">age_RP=0</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/tenpy/tenpy/blob/master/tenpy/networks/mps.py#L2766-L3186"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tenpy.networks.mps.MPSEnvironment" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.8)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Stores partial contractions of <span class="math notranslate nohighlight">\(&lt;bra|Op|ket&gt;\)</span> for local operators <cite>Op</cite>.</p>
<p>The network for a contraction <span class="math notranslate nohighlight">\(&lt;bra|Op|ket&gt;\)</span> of a local operator <cite>Op</cite>, say exemplary
at sites <cite>i, i+1</cite> looks like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">|</span>     <span class="o">.-----</span><span class="n">M</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">---</span> <span class="o">...</span> <span class="o">--</span><span class="n">M</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">---</span><span class="n">M</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">---</span> <span class="o">...</span> <span class="o">-&gt;--.</span>
<span class="o">|</span>     <span class="o">|</span>     <span class="o">|</span>             <span class="o">|</span>      <span class="o">|</span>               <span class="o">|</span>
<span class="o">|</span>     <span class="o">|</span>     <span class="o">|</span>             <span class="o">|------|</span>               <span class="o">|</span>
<span class="o">|</span>     <span class="n">LP</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">|</span>             <span class="o">|</span>  <span class="n">Op</span>  <span class="o">|</span>               <span class="n">RP</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="o">|</span>     <span class="o">|</span>     <span class="o">|</span>             <span class="o">|------|</span>               <span class="o">|</span>
<span class="o">|</span>     <span class="o">|</span>     <span class="o">|</span>             <span class="o">|</span>      <span class="o">|</span>               <span class="o">|</span>
<span class="o">|</span>     <span class="o">.-----</span><span class="n">N</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*--</span> <span class="o">...</span> <span class="o">--</span><span class="n">N</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*--</span><span class="n">N</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*--</span> <span class="o">...</span> <span class="o">-&lt;--.</span>
</pre></div>
</div>
<p>Of course, we can also calculate the overlap <cite>&lt;bra|ket&gt;</cite> by using the special case <code class="docutils literal notranslate"><span class="pre">Op</span> <span class="pre">=</span> <span class="pre">Id</span></code>.</p>
<p>We use the following label convention (where arrows indicate <cite>qconj</cite>):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">|</span>    <span class="o">.--&gt;-</span> <span class="n">vR</span>           <span class="n">vL</span> <span class="o">-&gt;-.</span>
<span class="o">|</span>    <span class="o">|</span>                        <span class="o">|</span>
<span class="o">|</span>    <span class="n">LP</span>                       <span class="n">RP</span>
<span class="o">|</span>    <span class="o">|</span>                        <span class="o">|</span>
<span class="o">|</span>    <span class="o">.--&lt;-</span> <span class="n">vR</span><span class="o">*</span>         <span class="n">vL</span><span class="o">*</span> <span class="o">-&lt;-.</span>
</pre></div>
</div>
<p>To avoid recalculations of the whole network e.g. in the DMRG sweeps,
we store the contractions up to some site index in this class.
For <code class="docutils literal notranslate"><span class="pre">bc='finite','segment'</span></code>, the very left and right part <code class="docutils literal notranslate"><span class="pre">LP[0]</span></code> and
<code class="docutils literal notranslate"><span class="pre">RP[-1]</span></code> are trivial and don’t change,
but for <code class="docutils literal notranslate"><span class="pre">bc='infinite'</span></code> they are might be updated
(by inserting another unit cell to the left/right).</p>
<p>The MPS <cite>bra</cite> and <cite>ket</cite> have to be in canonical form.
All the environments are constructed without the singular values on the open bond.
In other words, we contract left-canonical <cite>A</cite> to the left parts <cite>LP</cite>
and right-canonical <cite>B</cite> to the right parts <cite>RP</cite>.
Thus, the special case <code class="docutils literal notranslate"><span class="pre">ket=bra</span></code> should yield identity matrices for <cite>LP</cite> and <cite>RP</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>bra</strong> (<a class="reference internal" href="tenpy.networks.mps.MPS.html#tenpy.networks.mps.MPS" title="tenpy.networks.mps.MPS"><code class="xref py py-class docutils literal notranslate"><span class="pre">MPS</span></code></a>) – The MPS to project on. Should be given in usual ‘ket’ form;
we call <cite>conj()</cite> on the matrices directly.
Stored in place, without making copies.
If necessary to match charges, we call <a class="reference internal" href="tenpy.networks.mps.MPS.html#tenpy.networks.mps.MPS.gauge_total_charge" title="tenpy.networks.mps.MPS.gauge_total_charge"><code class="xref py py-meth docutils literal notranslate"><span class="pre">gauge_total_charge()</span></code></a>.</p></li>
<li><p><strong>ket</strong> (<a class="reference internal" href="tenpy.networks.mpo.MPO.html#tenpy.networks.mpo.MPO" title="tenpy.networks.mpo.MPO"><code class="xref py py-class docutils literal notranslate"><span class="pre">MPO</span></code></a> | None) – The MPS on which the local operator acts.
Stored in place, without making copies.
If <code class="docutils literal notranslate"><span class="pre">None</span></code>, use <cite>bra</cite>.</p></li>
<li><p><strong>init_LP</strong> (<code class="docutils literal notranslate"><span class="pre">None</span></code> | <a class="reference internal" href="tenpy.linalg.np_conserved.Array.html#tenpy.linalg.np_conserved.Array" title="tenpy.linalg.np_conserved.Array"><code class="xref py py-class docutils literal notranslate"><span class="pre">Array</span></code></a>) – Initial very left part <code class="docutils literal notranslate"><span class="pre">LP</span></code>. If <code class="docutils literal notranslate"><span class="pre">None</span></code>, build trivial one with <a class="reference internal" href="#tenpy.networks.mps.MPSEnvironment.init_LP" title="tenpy.networks.mps.MPSEnvironment.init_LP"><code class="xref py py-meth docutils literal notranslate"><span class="pre">init_LP()</span></code></a>.</p></li>
<li><p><strong>init_RP</strong> (<code class="docutils literal notranslate"><span class="pre">None</span></code> | <a class="reference internal" href="tenpy.linalg.np_conserved.Array.html#tenpy.linalg.np_conserved.Array" title="tenpy.linalg.np_conserved.Array"><code class="xref py py-class docutils literal notranslate"><span class="pre">Array</span></code></a>) – Initial very right part <code class="docutils literal notranslate"><span class="pre">RP</span></code>. If <code class="docutils literal notranslate"><span class="pre">None</span></code>, build trivial one with <a class="reference internal" href="#tenpy.networks.mps.MPSEnvironment.init_RP" title="tenpy.networks.mps.MPSEnvironment.init_RP"><code class="xref py py-meth docutils literal notranslate"><span class="pre">init_RP()</span></code></a>.</p></li>
<li><p><strong>age_LP</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – The number of physical sites involved into the contraction yielding <cite>firstLP</cite>.</p></li>
<li><p><strong>age_RP</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – The number of physical sites involved into the contraction yielding <cite>lastRP</cite>.</p></li>
</ul>
</dd>
</dl>
<dl class="attribute">
<dt id="tenpy.networks.mps.MPSEnvironment.L">
<code class="sig-name descname">L</code><a class="headerlink" href="#tenpy.networks.mps.MPSEnvironment.L" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of physical sites involved into the Environment, i.e. the least common multiple
of <code class="docutils literal notranslate"><span class="pre">bra.L</span></code> and <code class="docutils literal notranslate"><span class="pre">ket.L</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt>
<code class="sig-name descname">bra, ket</code></dt>
<dd><p>The two MPS for the contraction.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference internal" href="tenpy.networks.mps.MPS.html#tenpy.networks.mps.MPS" title="tenpy.networks.mps.MPS"><code class="xref py py-class docutils literal notranslate"><span class="pre">MPS</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="tenpy.networks.mps.MPSEnvironment.dtype">
<code class="sig-name descname">dtype</code><a class="headerlink" href="#tenpy.networks.mps.MPSEnvironment.dtype" title="Permalink to this definition">¶</a></dt>
<dd><p>The data type.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#type" title="(in Python v3.8)">type</a></p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="tenpy.networks.mps.MPSEnvironment._finite">
<code class="sig-name descname">_finite</code><a class="headerlink" href="#tenpy.networks.mps.MPSEnvironment._finite" title="Permalink to this definition">¶</a></dt>
<dd><p>Whether the boundary conditions of the MPS are finite.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.8)">bool</a></p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="tenpy.networks.mps.MPSEnvironment._LP">
<code class="sig-name descname">_LP</code><a class="headerlink" href="#tenpy.networks.mps.MPSEnvironment._LP" title="Permalink to this definition">¶</a></dt>
<dd><p>Left parts of the environment, len <cite>L</cite>.
<code class="docutils literal notranslate"><span class="pre">LP[i]</span></code> contains the contraction strictly left of site <cite>i</cite>
(or <code class="docutils literal notranslate"><span class="pre">None</span></code>, if we don’t have it calculated).</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>list of {<code class="docutils literal notranslate"><span class="pre">None</span></code> | <a class="reference internal" href="tenpy.linalg.np_conserved.Array.html#tenpy.linalg.np_conserved.Array" title="tenpy.linalg.np_conserved.Array"><code class="xref py py-class docutils literal notranslate"><span class="pre">Array</span></code></a>}</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="tenpy.networks.mps.MPSEnvironment._RP">
<code class="sig-name descname">_RP</code><a class="headerlink" href="#tenpy.networks.mps.MPSEnvironment._RP" title="Permalink to this definition">¶</a></dt>
<dd><p>Right parts of the environment, len <cite>L</cite>.
<code class="docutils literal notranslate"><span class="pre">RP[i]</span></code> contains the contraction strictly right of site <cite>i</cite>
(or <code class="docutils literal notranslate"><span class="pre">None</span></code>, if we don’t have it calculated).</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>list of {<code class="docutils literal notranslate"><span class="pre">None</span></code> | <a class="reference internal" href="tenpy.linalg.np_conserved.Array.html#tenpy.linalg.np_conserved.Array" title="tenpy.linalg.np_conserved.Array"><code class="xref py py-class docutils literal notranslate"><span class="pre">Array</span></code></a>}</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="tenpy.networks.mps.MPSEnvironment._LP_age">
<code class="sig-name descname">_LP_age</code><a class="headerlink" href="#tenpy.networks.mps.MPSEnvironment._LP_age" title="Permalink to this definition">¶</a></dt>
<dd><p>Used for book-keeping, how large the DMRG system grew:
<code class="docutils literal notranslate"><span class="pre">_LP_age[i]</span></code> stores the number of physical sites invovled into the contraction
network which yields <code class="docutils literal notranslate"><span class="pre">self._LP[i]</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>list of int | <code class="docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="tenpy.networks.mps.MPSEnvironment._RP_age">
<code class="sig-name descname">_RP_age</code><a class="headerlink" href="#tenpy.networks.mps.MPSEnvironment._RP_age" title="Permalink to this definition">¶</a></dt>
<dd><p>Used for book-keeping, how large the DMRG system grew:
<code class="docutils literal notranslate"><span class="pre">_RP_age[i]</span></code> stores the number of physical sites invovled into the contraction
network which yields <code class="docutils literal notranslate"><span class="pre">self._RP[i]</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>list of int | <code class="docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="tenpy.networks.mps.MPSEnvironment.test_sanity">
<code class="sig-name descname">test_sanity</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/tenpy/tenpy/blob/master/tenpy/networks/mps.py#L2874-L2883"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tenpy.networks.mps.MPSEnvironment.test_sanity" title="Permalink to this definition">¶</a></dt>
<dd><p>Sanity check, raises ValueErrors, if something is wrong.</p>
</dd></dl>

<dl class="method">
<dt id="tenpy.networks.mps.MPSEnvironment.init_LP">
<code class="sig-name descname">init_LP</code><span class="sig-paren">(</span><em class="sig-param">i</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/tenpy/tenpy/blob/master/tenpy/networks/mps.py#L2885-L2903"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tenpy.networks.mps.MPSEnvironment.init_LP" title="Permalink to this definition">¶</a></dt>
<dd><p>Build initial left part <code class="docutils literal notranslate"><span class="pre">LP</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>i</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – Build <code class="docutils literal notranslate"><span class="pre">LP</span></code> left of site <cite>i</cite>.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>init_LP</strong> – Identity contractible with the <cite>vL</cite> leg of <code class="docutils literal notranslate"><span class="pre">ket.get_B(i)</span></code>, labels <code class="docutils literal notranslate"><span class="pre">'vR*',</span> <span class="pre">'vR'</span></code>.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="tenpy.linalg.np_conserved.Array.html#tenpy.linalg.np_conserved.Array" title="tenpy.linalg.np_conserved.Array"><code class="xref py py-class docutils literal notranslate"><span class="pre">Array</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="tenpy.networks.mps.MPSEnvironment.init_RP">
<code class="sig-name descname">init_RP</code><span class="sig-paren">(</span><em class="sig-param">i</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/tenpy/tenpy/blob/master/tenpy/networks/mps.py#L2905-L2923"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tenpy.networks.mps.MPSEnvironment.init_RP" title="Permalink to this definition">¶</a></dt>
<dd><p>Build initial right part <code class="docutils literal notranslate"><span class="pre">RP</span></code> for an MPS/MPOEnvironment.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>i</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – Build <code class="docutils literal notranslate"><span class="pre">RP</span></code> right of site <cite>i</cite>.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>init_RP</strong> – Identity contractible with the <cite>vR</cite> leg of <code class="docutils literal notranslate"><span class="pre">ket.get_B(i)</span></code>, labels <code class="docutils literal notranslate"><span class="pre">'vL*',</span> <span class="pre">'vL'</span></code>.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="tenpy.linalg.np_conserved.Array.html#tenpy.linalg.np_conserved.Array" title="tenpy.linalg.np_conserved.Array"><code class="xref py py-class docutils literal notranslate"><span class="pre">Array</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="tenpy.networks.mps.MPSEnvironment.get_LP">
<code class="sig-name descname">get_LP</code><span class="sig-paren">(</span><em class="sig-param">i</em>, <em class="sig-param">store=True</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/tenpy/tenpy/blob/master/tenpy/networks/mps.py#L2925-L2963"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tenpy.networks.mps.MPSEnvironment.get_LP" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate LP at given site from nearest available one (including <cite>i</cite>).</p>
<p>The returned <code class="docutils literal notranslate"><span class="pre">LP_i</span></code> corresponds to the following contraction,
where the M’s and the N’s are in the ‘A’ form:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">|</span>     <span class="o">.-------</span><span class="n">M</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">---</span> <span class="o">...</span> <span class="o">--</span><span class="n">M</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">---&gt;-</span>   <span class="s1">&#39;vR&#39;</span>
<span class="o">|</span>     <span class="o">|</span>       <span class="o">|</span>             <span class="o">|</span>
<span class="o">|</span>     <span class="n">LP</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>   <span class="o">|</span>             <span class="o">|</span>
<span class="o">|</span>     <span class="o">|</span>       <span class="o">|</span>             <span class="o">|</span>
<span class="o">|</span>     <span class="o">.-------</span><span class="n">N</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*--</span> <span class="o">...</span> <span class="o">--</span><span class="n">N</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">*--&lt;-</span>   <span class="s1">&#39;vR*&#39;</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>i</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – The returned <cite>LP</cite> will contain the contraction <em>strictly</em> left of site <cite>i</cite>.</p></li>
<li><p><strong>store</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a>) – Wheter to store the calculated <cite>LP</cite> in <cite>self</cite> (<code class="docutils literal notranslate"><span class="pre">True</span></code>) or discard them (<code class="docutils literal notranslate"><span class="pre">False</span></code>).</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>LP_i</strong> – Contraction of everything left of site <cite>i</cite>,
with labels <code class="docutils literal notranslate"><span class="pre">'vR*',</span> <span class="pre">'vR'</span></code> for <cite>bra</cite>, <cite>ket</cite>.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="tenpy.linalg.np_conserved.Array.html#tenpy.linalg.np_conserved.Array" title="tenpy.linalg.np_conserved.Array"><code class="xref py py-class docutils literal notranslate"><span class="pre">Array</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="tenpy.networks.mps.MPSEnvironment.get_RP">
<code class="sig-name descname">get_RP</code><span class="sig-paren">(</span><em class="sig-param">i</em>, <em class="sig-param">store=True</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/tenpy/tenpy/blob/master/tenpy/networks/mps.py#L2965-L3002"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tenpy.networks.mps.MPSEnvironment.get_RP" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate RP at given site from nearest available one (including <cite>i</cite>).</p>
<p>The returned <code class="docutils literal notranslate"><span class="pre">RP_i</span></code> corresponds to the following contraction,
where the M’s and the N’s are in the ‘B’ form:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">|</span>     <span class="s1">&#39;vL&#39;</span>  <span class="o">-&gt;---</span><span class="n">M</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">--</span> <span class="o">...</span> <span class="o">--</span><span class="n">M</span><span class="p">[</span><span class="n">L</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">----.</span>
<span class="o">|</span>                <span class="o">|</span>              <span class="o">|</span>         <span class="o">|</span>
<span class="o">|</span>                <span class="o">|</span>              <span class="o">|</span>         <span class="n">RP</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="o">|</span>                <span class="o">|</span>              <span class="o">|</span>         <span class="o">|</span>
<span class="o">|</span>     <span class="s1">&#39;vL*&#39;</span> <span class="o">-&lt;---</span><span class="n">N</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">*-</span> <span class="o">...</span> <span class="o">--</span><span class="n">N</span><span class="p">[</span><span class="n">L</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">*---.</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>i</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – The returned <cite>RP</cite> will contain the contraction <em>strictly</em> right of site <cite>i</cite>.</p></li>
<li><p><strong>store</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a>) – Wheter to store the calculated <cite>RP</cite> in <cite>self</cite> (<code class="docutils literal notranslate"><span class="pre">True</span></code>) or discard them (<code class="docutils literal notranslate"><span class="pre">False</span></code>).</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>RP_i</strong> – Contraction of everything left of site <cite>i</cite>,
with labels <code class="docutils literal notranslate"><span class="pre">'vL*',</span> <span class="pre">'vL'</span></code> for <cite>bra</cite>, <cite>ket</cite>.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="tenpy.linalg.np_conserved.Array.html#tenpy.linalg.np_conserved.Array" title="tenpy.linalg.np_conserved.Array"><code class="xref py py-class docutils literal notranslate"><span class="pre">Array</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="tenpy.networks.mps.MPSEnvironment.get_LP_age">
<code class="sig-name descname">get_LP_age</code><span class="sig-paren">(</span><em class="sig-param">i</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/tenpy/tenpy/blob/master/tenpy/networks/mps.py#L3004-L3009"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tenpy.networks.mps.MPSEnvironment.get_LP_age" title="Permalink to this definition">¶</a></dt>
<dd><p>Return number of physical sites in the contractions of get_LP(i).</p>
<p>Might be <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p>
</dd></dl>

<dl class="method">
<dt id="tenpy.networks.mps.MPSEnvironment.get_RP_age">
<code class="sig-name descname">get_RP_age</code><span class="sig-paren">(</span><em class="sig-param">i</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/tenpy/tenpy/blob/master/tenpy/networks/mps.py#L3011-L3016"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tenpy.networks.mps.MPSEnvironment.get_RP_age" title="Permalink to this definition">¶</a></dt>
<dd><p>Return number of physical sites in the contractions of get_RP(i).</p>
<p>Might be <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p>
</dd></dl>

<dl class="method">
<dt id="tenpy.networks.mps.MPSEnvironment.set_LP">
<code class="sig-name descname">set_LP</code><span class="sig-paren">(</span><em class="sig-param">i</em>, <em class="sig-param">LP</em>, <em class="sig-param">age</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/tenpy/tenpy/blob/master/tenpy/networks/mps.py#L3018-L3022"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tenpy.networks.mps.MPSEnvironment.set_LP" title="Permalink to this definition">¶</a></dt>
<dd><p>Store part to the left of site <cite>i</cite>.</p>
</dd></dl>

<dl class="method">
<dt id="tenpy.networks.mps.MPSEnvironment.set_RP">
<code class="sig-name descname">set_RP</code><span class="sig-paren">(</span><em class="sig-param">i</em>, <em class="sig-param">RP</em>, <em class="sig-param">age</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/tenpy/tenpy/blob/master/tenpy/networks/mps.py#L3024-L3028"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tenpy.networks.mps.MPSEnvironment.set_RP" title="Permalink to this definition">¶</a></dt>
<dd><p>Store part to the right of site <cite>i</cite>.</p>
</dd></dl>

<dl class="method">
<dt id="tenpy.networks.mps.MPSEnvironment.del_LP">
<code class="sig-name descname">del_LP</code><span class="sig-paren">(</span><em class="sig-param">i</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/tenpy/tenpy/blob/master/tenpy/networks/mps.py#L3030-L3034"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tenpy.networks.mps.MPSEnvironment.del_LP" title="Permalink to this definition">¶</a></dt>
<dd><p>Delete stored part strictly to the left of site <cite>i</cite>.</p>
</dd></dl>

<dl class="method">
<dt id="tenpy.networks.mps.MPSEnvironment.del_RP">
<code class="sig-name descname">del_RP</code><span class="sig-paren">(</span><em class="sig-param">i</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/tenpy/tenpy/blob/master/tenpy/networks/mps.py#L3036-L3040"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tenpy.networks.mps.MPSEnvironment.del_RP" title="Permalink to this definition">¶</a></dt>
<dd><p>Delete storde part scrictly to the right of site <cite>i</cite>.</p>
</dd></dl>

<dl class="method">
<dt id="tenpy.networks.mps.MPSEnvironment.full_contraction">
<code class="sig-name descname">full_contraction</code><span class="sig-paren">(</span><em class="sig-param">i0</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/tenpy/tenpy/blob/master/tenpy/networks/mps.py#L3042-L3071"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tenpy.networks.mps.MPSEnvironment.full_contraction" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the overlap by a full contraction of the network.</p>
<p>The full contraction of the environments gives the overlap <code class="docutils literal notranslate"><span class="pre">&lt;bra|ket&gt;</span></code>,
taking into account <a class="reference internal" href="tenpy.networks.mps.MPS.html#tenpy.networks.mps.MPS.norm" title="tenpy.networks.mps.MPS.norm"><code class="xref py py-attr docutils literal notranslate"><span class="pre">MPS.norm</span></code></a> of both <cite>bra</cite> and <cite>ket</cite>.
For this purpose, this function contracts
<code class="docutils literal notranslate"><span class="pre">get_LP(i0+1,</span> <span class="pre">store=False)</span></code> and <code class="docutils literal notranslate"><span class="pre">get_RP(i0,</span> <span class="pre">store=False)</span></code> with appropriate singular
values in between.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>i0</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – Site index.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="tenpy.networks.mps.MPSEnvironment.expectation_value">
<code class="sig-name descname">expectation_value</code><span class="sig-paren">(</span><em class="sig-param">ops</em>, <em class="sig-param">sites=None</em>, <em class="sig-param">axes=None</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/tenpy/tenpy/blob/master/tenpy/networks/mps.py#L3073-L3160"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tenpy.networks.mps.MPSEnvironment.expectation_value" title="Permalink to this definition">¶</a></dt>
<dd><p>Expectation value <code class="docutils literal notranslate"><span class="pre">&lt;bra|ops|ket&gt;</span></code> of (n-site) operator(s).</p>
<p>Calculates n-site expectation values of operators sandwiched between bra and ket.
For examples the contraction for a two-site operator on site <cite>i</cite> would look like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">|</span>          <span class="o">.--</span><span class="n">S</span><span class="o">--</span><span class="n">B</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">--</span><span class="n">B</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">--.</span>
<span class="o">|</span>          <span class="o">|</span>     <span class="o">|</span>     <span class="o">|</span>       <span class="o">|</span>
<span class="o">|</span>          <span class="o">|</span>     <span class="o">|-----|</span>       <span class="o">|</span>
<span class="o">|</span>          <span class="n">LP</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">|</span> <span class="n">op</span>  <span class="o">|</span>       <span class="n">RP</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
<span class="o">|</span>          <span class="o">|</span>     <span class="o">|-----|</span>       <span class="o">|</span>
<span class="o">|</span>          <span class="o">|</span>     <span class="o">|</span>     <span class="o">|</span>       <span class="o">|</span>
<span class="o">|</span>          <span class="o">.--</span><span class="n">S</span><span class="o">--</span><span class="n">B</span><span class="o">*</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-</span><span class="n">B</span><span class="o">*</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">-.</span>
</pre></div>
</div>
<p>Here, the <cite>B</cite> are taken from <cite>ket</cite>, the <cite>B*</cite> from <cite>bra</cite>.
The call structure is the same as for <a class="reference internal" href="tenpy.networks.mps.MPS.html#tenpy.networks.mps.MPS.expectation_value" title="tenpy.networks.mps.MPS.expectation_value"><code class="xref py py-meth docutils literal notranslate"><span class="pre">MPS.expectation_value()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ops</strong> ((list of) { <a class="reference internal" href="tenpy.linalg.np_conserved.Array.html#tenpy.linalg.np_conserved.Array" title="tenpy.linalg.np_conserved.Array"><code class="xref py py-class docutils literal notranslate"><span class="pre">Array</span></code></a> | str }) – The operators, for wich the expectation value should be taken,
All operators should all have the same number of legs (namely <cite>2 n</cite>).
If less than <code class="docutils literal notranslate"><span class="pre">len(sites)</span></code> operators are given, we repeat them periodically.
Strings (like <code class="docutils literal notranslate"><span class="pre">'Id',</span> <span class="pre">'Sz'</span></code>) are translated into single-site operators defined by
<code class="xref py py-attr docutils literal notranslate"><span class="pre">sites</span></code>.</p></li>
<li><p><strong>sites</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.8)"><em>list</em></a>) – List of site indices. Expectation values are evaluated there.
If <code class="docutils literal notranslate"><span class="pre">None</span></code> (default), the entire chain is taken (clipping for finite b.c.)</p></li>
<li><p><strong>axes</strong> (<em>None |</em><em> (</em><em>list of str</em><em>, </em><em>list of str</em><em>)</em>) – Two lists of each <cite>n</cite> leg labels giving the physical legs of the operator used for
contraction. The first <cite>n</cite> legs are contracted with conjugated <cite>B</cite>,
the second <cite>n</cite> legs with the non-conjugated <cite>B</cite>.
<code class="docutils literal notranslate"><span class="pre">None</span></code> defaults to <code class="docutils literal notranslate"><span class="pre">(['p'],</span> <span class="pre">['p*'])</span></code> for single site (n=1), or
<code class="docutils literal notranslate"><span class="pre">(['p0',</span> <span class="pre">'p1',</span> <span class="pre">...</span> <span class="pre">'p{n-1}'],</span> <span class="pre">['p0*',</span> <span class="pre">'p1*',</span> <span class="pre">....</span> <span class="pre">'p{n-1}*'])</span></code> for <cite>n</cite> &gt; 1.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>exp_vals</strong> – Expectation values, <code class="docutils literal notranslate"><span class="pre">exp_vals[i]</span> <span class="pre">=</span> <span class="pre">&lt;bra|ops[i]|ket&gt;</span></code>, where <code class="docutils literal notranslate"><span class="pre">ops[i]</span></code> acts on
site(s) <code class="docutils literal notranslate"><span class="pre">j,</span> <span class="pre">j+1,</span> <span class="pre">...,</span> <span class="pre">j+{n-1}</span></code> with <code class="docutils literal notranslate"><span class="pre">j=sites[i]</span></code>.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>1D ndarray</p>
</dd>
</dl>
<div class="admonition-examples admonition">
<p class="admonition-title">Examples</p>
<p>One site examples (n=1):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">env</span><span class="o">.</span><span class="n">expectation_value</span><span class="p">(</span><span class="s1">&#39;Sz&#39;</span><span class="p">)</span>
<span class="go">[Sz0, Sz1, ..., Sz{L-1}]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">env</span><span class="o">.</span><span class="n">expectation_value</span><span class="p">([</span><span class="s1">&#39;Sz&#39;</span><span class="p">,</span> <span class="s1">&#39;Sx&#39;</span><span class="p">])</span>
<span class="go">[Sz0, Sx1, Sz2, Sx3, ... ]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">env</span><span class="o">.</span><span class="n">expectation_value</span><span class="p">(</span><span class="s1">&#39;Sz&#39;</span><span class="p">,</span> <span class="n">sites</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
<span class="go">[Sz0, Sz3, Sz4]</span>
</pre></div>
</div>
<p>Two site example (n=2), assuming homogeneous sites:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">SzSx</span> <span class="o">=</span> <span class="n">npc</span><span class="o">.</span><span class="n">outer</span><span class="p">(</span><span class="n">psi</span><span class="o">.</span><span class="n">sites</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Sz</span><span class="o">.</span><span class="n">replace_labels</span><span class="p">([</span><span class="s1">&#39;p&#39;</span><span class="p">,</span> <span class="s1">&#39;p*&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;p0&#39;</span><span class="p">,</span> <span class="s1">&#39;p0*&#39;</span><span class="p">]),</span>
<span class="go">                     psi.sites[1].Sx.replace_labels([&#39;p&#39;, &#39;p*&#39;], [&#39;p1&#39;, &#39;p1*&#39;]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">env</span><span class="o">.</span><span class="n">expectation_value</span><span class="p">(</span><span class="n">SzSx</span><span class="p">)</span>
<span class="go">[Sz0Sx1, Sz1Sx2, Sz2Sx3, ... ]   # with len L-1 for finite bc, or L for infinite</span>
</pre></div>
</div>
<p>Example measuring &lt;bra|SzSx|ket&gt; on each second site, for inhomogeneous sites:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">SzSx_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">npc</span><span class="o">.</span><span class="n">outer</span><span class="p">(</span><span class="n">psi</span><span class="o">.</span><span class="n">sites</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">Sz</span><span class="o">.</span><span class="n">replace_labels</span><span class="p">([</span><span class="s1">&#39;p&#39;</span><span class="p">,</span> <span class="s1">&#39;p*&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;p0&#39;</span><span class="p">,</span> <span class="s1">&#39;p0*&#39;</span><span class="p">]),</span>
<span class="go">                           psi.sites[i+1].Sx.replace_labels([&#39;p&#39;, &#39;p*&#39;], [&#39;p1&#39;, &#39;p1*&#39;]))</span>
<span class="go">                 for i in range(0, psi.L-1, 2)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">env</span><span class="o">.</span><span class="n">expectation_value</span><span class="p">(</span><span class="n">SzSx_list</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">psi</span><span class="o">.</span><span class="n">L</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="go">[Sz0Sx1, Sz2Sx3, Sz4Sx5, ...]</span>
</pre></div>
</div>
</div>
</dd></dl>

</dd></dl>

</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/logo.png" alt="Logo"/>
            </a></p>
  <h4>Previous topic</h4>
  <p class="topless"><a href="tenpy.networks.mps.MPS.html"
                        title="previous chapter">MPS</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="tenpy.networks.mps.TransferMatrix.html"
                        title="next chapter">TransferMatrix</a></p>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
<h3><a href="../index.html">Table of Contents</a></h3>
<p class="caption"><span class="caption-text">User guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../INSTALL.html">Installation instructions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../releases.html">Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../introductions.html">Introductions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../literature.html">Literature</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contributing.html">Contributing</a></li>
</ul>
<p class="caption"><span class="caption-text">Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../main.html">Tenpy main module</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="tenpy.algorithms.html">algorithms</a></li>
<li class="toctree-l1"><a class="reference internal" href="tenpy.linalg.html">linalg</a></li>
<li class="toctree-l1"><a class="reference internal" href="tenpy.models.html">models</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="tenpy.networks.html">networks</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="tenpy.networks.site.html">site</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="tenpy.networks.mps.html">mps</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="tenpy.networks.mps.MPS.html">MPS</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">MPSEnvironment</a></li>
<li class="toctree-l3"><a class="reference internal" href="tenpy.networks.mps.TransferMatrix.html">TransferMatrix</a></li>
<li class="toctree-l3"><a class="reference internal" href="tenpy.networks.mps.build_initial_state.html">build_initial_state</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="tenpy.networks.mpo.html">mpo</a></li>
<li class="toctree-l2"><a class="reference internal" href="tenpy.networks.terms.html">terms</a></li>
<li class="toctree-l2"><a class="reference internal" href="tenpy.networks.purification_mps.html">purification_mps</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="tenpy.tools.html">tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="tenpy.version.html">version</a></li>
</ul>

        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="tenpy.networks.mps.TransferMatrix.html" title="TransferMatrix"
             >next</a> |</li>
        <li class="right" >
          <a href="tenpy.networks.mps.MPS.html" title="MPS"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">TeNPy 0.5.0.dev41+e0e9515 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="tenpy.networks.html" >networks</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="tenpy.networks.mps.html" >mps</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2016-2020, TeNPy Developers.
      Last updated on Jan 16, 2020.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 2.2.2.
    </div>
  </body>
</html>