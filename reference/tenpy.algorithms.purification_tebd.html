
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>tenpy.algorithms.purification_tebd module &#8212; TeNPy 0.3.0 documentation</title>
    <link rel="stylesheet" href="../_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/language_data.js"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <link rel="shortcut icon" href="../_static/logo.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="tenpy.algorithms.tebd module" href="tenpy.algorithms.tebd.html" />
    <link rel="prev" title="tenpy.algorithms.network_contractor module" href="tenpy.algorithms.network_contractor.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="tenpy.algorithms.tebd.html" title="tenpy.algorithms.tebd module"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="tenpy.algorithms.network_contractor.html" title="tenpy.algorithms.network_contractor module"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">TeNPy 0.3.0 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="tenpy.html" >Reference</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="tenpy.algorithms.html" accesskey="U">tenpy.algorithms package</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="module-tenpy.algorithms.purification_tebd">
<span id="tenpy-algorithms-purification-tebd-module"></span><h1>tenpy.algorithms.purification_tebd module<a class="headerlink" href="#module-tenpy.algorithms.purification_tebd" title="Permalink to this headline">¶</a></h1>
<p>Time evolving block decimation (TEBD) for MPS of purification.</p>
<p>See introduction in <a class="reference internal" href="tenpy.networks.purification_mps.html#module-tenpy.networks.purification_mps" title="tenpy.networks.purification_mps"><code class="xref py py-mod docutils literal notranslate"><span class="pre">purification_mps</span></code></a>.
Time evolution for finite-temperature ensembles.
This can be used to obtain correlation functions in time.</p>
<dl class="class">
<dt id="tenpy.algorithms.purification_tebd.PurificationTEBD">
<em class="property">class </em><code class="descclassname">tenpy.algorithms.purification_tebd.</code><code class="descname">PurificationTEBD</code><span class="sig-paren">(</span><em>psi</em>, <em>model</em>, <em>TEBD_params</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tenpy/algorithms/purification_tebd.html#PurificationTEBD"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tenpy.algorithms.purification_tebd.PurificationTEBD" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="tenpy.algorithms.tebd.html#tenpy.algorithms.tebd.Engine" title="tenpy.algorithms.tebd.Engine"><code class="xref py py-class docutils literal notranslate"><span class="pre">tenpy.algorithms.tebd.Engine</span></code></a></p>
<p>Time evolving block decimation (TEBD) for purification MPS.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>psi</strong> <span class="classifier-delimiter">:</span> <span class="classifier"><code class="xref py py-class docutils literal notranslate"><span class="pre">PurificationMPS</span></code></span></dt>
<dd><p class="first last">Initial state to be time evolved. Modified in place.</p>
</dd>
<dt><strong>model</strong> <span class="classifier-delimiter">:</span> <span class="classifier"><code class="xref py py-class docutils literal notranslate"><span class="pre">NearestNeighborModel</span></code></span></dt>
<dd><p class="first last">The model representing the Hamiltonian for which we want to find the ground state.</p>
</dd>
<dt><strong>TEBD_params</strong> <span class="classifier-delimiter">:</span> <span class="classifier">dict</span></dt>
<dd><p class="first last">Further optional parameters as described in the following table.
Use <code class="docutils literal notranslate"><span class="pre">verbose=1</span></code> to print the used parameters during runtime.
See <a class="reference internal" href="#tenpy.algorithms.purification_tebd.PurificationTEBD.run" title="tenpy.algorithms.purification_tebd.PurificationTEBD.run"><code class="xref py py-func docutils literal notranslate"><span class="pre">run()</span></code></a> and <a class="reference internal" href="#tenpy.algorithms.purification_tebd.PurificationTEBD.run_GS" title="tenpy.algorithms.purification_tebd.PurificationTEBD.run_GS"><code class="xref py py-func docutils literal notranslate"><span class="pre">run_GS()</span></code></a> for more details.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Attributes:</th><td class="field-body"><dl class="first last docutils">
<dt><a class="reference internal" href="#tenpy.algorithms.purification_tebd.PurificationTEBD.disent_iterations" title="tenpy.algorithms.purification_tebd.PurificationTEBD.disent_iterations"><code class="xref py py-obj docutils literal notranslate"><span class="pre">disent_iterations</span></code></a></dt>
<dd><p class="first last">For each bond the total number of iterations performed in any <a class="reference internal" href="#tenpy.algorithms.purification_tebd.Disentangler" title="tenpy.algorithms.purification_tebd.Disentangler"><code class="xref py py-class docutils literal notranslate"><span class="pre">Disentangler</span></code></a>.</p>
</dd>
<dt><strong>used_disentangler</strong> <span class="classifier-delimiter">:</span> <span class="classifier"><a class="reference internal" href="#tenpy.algorithms.purification_tebd.Disentangler" title="tenpy.algorithms.purification_tebd.Disentangler"><code class="xref py py-class docutils literal notranslate"><span class="pre">Disentangler</span></code></a></span></dt>
<dd><p class="first last">The disentangler to be used on the auxiliar indices.
Chosen by <a class="reference internal" href="#tenpy.algorithms.purification_tebd.get_disentangler" title="tenpy.algorithms.purification_tebd.get_disentangler"><code class="xref py py-func docutils literal notranslate"><span class="pre">get_disentangler()</span></code></a>, called with the TEBD parameter <code class="docutils literal notranslate"><span class="pre">'disentangle'</span></code>.
Defaults to the trivial disentangler for <code class="docutils literal notranslate"><span class="pre">TEBD_params['disentangle']=None</span></code>.</p>
</dd>
<dt><strong>_disent_iterations</strong> <span class="classifier-delimiter">:</span> <span class="classifier">1D ndarray</span></dt>
<dd><p class="first last">Number of iterations performed on all bonds, including trivial bonds; lenght <cite>L</cite>.</p>
</dd>
<dt><strong>_guess_U_disent</strong> <span class="classifier-delimiter">:</span> <span class="classifier">list of list of npc.Array</span></dt>
<dd><p class="first last">Same index strucuture as <cite>self._U</cite>: for each two-site U of the physical time evolution
the disentangler from the last application. Initialized to identities.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#tenpy.algorithms.purification_tebd.PurificationTEBD.calc_U" title="tenpy.algorithms.purification_tebd.PurificationTEBD.calc_U"><code class="xref py py-obj docutils literal notranslate"><span class="pre">calc_U</span></code></a>(order,&nbsp;delta_t[,&nbsp;type_evo,&nbsp;E_offset])</td>
<td>see <code class="xref py py-meth docutils literal notranslate"><span class="pre">calc_U()</span></code></td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#tenpy.algorithms.purification_tebd.PurificationTEBD.disentangle" title="tenpy.algorithms.purification_tebd.PurificationTEBD.disentangle"><code class="xref py py-obj docutils literal notranslate"><span class="pre">disentangle</span></code></a>(theta)</td>
<td>Disentangle <cite>theta</cite> before splitting with svd.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#tenpy.algorithms.purification_tebd.PurificationTEBD.disentangle_global" title="tenpy.algorithms.purification_tebd.PurificationTEBD.disentangle_global"><code class="xref py py-obj docutils literal notranslate"><span class="pre">disentangle_global</span></code></a>([pair])</td>
<td>Try global disentangling by determining the maximally entangled pairs of sites.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#tenpy.algorithms.purification_tebd.PurificationTEBD.disentangle_global_nsite" title="tenpy.algorithms.purification_tebd.PurificationTEBD.disentangle_global_nsite"><code class="xref py py-obj docutils literal notranslate"><span class="pre">disentangle_global_nsite</span></code></a>([n])</td>
<td>Perform a sweep through the system and disentangle with <a class="reference internal" href="#tenpy.algorithms.purification_tebd.PurificationTEBD.disentangle_n_site" title="tenpy.algorithms.purification_tebd.PurificationTEBD.disentangle_n_site"><code class="xref py py-meth docutils literal notranslate"><span class="pre">disentangle_n_site()</span></code></a>.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#tenpy.algorithms.purification_tebd.PurificationTEBD.disentangle_n_site" title="tenpy.algorithms.purification_tebd.PurificationTEBD.disentangle_n_site"><code class="xref py py-obj docutils literal notranslate"><span class="pre">disentangle_n_site</span></code></a>(i,&nbsp;n,&nbsp;theta)</td>
<td>Generalization of <a class="reference internal" href="#tenpy.algorithms.purification_tebd.PurificationTEBD.disentangle" title="tenpy.algorithms.purification_tebd.PurificationTEBD.disentangle"><code class="xref py py-meth docutils literal notranslate"><span class="pre">disentangle()</span></code></a> to <cite>n</cite> sites.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#tenpy.algorithms.purification_tebd.PurificationTEBD.run" title="tenpy.algorithms.purification_tebd.PurificationTEBD.run"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code></a>()</td>
<td>(Real-)time evolution with TEBD (time evolving block decimation).</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#tenpy.algorithms.purification_tebd.PurificationTEBD.run_GS" title="tenpy.algorithms.purification_tebd.PurificationTEBD.run_GS"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run_GS</span></code></a>()</td>
<td>TEBD algorithm in imaginary time to find the ground state.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#tenpy.algorithms.purification_tebd.PurificationTEBD.run_imaginary" title="tenpy.algorithms.purification_tebd.PurificationTEBD.run_imaginary"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run_imaginary</span></code></a>(beta)</td>
<td>Run imaginary time evolution to cool down to the given <cite>beta</cite>.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#tenpy.algorithms.purification_tebd.PurificationTEBD.suzuki_trotter_decomposition" title="tenpy.algorithms.purification_tebd.PurificationTEBD.suzuki_trotter_decomposition"><code class="xref py py-obj docutils literal notranslate"><span class="pre">suzuki_trotter_decomposition</span></code></a>(order,&nbsp;N_steps)</td>
<td>Returns list of necessary steps for the suzuki trotter decomposition.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#tenpy.algorithms.purification_tebd.PurificationTEBD.suzuki_trotter_time_steps" title="tenpy.algorithms.purification_tebd.PurificationTEBD.suzuki_trotter_time_steps"><code class="xref py py-obj docutils literal notranslate"><span class="pre">suzuki_trotter_time_steps</span></code></a>(order)</td>
<td>Return time steps of U for the Suzuki Trotter decomposition of desired order.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#tenpy.algorithms.purification_tebd.PurificationTEBD.update" title="tenpy.algorithms.purification_tebd.PurificationTEBD.update"><code class="xref py py-obj docutils literal notranslate"><span class="pre">update</span></code></a>(N_steps)</td>
<td>Evolve by <code class="docutils literal notranslate"><span class="pre">N_steps</span> <span class="pre">*</span> <span class="pre">U_param['dt']</span></code>.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#tenpy.algorithms.purification_tebd.PurificationTEBD.update_bond" title="tenpy.algorithms.purification_tebd.PurificationTEBD.update_bond"><code class="xref py py-obj docutils literal notranslate"><span class="pre">update_bond</span></code></a>(i,&nbsp;U_bond)</td>
<td>Updates the B matrices on a given bond.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#tenpy.algorithms.purification_tebd.PurificationTEBD.update_bond_imag" title="tenpy.algorithms.purification_tebd.PurificationTEBD.update_bond_imag"><code class="xref py py-obj docutils literal notranslate"><span class="pre">update_bond_imag</span></code></a>(i,&nbsp;U_bond)</td>
<td>Update a bond with a (possibly non-unitary) <cite>U_bond</cite>.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#tenpy.algorithms.purification_tebd.PurificationTEBD.update_imag" title="tenpy.algorithms.purification_tebd.PurificationTEBD.update_imag"><code class="xref py py-obj docutils literal notranslate"><span class="pre">update_imag</span></code></a>(N_steps)</td>
<td>Perform an update suitable for imaginary time evolution.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#tenpy.algorithms.purification_tebd.PurificationTEBD.update_step" title="tenpy.algorithms.purification_tebd.PurificationTEBD.update_step"><code class="xref py py-obj docutils literal notranslate"><span class="pre">update_step</span></code></a>(U_idx_dt,&nbsp;odd)</td>
<td>Updates either even <em>or</em> odd bonds in unit cell.</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="tenpy.algorithms.purification_tebd.PurificationTEBD.calc_U">
<code class="descname">calc_U</code><span class="sig-paren">(</span><em>order</em>, <em>delta_t</em>, <em>type_evo='real'</em>, <em>E_offset=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tenpy/algorithms/purification_tebd.html#PurificationTEBD.calc_U"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tenpy.algorithms.purification_tebd.PurificationTEBD.calc_U" title="Permalink to this definition">¶</a></dt>
<dd><p>see <code class="xref py py-meth docutils literal notranslate"><span class="pre">calc_U()</span></code></p>
</dd></dl>

<dl class="attribute">
<dt id="tenpy.algorithms.purification_tebd.PurificationTEBD.disent_iterations">
<code class="descname">disent_iterations</code><a class="headerlink" href="#tenpy.algorithms.purification_tebd.PurificationTEBD.disent_iterations" title="Permalink to this definition">¶</a></dt>
<dd><p>For each bond the total number of iterations performed in any <a class="reference internal" href="#tenpy.algorithms.purification_tebd.Disentangler" title="tenpy.algorithms.purification_tebd.Disentangler"><code class="xref py py-class docutils literal notranslate"><span class="pre">Disentangler</span></code></a>.</p>
</dd></dl>

<dl class="method">
<dt id="tenpy.algorithms.purification_tebd.PurificationTEBD.disentangle">
<code class="descname">disentangle</code><span class="sig-paren">(</span><em>theta</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tenpy/algorithms/purification_tebd.html#PurificationTEBD.disentangle"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tenpy.algorithms.purification_tebd.PurificationTEBD.disentangle" title="Permalink to this definition">¶</a></dt>
<dd><p>Disentangle <cite>theta</cite> before splitting with svd.</p>
<p>For the purification we write <span class="math notranslate nohighlight">\(\rho_P = Tr_Q{|\psi_{P,Q}&gt;&lt;\psi_{P,Q}|}\)</span>. Thus, we
can actually apply any unitary to the auxiliar <cite>Q</cite> space of <span class="math notranslate nohighlight">\(|\psi&gt;\)</span> without
changing the result.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">We have to apply the <em>same</em> unitary to the ‘bra’ and ‘ket’ used for expectation values
/ correlation functions!</p>
</div>
<p>The behaviour of this function is set by <code class="xref py py-attr docutils literal notranslate"><span class="pre">used_disentangler</span></code>,
which in turn is obtained from <code class="docutils literal notranslate"><span class="pre">get_disentangler(TEBD_params['disentangle'])</span></code>,
see <a class="reference internal" href="#tenpy.algorithms.purification_tebd.get_disentangler" title="tenpy.algorithms.purification_tebd.get_disentangler"><code class="xref py py-func docutils literal notranslate"><span class="pre">get_disentangler()</span></code></a> for details on the syntax.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>theta</strong> <span class="classifier-delimiter">:</span> <span class="classifier"><a class="reference internal" href="tenpy.linalg.np_conserved.html#tenpy.linalg.np_conserved.Array" title="tenpy.linalg.np_conserved.Array"><code class="xref py py-class docutils literal notranslate"><span class="pre">Array</span></code></a></span></dt>
<dd><p class="first last">Wave function to disentangle, with legs <code class="docutils literal notranslate"><span class="pre">'vL',</span> <span class="pre">'vR',</span> <span class="pre">'p0',</span> <span class="pre">'p1',</span> <span class="pre">'q0',</span> <span class="pre">'q1'</span></code>.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>theta_disentangled</strong> <span class="classifier-delimiter">:</span> <span class="classifier"><a class="reference internal" href="tenpy.linalg.np_conserved.html#tenpy.linalg.np_conserved.Array" title="tenpy.linalg.np_conserved.Array"><code class="xref py py-class docutils literal notranslate"><span class="pre">Array</span></code></a></span></dt>
<dd><p class="first last">Disentangled <cite>theta</cite>; <code class="docutils literal notranslate"><span class="pre">npc.tensordot(U,</span> <span class="pre">theta,</span> <span class="pre">axes=[['q0*',</span> <span class="pre">'q1*'],</span> <span class="pre">['q0',</span> <span class="pre">'q1']])</span></code>.</p>
</dd>
<dt><strong>U</strong> <span class="classifier-delimiter">:</span> <span class="classifier"><code class="xref py py-class docutils literal notranslate"><span class="pre">Array</span></code></span></dt>
<dd><p class="first last">The unitary used to disentangle <cite>theta</cite>, with labels <code class="docutils literal notranslate"><span class="pre">'q0',</span> <span class="pre">'q1',</span> <span class="pre">'q0*',</span> <span class="pre">'q1*'</span></code>.
If no unitary was found/applied, it might also be <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="tenpy.algorithms.purification_tebd.PurificationTEBD.disentangle_global">
<code class="descname">disentangle_global</code><span class="sig-paren">(</span><em>pair=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tenpy/algorithms/purification_tebd.html#PurificationTEBD.disentangle_global"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tenpy.algorithms.purification_tebd.PurificationTEBD.disentangle_global" title="Permalink to this definition">¶</a></dt>
<dd><p>Try global disentangling by determining the maximally entangled pairs of sites.</p>
<p>Caclulate the mutual information (in the auxiliar space) between two sites
and determine where it is maximal. Disentangle these two sites with <a class="reference internal" href="#tenpy.algorithms.purification_tebd.PurificationTEBD.disentangle" title="tenpy.algorithms.purification_tebd.PurificationTEBD.disentangle"><code class="xref py py-meth docutils literal notranslate"><span class="pre">disentangle()</span></code></a></p>
</dd></dl>

<dl class="method">
<dt id="tenpy.algorithms.purification_tebd.PurificationTEBD.disentangle_global_nsite">
<code class="descname">disentangle_global_nsite</code><span class="sig-paren">(</span><em>n=2</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tenpy/algorithms/purification_tebd.html#PurificationTEBD.disentangle_global_nsite"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tenpy.algorithms.purification_tebd.PurificationTEBD.disentangle_global_nsite" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform a sweep through the system and disentangle with <a class="reference internal" href="#tenpy.algorithms.purification_tebd.PurificationTEBD.disentangle_n_site" title="tenpy.algorithms.purification_tebd.PurificationTEBD.disentangle_n_site"><code class="xref py py-meth docutils literal notranslate"><span class="pre">disentangle_n_site()</span></code></a>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>n: int</strong></dt>
<dd><p class="first last">maximal number of sites to disentangle at once.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="tenpy.algorithms.purification_tebd.PurificationTEBD.disentangle_n_site">
<code class="descname">disentangle_n_site</code><span class="sig-paren">(</span><em>i</em>, <em>n</em>, <em>theta</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tenpy/algorithms/purification_tebd.html#PurificationTEBD.disentangle_n_site"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tenpy.algorithms.purification_tebd.PurificationTEBD.disentangle_n_site" title="Permalink to this definition">¶</a></dt>
<dd><p>Generalization of <a class="reference internal" href="#tenpy.algorithms.purification_tebd.PurificationTEBD.disentangle" title="tenpy.algorithms.purification_tebd.PurificationTEBD.disentangle"><code class="xref py py-meth docutils literal notranslate"><span class="pre">disentangle()</span></code></a> to <cite>n</cite> sites.</p>
<p>Simply group left and right <cite>n</cite>/2 physical legs, adjust labels, and
apply <a class="reference internal" href="#tenpy.algorithms.purification_tebd.PurificationTEBD.disentangle" title="tenpy.algorithms.purification_tebd.PurificationTEBD.disentangle"><code class="xref py py-meth docutils literal notranslate"><span class="pre">disentangle()</span></code></a> to disentangle the central bond.
Recursively proceed to disentangle left and right parts afterwards.
Scales (for even <cite>n</cite>) as <span class="math notranslate nohighlight">\(O(\chi^3 d^n d^{n/2})\)</span>.</p>
</dd></dl>

<dl class="method">
<dt id="tenpy.algorithms.purification_tebd.PurificationTEBD.run">
<code class="descname">run</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#tenpy.algorithms.purification_tebd.PurificationTEBD.run" title="Permalink to this definition">¶</a></dt>
<dd><p>(Real-)time evolution with TEBD (time evolving block decimation).</p>
<p>The following (optional) parameters are read out from the <code class="xref py py-attr docutils literal notranslate"><span class="pre">TEBD_params</span></code>.</p>
<table border="1" class="docutils">
<colgroup>
<col width="19%" />
<col width="8%" />
<col width="73%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">key</th>
<th class="head">type</th>
<th class="head">description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>dt</td>
<td>float</td>
<td>Time step.</td>
</tr>
<tr class="row-odd"><td>order</td>
<td>int</td>
<td><dl class="first last docutils">
<dt>Order of the algorithm.</dt>
<dd>The total error scales as O(t, dt^order).</dd>
</dl>
</td>
</tr>
<tr class="row-even"><td>N_steps</td>
<td>int</td>
<td>Number of time steps <cite>dt</cite> to evolve.
(The Trotter decompositions of order &gt; 1 are slightly
more efficient if more than one step is performed at
once.)</td>
</tr>
<tr class="row-odd"><td>trunc_params</td>
<td>dict</td>
<td>Truncation parameters as described in
<a class="reference internal" href="tenpy.algorithms.truncation.html#tenpy.algorithms.truncation.truncate" title="tenpy.algorithms.truncation.truncate"><code class="xref py py-func docutils literal notranslate"><span class="pre">truncate()</span></code></a>.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="tenpy.algorithms.purification_tebd.PurificationTEBD.run_GS">
<code class="descname">run_GS</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#tenpy.algorithms.purification_tebd.PurificationTEBD.run_GS" title="Permalink to this definition">¶</a></dt>
<dd><p>TEBD algorithm in imaginary time to find the ground state.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">It is almost always more efficient (and hence advisable) to use DMRG.
This algorithms can nonetheless be used quite well as a benchmark and for comparison.</p>
</div>
<p>The following (optional) parameters are read out from the <code class="xref py py-attr docutils literal notranslate"><span class="pre">TEBD_params</span></code>.
Use <code class="docutils literal notranslate"><span class="pre">verbose=1</span></code> to print the used parameters during runtime.</p>
<table border="1" class="docutils">
<colgroup>
<col width="22%" />
<col width="9%" />
<col width="69%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">key</th>
<th class="head">type</th>
<th class="head">description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>delta_tau_list</td>
<td>list</td>
<td>A list of floats: the timesteps to be used.
Choosing a large timestep <cite>delta_tau</cite>
introduces large (Trotter) erros, but a too
small time step requires a lot of steps to
reach  <code class="docutils literal notranslate"><span class="pre">exp(-tau</span> <span class="pre">H)</span> <span class="pre">--&gt;</span> <span class="pre">|psi0&gt;&lt;psi0|</span></code>.
Therefore, we start with fairly large time
steps for a quick time evolution until
convergence, and the gradually decrease the
time step.</td>
</tr>
<tr class="row-odd"><td>order</td>
<td>int</td>
<td>Order of the Suzuki-Trotter decomposition.</td>
</tr>
<tr class="row-even"><td>N_steps</td>
<td>int</td>
<td>Number of steps before measurement can be
performed</td>
</tr>
<tr class="row-odd"><td>trunc_params</td>
<td>dict</td>
<td>Truncation parameters as described in
<a class="reference internal" href="tenpy.algorithms.truncation.html#tenpy.algorithms.truncation.truncate" title="tenpy.algorithms.truncation.truncate"><code class="xref py py-func docutils literal notranslate"><span class="pre">truncate()</span></code></a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="tenpy.algorithms.purification_tebd.PurificationTEBD.run_imaginary">
<code class="descname">run_imaginary</code><span class="sig-paren">(</span><em>beta</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tenpy/algorithms/purification_tebd.html#PurificationTEBD.run_imaginary"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tenpy.algorithms.purification_tebd.PurificationTEBD.run_imaginary" title="Permalink to this definition">¶</a></dt>
<dd><p>Run imaginary time evolution to cool down to the given <cite>beta</cite>.</p>
<p>Note that we don’t change the <cite>norm</cite> attribute of the MPS, i.e. normalization is preserved.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>beta</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">The inverse temperature <cite>beta</cite> = 1/T, by which we should cool down.
We evolve to the closest multiple of <code class="docutils literal notranslate"><span class="pre">TEBD_params['dt']</span></code>,
see also <code class="xref py py-attr docutils literal notranslate"><span class="pre">evolved_time</span></code>.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="staticmethod">
<dt id="tenpy.algorithms.purification_tebd.PurificationTEBD.suzuki_trotter_decomposition">
<em class="property">static </em><code class="descname">suzuki_trotter_decomposition</code><span class="sig-paren">(</span><em>order</em>, <em>N_steps</em><span class="sig-paren">)</span><a class="headerlink" href="#tenpy.algorithms.purification_tebd.PurificationTEBD.suzuki_trotter_decomposition" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns list of necessary steps for the suzuki trotter decomposition.</p>
<p>We split the Hamiltonian as <span class="math notranslate nohighlight">\(H = H_{even} + H_{odd} = H[0] + H[1]\)</span>.
The Suzuki-Trotter decomposition is an approximation
<span class="math notranslate nohighlight">\(\exp(t H) \approx prod_{(j, k) \in ST} \exp(d[j] t H[k]) + O(t^{order+1 })\)</span>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>order</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int</span></dt>
<dd><p class="first last">The desired order of the Suzuki-Trotter decomposition.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>ST_decomposition</strong> <span class="classifier-delimiter">:</span> <span class="classifier">list of (int, int)</span></dt>
<dd><p class="first last">Indices <code class="docutils literal notranslate"><span class="pre">j,</span> <span class="pre">k</span></code> of the time-steps <code class="docutils literal notranslate"><span class="pre">d</span> <span class="pre">=</span> <span class="pre">suzuki_trotter_time_step(order)</span></code> and
the decomposition of <cite>H</cite>.
They are chosen such that a subsequent application of <code class="docutils literal notranslate"><span class="pre">exp(d[j]</span> <span class="pre">t</span> <span class="pre">H[k])</span></code> to a given
state <code class="docutils literal notranslate"><span class="pre">|psi&gt;</span></code> yields <code class="docutils literal notranslate"><span class="pre">(exp(N_steps</span> <span class="pre">t</span> <span class="pre">H[k])</span> <span class="pre">+</span> <span class="pre">O(N_steps</span> <span class="pre">t^{order+1}))|psi&gt;</span></code>.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="staticmethod">
<dt id="tenpy.algorithms.purification_tebd.PurificationTEBD.suzuki_trotter_time_steps">
<em class="property">static </em><code class="descname">suzuki_trotter_time_steps</code><span class="sig-paren">(</span><em>order</em><span class="sig-paren">)</span><a class="headerlink" href="#tenpy.algorithms.purification_tebd.PurificationTEBD.suzuki_trotter_time_steps" title="Permalink to this definition">¶</a></dt>
<dd><p>Return time steps of U for the Suzuki Trotter decomposition of desired order.</p>
<p>See <a class="reference internal" href="#tenpy.algorithms.purification_tebd.PurificationTEBD.suzuki_trotter_decomposition" title="tenpy.algorithms.purification_tebd.PurificationTEBD.suzuki_trotter_decomposition"><code class="xref py py-meth docutils literal notranslate"><span class="pre">suzuki_trotter_decomposition()</span></code></a> for details.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>order</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int</span></dt>
<dd><p class="first last">The desired order of the Suzuki-Trotter decomposition.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>time_steps</strong> <span class="classifier-delimiter">:</span> <span class="classifier">list of float</span></dt>
<dd><p class="first last">We need <code class="docutils literal notranslate"><span class="pre">U</span> <span class="pre">=</span> <span class="pre">exp(-i</span> <span class="pre">H_{even/odd}</span> <span class="pre">delta_t</span> <span class="pre">*</span> <span class="pre">dt)</span></code> for the <cite>dt</cite> returned in this list.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="tenpy.algorithms.purification_tebd.PurificationTEBD.trunc_err_bonds">
<code class="descname">trunc_err_bonds</code><a class="headerlink" href="#tenpy.algorithms.purification_tebd.PurificationTEBD.trunc_err_bonds" title="Permalink to this definition">¶</a></dt>
<dd><p>truncation error introduced on each non-trivial bond</p>
</dd></dl>

<dl class="method">
<dt id="tenpy.algorithms.purification_tebd.PurificationTEBD.update">
<code class="descname">update</code><span class="sig-paren">(</span><em>N_steps</em><span class="sig-paren">)</span><a class="headerlink" href="#tenpy.algorithms.purification_tebd.PurificationTEBD.update" title="Permalink to this definition">¶</a></dt>
<dd><p>Evolve by <code class="docutils literal notranslate"><span class="pre">N_steps</span> <span class="pre">*</span> <span class="pre">U_param['dt']</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>N_steps</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int</span></dt>
<dd><p class="first last">The number of steps for which the whole lattice should be updated.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>trunc_err</strong> <span class="classifier-delimiter">:</span> <span class="classifier"><a class="reference internal" href="tenpy.algorithms.truncation.html#tenpy.algorithms.truncation.TruncationError" title="tenpy.algorithms.truncation.TruncationError"><code class="xref py py-class docutils literal notranslate"><span class="pre">TruncationError</span></code></a></span></dt>
<dd><p class="first last">The error of the represented state which is introduced due to the truncation during
this sequence of update steps.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="tenpy.algorithms.purification_tebd.PurificationTEBD.update_bond">
<code class="descname">update_bond</code><span class="sig-paren">(</span><em>i</em>, <em>U_bond</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tenpy/algorithms/purification_tebd.html#PurificationTEBD.update_bond"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tenpy.algorithms.purification_tebd.PurificationTEBD.update_bond" title="Permalink to this definition">¶</a></dt>
<dd><p>Updates the B matrices on a given bond.</p>
<p>Function that updates the B matrices, the bond matrix s between and the
bond dimension chi for bond i. This would look something like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">|</span>           <span class="o">|</span>             <span class="o">|</span>
<span class="o">|</span>     <span class="o">...</span> <span class="o">-</span> <span class="n">B1</span>  <span class="o">-</span>  <span class="n">s</span>  <span class="o">-</span>  <span class="n">B2</span> <span class="o">-</span> <span class="o">...</span>
<span class="o">|</span>           <span class="o">|</span>             <span class="o">|</span>
<span class="o">|</span>           <span class="o">|-------------|</span>
<span class="o">|</span>           <span class="o">|</span>      <span class="n">U</span>      <span class="o">|</span>
<span class="o">|</span>           <span class="o">|-------------|</span>
<span class="o">|</span>           <span class="o">|</span>             <span class="o">|</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>i</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int</span></dt>
<dd><p class="first last">Bond index; we update the matrices at sites <code class="docutils literal notranslate"><span class="pre">i-1,</span> <span class="pre">i</span></code>.</p>
</dd>
<dt><strong>U_bond</strong> <span class="classifier-delimiter">:</span> <span class="classifier"><a class="reference internal" href="tenpy.linalg.np_conserved.html#tenpy.linalg.np_conserved.Array" title="tenpy.linalg.np_conserved.Array"><code class="xref py py-class docutils literal notranslate"><span class="pre">Array</span></code></a></span></dt>
<dd><p class="first last">The bond operator which we apply to the wave function.
We expect labels <code class="docutils literal notranslate"><span class="pre">'p0',</span> <span class="pre">'p1',</span> <span class="pre">'p0*',</span> <span class="pre">'p1*'</span></code> for <cite>U_bond</cite>.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>trunc_err</strong> <span class="classifier-delimiter">:</span> <span class="classifier"><a class="reference internal" href="tenpy.algorithms.truncation.html#tenpy.algorithms.truncation.TruncationError" title="tenpy.algorithms.truncation.TruncationError"><code class="xref py py-class docutils literal notranslate"><span class="pre">TruncationError</span></code></a></span></dt>
<dd><p class="first last">The error of the represented state which is introduced by the truncation
during this update step.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="tenpy.algorithms.purification_tebd.PurificationTEBD.update_bond_imag">
<code class="descname">update_bond_imag</code><span class="sig-paren">(</span><em>i</em>, <em>U_bond</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tenpy/algorithms/purification_tebd.html#PurificationTEBD.update_bond_imag"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tenpy.algorithms.purification_tebd.PurificationTEBD.update_bond_imag" title="Permalink to this definition">¶</a></dt>
<dd><p>Update a bond with a (possibly non-unitary) <cite>U_bond</cite>.</p>
<p>Similar as <a class="reference internal" href="#tenpy.algorithms.purification_tebd.PurificationTEBD.update_bond" title="tenpy.algorithms.purification_tebd.PurificationTEBD.update_bond"><code class="xref py py-meth docutils literal notranslate"><span class="pre">update_bond()</span></code></a>; but after the SVD just keep the <cite>A, S, B</cite> canonical form.
In that way, one can sweep left or right without using old singular values,
thus preserving the canonical form during imaginary time evolution.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>i</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int</span></dt>
<dd><p class="first last">Bond index; we update the matrices at sites <code class="docutils literal notranslate"><span class="pre">i-1,</span> <span class="pre">i</span></code>.</p>
</dd>
<dt><strong>U_bond</strong> <span class="classifier-delimiter">:</span> <span class="classifier"><a class="reference internal" href="tenpy.linalg.np_conserved.html#tenpy.linalg.np_conserved.Array" title="tenpy.linalg.np_conserved.Array"><code class="xref py py-class docutils literal notranslate"><span class="pre">Array</span></code></a></span></dt>
<dd><p class="first last">The bond operator which we apply to the wave function.
We expect labels <code class="docutils literal notranslate"><span class="pre">'p0',</span> <span class="pre">'p1',</span> <span class="pre">'p0*',</span> <span class="pre">'p1*'</span></code>.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>trunc_err</strong> <span class="classifier-delimiter">:</span> <span class="classifier"><a class="reference internal" href="tenpy.algorithms.truncation.html#tenpy.algorithms.truncation.TruncationError" title="tenpy.algorithms.truncation.TruncationError"><code class="xref py py-class docutils literal notranslate"><span class="pre">TruncationError</span></code></a></span></dt>
<dd><p class="first last">The error of the represented state which is introduced by the truncation
during this update step.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="tenpy.algorithms.purification_tebd.PurificationTEBD.update_imag">
<code class="descname">update_imag</code><span class="sig-paren">(</span><em>N_steps</em><span class="sig-paren">)</span><a class="headerlink" href="#tenpy.algorithms.purification_tebd.PurificationTEBD.update_imag" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform an update suitable for imaginary time evolution.</p>
<p>Instead of the even/odd brick structure used for ordinary TEBD,
we ‘sweep’ from left to right and right to left, similar as DMRG.
Thanks to that, we are actually able to preserve the canonical form.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>N_steps</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int</span></dt>
<dd><p class="first last">The number of steps for which the whole lattice should be updated.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>trunc_err</strong> <span class="classifier-delimiter">:</span> <span class="classifier"><a class="reference internal" href="tenpy.algorithms.truncation.html#tenpy.algorithms.truncation.TruncationError" title="tenpy.algorithms.truncation.TruncationError"><code class="xref py py-class docutils literal notranslate"><span class="pre">TruncationError</span></code></a></span></dt>
<dd><p class="first last">The error of the represented state which is introduced due to the truncation during
this sequence of update steps.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="tenpy.algorithms.purification_tebd.PurificationTEBD.update_step">
<code class="descname">update_step</code><span class="sig-paren">(</span><em>U_idx_dt</em>, <em>odd</em><span class="sig-paren">)</span><a class="headerlink" href="#tenpy.algorithms.purification_tebd.PurificationTEBD.update_step" title="Permalink to this definition">¶</a></dt>
<dd><p>Updates either even <em>or</em> odd bonds in unit cell.</p>
<p>Depending on the choice of p, this function updates all even (<code class="docutils literal notranslate"><span class="pre">E</span></code>, odd=False,0)
<strong>or</strong> odd (<code class="docutils literal notranslate"><span class="pre">O</span></code>) (odd=True,1) bonds:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">|</span>     <span class="o">-</span> <span class="n">B0</span> <span class="o">-</span> <span class="n">B1</span> <span class="o">-</span> <span class="n">B2</span> <span class="o">-</span> <span class="n">B3</span> <span class="o">-</span> <span class="n">B4</span> <span class="o">-</span> <span class="n">B5</span> <span class="o">-</span> <span class="n">B6</span> <span class="o">-</span>
<span class="o">|</span>       <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>
<span class="o">|</span>       <span class="o">|</span>    <span class="o">|----|</span>    <span class="o">|----|</span>    <span class="o">|----|</span>
<span class="o">|</span>       <span class="o">|</span>    <span class="o">|</span>  <span class="n">E</span> <span class="o">|</span>    <span class="o">|</span>  <span class="n">E</span> <span class="o">|</span>    <span class="o">|</span>  <span class="n">E</span> <span class="o">|</span>
<span class="o">|</span>       <span class="o">|</span>    <span class="o">|----|</span>    <span class="o">|----|</span>    <span class="o">|----|</span>
<span class="o">|</span>       <span class="o">|----|</span>    <span class="o">|----|</span>    <span class="o">|----|</span>    <span class="o">|</span>
<span class="o">|</span>       <span class="o">|</span>  <span class="n">O</span> <span class="o">|</span>    <span class="o">|</span>  <span class="n">O</span> <span class="o">|</span>    <span class="o">|</span>  <span class="n">O</span> <span class="o">|</span>    <span class="o">|</span>
<span class="o">|</span>       <span class="o">|----|</span>    <span class="o">|----|</span>    <span class="o">|----|</span>    <span class="o">|</span>
</pre></div>
</div>
<p>Note that finite boundary conditions are taken care of by having <code class="docutils literal notranslate"><span class="pre">Us[0]</span> <span class="pre">=</span> <span class="pre">None</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>U_idx_dt</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int</span></dt>
<dd><p class="first last">Time step index in <code class="docutils literal notranslate"><span class="pre">self._U</span></code>,
evolve with <code class="docutils literal notranslate"><span class="pre">Us[i]</span> <span class="pre">=</span> <span class="pre">self.U[U_idx_dt][i]</span></code> at bond <code class="docutils literal notranslate"><span class="pre">(i-1,i)</span></code>.</p>
</dd>
<dt><strong>odd</strong> <span class="classifier-delimiter">:</span> <span class="classifier">bool/int</span></dt>
<dd><p class="first last">Indication of whether to update even (<code class="docutils literal notranslate"><span class="pre">odd=False,0</span></code>) or even (<code class="docutils literal notranslate"><span class="pre">odd=True,1</span></code>) sites</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>trunc_err</strong> <span class="classifier-delimiter">:</span> <span class="classifier"><a class="reference internal" href="tenpy.algorithms.truncation.html#tenpy.algorithms.truncation.TruncationError" title="tenpy.algorithms.truncation.TruncationError"><code class="xref py py-class docutils literal notranslate"><span class="pre">TruncationError</span></code></a></span></dt>
<dd><p class="first last">The error of the represented state which is introduced due to the truncation
during this sequence of update steps.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="tenpy.algorithms.purification_tebd.PurificationTEBD2">
<em class="property">class </em><code class="descclassname">tenpy.algorithms.purification_tebd.</code><code class="descname">PurificationTEBD2</code><span class="sig-paren">(</span><em>psi</em>, <em>model</em>, <em>TEBD_params</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tenpy/algorithms/purification_tebd.html#PurificationTEBD2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tenpy.algorithms.purification_tebd.PurificationTEBD2" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#tenpy.algorithms.purification_tebd.PurificationTEBD" title="tenpy.algorithms.purification_tebd.PurificationTEBD"><code class="xref py py-class docutils literal notranslate"><span class="pre">tenpy.algorithms.purification_tebd.PurificationTEBD</span></code></a></p>
<p>Similar as PurificationTEBD, but perform sweeps instead of brickwall.</p>
<p>Instead of the A-B pattern of even/odd bonds used in TEBD, perform sweeps similar as in DMRG
for real-time evolution (similar as <a class="reference internal" href="tenpy.algorithms.tebd.html#tenpy.algorithms.tebd.Engine.update_imag" title="tenpy.algorithms.tebd.Engine.update_imag"><code class="xref py py-meth docutils literal notranslate"><span class="pre">update_imag()</span></code></a>
does for imaginary time evolution).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Attributes:</th><td class="field-body"><dl class="first last docutils">
<dt><a class="reference internal" href="#tenpy.algorithms.purification_tebd.PurificationTEBD2.disent_iterations" title="tenpy.algorithms.purification_tebd.PurificationTEBD2.disent_iterations"><code class="xref py py-obj docutils literal notranslate"><span class="pre">disent_iterations</span></code></a></dt>
<dd><p class="first last">For each bond the total number of iterations performed in any <a class="reference internal" href="#tenpy.algorithms.purification_tebd.Disentangler" title="tenpy.algorithms.purification_tebd.Disentangler"><code class="xref py py-class docutils literal notranslate"><span class="pre">Disentangler</span></code></a>.</p>
</dd>
<dt><a class="reference internal" href="#tenpy.algorithms.purification_tebd.PurificationTEBD2.trunc_err_bonds" title="tenpy.algorithms.purification_tebd.PurificationTEBD2.trunc_err_bonds"><code class="xref py py-obj docutils literal notranslate"><span class="pre">trunc_err_bonds</span></code></a></dt>
<dd><p class="first last">truncation error introduced on each non-trivial bond</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#tenpy.algorithms.purification_tebd.PurificationTEBD2.calc_U" title="tenpy.algorithms.purification_tebd.PurificationTEBD2.calc_U"><code class="xref py py-obj docutils literal notranslate"><span class="pre">calc_U</span></code></a>(order,&nbsp;delta_t[,&nbsp;type_evo,&nbsp;E_offset])</td>
<td>see <code class="xref py py-meth docutils literal notranslate"><span class="pre">calc_U()</span></code></td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#tenpy.algorithms.purification_tebd.PurificationTEBD2.disentangle" title="tenpy.algorithms.purification_tebd.PurificationTEBD2.disentangle"><code class="xref py py-obj docutils literal notranslate"><span class="pre">disentangle</span></code></a>(theta)</td>
<td>Disentangle <cite>theta</cite> before splitting with svd.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#tenpy.algorithms.purification_tebd.PurificationTEBD2.disentangle_global" title="tenpy.algorithms.purification_tebd.PurificationTEBD2.disentangle_global"><code class="xref py py-obj docutils literal notranslate"><span class="pre">disentangle_global</span></code></a>([pair])</td>
<td>Try global disentangling by determining the maximally entangled pairs of sites.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#tenpy.algorithms.purification_tebd.PurificationTEBD2.disentangle_global_nsite" title="tenpy.algorithms.purification_tebd.PurificationTEBD2.disentangle_global_nsite"><code class="xref py py-obj docutils literal notranslate"><span class="pre">disentangle_global_nsite</span></code></a>([n])</td>
<td>Perform a sweep through the system and disentangle with <a class="reference internal" href="#tenpy.algorithms.purification_tebd.PurificationTEBD2.disentangle_n_site" title="tenpy.algorithms.purification_tebd.PurificationTEBD2.disentangle_n_site"><code class="xref py py-meth docutils literal notranslate"><span class="pre">disentangle_n_site()</span></code></a>.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#tenpy.algorithms.purification_tebd.PurificationTEBD2.disentangle_n_site" title="tenpy.algorithms.purification_tebd.PurificationTEBD2.disentangle_n_site"><code class="xref py py-obj docutils literal notranslate"><span class="pre">disentangle_n_site</span></code></a>(i,&nbsp;n,&nbsp;theta)</td>
<td>Generalization of <a class="reference internal" href="#tenpy.algorithms.purification_tebd.PurificationTEBD2.disentangle" title="tenpy.algorithms.purification_tebd.PurificationTEBD2.disentangle"><code class="xref py py-meth docutils literal notranslate"><span class="pre">disentangle()</span></code></a> to <cite>n</cite> sites.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#tenpy.algorithms.purification_tebd.PurificationTEBD2.run" title="tenpy.algorithms.purification_tebd.PurificationTEBD2.run"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code></a>()</td>
<td>(Real-)time evolution with TEBD (time evolving block decimation).</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#tenpy.algorithms.purification_tebd.PurificationTEBD2.run_GS" title="tenpy.algorithms.purification_tebd.PurificationTEBD2.run_GS"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run_GS</span></code></a>()</td>
<td>TEBD algorithm in imaginary time to find the ground state.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#tenpy.algorithms.purification_tebd.PurificationTEBD2.run_imaginary" title="tenpy.algorithms.purification_tebd.PurificationTEBD2.run_imaginary"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run_imaginary</span></code></a>(beta)</td>
<td>Run imaginary time evolution to cool down to the given <cite>beta</cite>.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#tenpy.algorithms.purification_tebd.PurificationTEBD2.suzuki_trotter_decomposition" title="tenpy.algorithms.purification_tebd.PurificationTEBD2.suzuki_trotter_decomposition"><code class="xref py py-obj docutils literal notranslate"><span class="pre">suzuki_trotter_decomposition</span></code></a>(order,&nbsp;N_steps)</td>
<td>Returns list of necessary steps for the suzuki trotter decomposition.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#tenpy.algorithms.purification_tebd.PurificationTEBD2.suzuki_trotter_time_steps" title="tenpy.algorithms.purification_tebd.PurificationTEBD2.suzuki_trotter_time_steps"><code class="xref py py-obj docutils literal notranslate"><span class="pre">suzuki_trotter_time_steps</span></code></a>(order)</td>
<td>Return time steps of U for the Suzuki Trotter decomposition of desired order.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#tenpy.algorithms.purification_tebd.PurificationTEBD2.update" title="tenpy.algorithms.purification_tebd.PurificationTEBD2.update"><code class="xref py py-obj docutils literal notranslate"><span class="pre">update</span></code></a>(N_steps)</td>
<td>Evolve by <code class="docutils literal notranslate"><span class="pre">N_steps</span> <span class="pre">*</span> <span class="pre">U_param['dt']</span></code>.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#tenpy.algorithms.purification_tebd.PurificationTEBD2.update_bond" title="tenpy.algorithms.purification_tebd.PurificationTEBD2.update_bond"><code class="xref py py-obj docutils literal notranslate"><span class="pre">update_bond</span></code></a>(i,&nbsp;U_bond)</td>
<td>Updates the B matrices on a given bond.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#tenpy.algorithms.purification_tebd.PurificationTEBD2.update_bond_imag" title="tenpy.algorithms.purification_tebd.PurificationTEBD2.update_bond_imag"><code class="xref py py-obj docutils literal notranslate"><span class="pre">update_bond_imag</span></code></a>(i,&nbsp;U_bond)</td>
<td>Update a bond with a (possibly non-unitary) <cite>U_bond</cite>.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#tenpy.algorithms.purification_tebd.PurificationTEBD2.update_imag" title="tenpy.algorithms.purification_tebd.PurificationTEBD2.update_imag"><code class="xref py py-obj docutils literal notranslate"><span class="pre">update_imag</span></code></a>(N_steps)</td>
<td>Perform an update suitable for imaginary time evolution.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#tenpy.algorithms.purification_tebd.PurificationTEBD2.update_step" title="tenpy.algorithms.purification_tebd.PurificationTEBD2.update_step"><code class="xref py py-obj docutils literal notranslate"><span class="pre">update_step</span></code></a>(U_idx_dt,&nbsp;odd)</td>
<td>Updates bonds in unit cell.</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="tenpy.algorithms.purification_tebd.PurificationTEBD2.calc_U">
<code class="descname">calc_U</code><span class="sig-paren">(</span><em>order</em>, <em>delta_t</em>, <em>type_evo='real'</em>, <em>E_offset=None</em><span class="sig-paren">)</span><a class="headerlink" href="#tenpy.algorithms.purification_tebd.PurificationTEBD2.calc_U" title="Permalink to this definition">¶</a></dt>
<dd><p>see <code class="xref py py-meth docutils literal notranslate"><span class="pre">calc_U()</span></code></p>
</dd></dl>

<dl class="attribute">
<dt id="tenpy.algorithms.purification_tebd.PurificationTEBD2.disent_iterations">
<code class="descname">disent_iterations</code><a class="headerlink" href="#tenpy.algorithms.purification_tebd.PurificationTEBD2.disent_iterations" title="Permalink to this definition">¶</a></dt>
<dd><p>For each bond the total number of iterations performed in any <a class="reference internal" href="#tenpy.algorithms.purification_tebd.Disentangler" title="tenpy.algorithms.purification_tebd.Disentangler"><code class="xref py py-class docutils literal notranslate"><span class="pre">Disentangler</span></code></a>.</p>
</dd></dl>

<dl class="method">
<dt id="tenpy.algorithms.purification_tebd.PurificationTEBD2.disentangle">
<code class="descname">disentangle</code><span class="sig-paren">(</span><em>theta</em><span class="sig-paren">)</span><a class="headerlink" href="#tenpy.algorithms.purification_tebd.PurificationTEBD2.disentangle" title="Permalink to this definition">¶</a></dt>
<dd><p>Disentangle <cite>theta</cite> before splitting with svd.</p>
<p>For the purification we write <span class="math notranslate nohighlight">\(\rho_P = Tr_Q{|\psi_{P,Q}&gt;&lt;\psi_{P,Q}|}\)</span>. Thus, we
can actually apply any unitary to the auxiliar <cite>Q</cite> space of <span class="math notranslate nohighlight">\(|\psi&gt;\)</span> without
changing the result.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">We have to apply the <em>same</em> unitary to the ‘bra’ and ‘ket’ used for expectation values
/ correlation functions!</p>
</div>
<p>The behaviour of this function is set by <code class="xref py py-attr docutils literal notranslate"><span class="pre">used_disentangler</span></code>,
which in turn is obtained from <code class="docutils literal notranslate"><span class="pre">get_disentangler(TEBD_params['disentangle'])</span></code>,
see <a class="reference internal" href="#tenpy.algorithms.purification_tebd.get_disentangler" title="tenpy.algorithms.purification_tebd.get_disentangler"><code class="xref py py-func docutils literal notranslate"><span class="pre">get_disentangler()</span></code></a> for details on the syntax.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>theta</strong> <span class="classifier-delimiter">:</span> <span class="classifier"><a class="reference internal" href="tenpy.linalg.np_conserved.html#tenpy.linalg.np_conserved.Array" title="tenpy.linalg.np_conserved.Array"><code class="xref py py-class docutils literal notranslate"><span class="pre">Array</span></code></a></span></dt>
<dd><p class="first last">Wave function to disentangle, with legs <code class="docutils literal notranslate"><span class="pre">'vL',</span> <span class="pre">'vR',</span> <span class="pre">'p0',</span> <span class="pre">'p1',</span> <span class="pre">'q0',</span> <span class="pre">'q1'</span></code>.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>theta_disentangled</strong> <span class="classifier-delimiter">:</span> <span class="classifier"><a class="reference internal" href="tenpy.linalg.np_conserved.html#tenpy.linalg.np_conserved.Array" title="tenpy.linalg.np_conserved.Array"><code class="xref py py-class docutils literal notranslate"><span class="pre">Array</span></code></a></span></dt>
<dd><p class="first last">Disentangled <cite>theta</cite>; <code class="docutils literal notranslate"><span class="pre">npc.tensordot(U,</span> <span class="pre">theta,</span> <span class="pre">axes=[['q0*',</span> <span class="pre">'q1*'],</span> <span class="pre">['q0',</span> <span class="pre">'q1']])</span></code>.</p>
</dd>
<dt><strong>U</strong> <span class="classifier-delimiter">:</span> <span class="classifier"><code class="xref py py-class docutils literal notranslate"><span class="pre">Array</span></code></span></dt>
<dd><p class="first last">The unitary used to disentangle <cite>theta</cite>, with labels <code class="docutils literal notranslate"><span class="pre">'q0',</span> <span class="pre">'q1',</span> <span class="pre">'q0*',</span> <span class="pre">'q1*'</span></code>.
If no unitary was found/applied, it might also be <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="tenpy.algorithms.purification_tebd.PurificationTEBD2.disentangle_global">
<code class="descname">disentangle_global</code><span class="sig-paren">(</span><em>pair=None</em><span class="sig-paren">)</span><a class="headerlink" href="#tenpy.algorithms.purification_tebd.PurificationTEBD2.disentangle_global" title="Permalink to this definition">¶</a></dt>
<dd><p>Try global disentangling by determining the maximally entangled pairs of sites.</p>
<p>Caclulate the mutual information (in the auxiliar space) between two sites
and determine where it is maximal. Disentangle these two sites with <a class="reference internal" href="#tenpy.algorithms.purification_tebd.PurificationTEBD2.disentangle" title="tenpy.algorithms.purification_tebd.PurificationTEBD2.disentangle"><code class="xref py py-meth docutils literal notranslate"><span class="pre">disentangle()</span></code></a></p>
</dd></dl>

<dl class="method">
<dt id="tenpy.algorithms.purification_tebd.PurificationTEBD2.disentangle_global_nsite">
<code class="descname">disentangle_global_nsite</code><span class="sig-paren">(</span><em>n=2</em><span class="sig-paren">)</span><a class="headerlink" href="#tenpy.algorithms.purification_tebd.PurificationTEBD2.disentangle_global_nsite" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform a sweep through the system and disentangle with <a class="reference internal" href="#tenpy.algorithms.purification_tebd.PurificationTEBD2.disentangle_n_site" title="tenpy.algorithms.purification_tebd.PurificationTEBD2.disentangle_n_site"><code class="xref py py-meth docutils literal notranslate"><span class="pre">disentangle_n_site()</span></code></a>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>n: int</strong></dt>
<dd><p class="first last">maximal number of sites to disentangle at once.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="tenpy.algorithms.purification_tebd.PurificationTEBD2.disentangle_n_site">
<code class="descname">disentangle_n_site</code><span class="sig-paren">(</span><em>i</em>, <em>n</em>, <em>theta</em><span class="sig-paren">)</span><a class="headerlink" href="#tenpy.algorithms.purification_tebd.PurificationTEBD2.disentangle_n_site" title="Permalink to this definition">¶</a></dt>
<dd><p>Generalization of <a class="reference internal" href="#tenpy.algorithms.purification_tebd.PurificationTEBD2.disentangle" title="tenpy.algorithms.purification_tebd.PurificationTEBD2.disentangle"><code class="xref py py-meth docutils literal notranslate"><span class="pre">disentangle()</span></code></a> to <cite>n</cite> sites.</p>
<p>Simply group left and right <cite>n</cite>/2 physical legs, adjust labels, and
apply <a class="reference internal" href="#tenpy.algorithms.purification_tebd.PurificationTEBD2.disentangle" title="tenpy.algorithms.purification_tebd.PurificationTEBD2.disentangle"><code class="xref py py-meth docutils literal notranslate"><span class="pre">disentangle()</span></code></a> to disentangle the central bond.
Recursively proceed to disentangle left and right parts afterwards.
Scales (for even <cite>n</cite>) as <span class="math notranslate nohighlight">\(O(\chi^3 d^n d^{n/2})\)</span>.</p>
</dd></dl>

<dl class="method">
<dt id="tenpy.algorithms.purification_tebd.PurificationTEBD2.run">
<code class="descname">run</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#tenpy.algorithms.purification_tebd.PurificationTEBD2.run" title="Permalink to this definition">¶</a></dt>
<dd><p>(Real-)time evolution with TEBD (time evolving block decimation).</p>
<p>The following (optional) parameters are read out from the <code class="xref py py-attr docutils literal notranslate"><span class="pre">TEBD_params</span></code>.</p>
<table border="1" class="docutils">
<colgroup>
<col width="19%" />
<col width="8%" />
<col width="73%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">key</th>
<th class="head">type</th>
<th class="head">description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>dt</td>
<td>float</td>
<td>Time step.</td>
</tr>
<tr class="row-odd"><td>order</td>
<td>int</td>
<td><dl class="first last docutils">
<dt>Order of the algorithm.</dt>
<dd>The total error scales as O(t, dt^order).</dd>
</dl>
</td>
</tr>
<tr class="row-even"><td>N_steps</td>
<td>int</td>
<td>Number of time steps <cite>dt</cite> to evolve.
(The Trotter decompositions of order &gt; 1 are slightly
more efficient if more than one step is performed at
once.)</td>
</tr>
<tr class="row-odd"><td>trunc_params</td>
<td>dict</td>
<td>Truncation parameters as described in
<a class="reference internal" href="tenpy.algorithms.truncation.html#tenpy.algorithms.truncation.truncate" title="tenpy.algorithms.truncation.truncate"><code class="xref py py-func docutils literal notranslate"><span class="pre">truncate()</span></code></a>.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="tenpy.algorithms.purification_tebd.PurificationTEBD2.run_GS">
<code class="descname">run_GS</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#tenpy.algorithms.purification_tebd.PurificationTEBD2.run_GS" title="Permalink to this definition">¶</a></dt>
<dd><p>TEBD algorithm in imaginary time to find the ground state.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">It is almost always more efficient (and hence advisable) to use DMRG.
This algorithms can nonetheless be used quite well as a benchmark and for comparison.</p>
</div>
<p>The following (optional) parameters are read out from the <code class="xref py py-attr docutils literal notranslate"><span class="pre">TEBD_params</span></code>.
Use <code class="docutils literal notranslate"><span class="pre">verbose=1</span></code> to print the used parameters during runtime.</p>
<table border="1" class="docutils">
<colgroup>
<col width="22%" />
<col width="9%" />
<col width="69%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">key</th>
<th class="head">type</th>
<th class="head">description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>delta_tau_list</td>
<td>list</td>
<td>A list of floats: the timesteps to be used.
Choosing a large timestep <cite>delta_tau</cite>
introduces large (Trotter) erros, but a too
small time step requires a lot of steps to
reach  <code class="docutils literal notranslate"><span class="pre">exp(-tau</span> <span class="pre">H)</span> <span class="pre">--&gt;</span> <span class="pre">|psi0&gt;&lt;psi0|</span></code>.
Therefore, we start with fairly large time
steps for a quick time evolution until
convergence, and the gradually decrease the
time step.</td>
</tr>
<tr class="row-odd"><td>order</td>
<td>int</td>
<td>Order of the Suzuki-Trotter decomposition.</td>
</tr>
<tr class="row-even"><td>N_steps</td>
<td>int</td>
<td>Number of steps before measurement can be
performed</td>
</tr>
<tr class="row-odd"><td>trunc_params</td>
<td>dict</td>
<td>Truncation parameters as described in
<a class="reference internal" href="tenpy.algorithms.truncation.html#tenpy.algorithms.truncation.truncate" title="tenpy.algorithms.truncation.truncate"><code class="xref py py-func docutils literal notranslate"><span class="pre">truncate()</span></code></a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="tenpy.algorithms.purification_tebd.PurificationTEBD2.run_imaginary">
<code class="descname">run_imaginary</code><span class="sig-paren">(</span><em>beta</em><span class="sig-paren">)</span><a class="headerlink" href="#tenpy.algorithms.purification_tebd.PurificationTEBD2.run_imaginary" title="Permalink to this definition">¶</a></dt>
<dd><p>Run imaginary time evolution to cool down to the given <cite>beta</cite>.</p>
<p>Note that we don’t change the <cite>norm</cite> attribute of the MPS, i.e. normalization is preserved.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>beta</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">The inverse temperature <cite>beta</cite> = 1/T, by which we should cool down.
We evolve to the closest multiple of <code class="docutils literal notranslate"><span class="pre">TEBD_params['dt']</span></code>,
see also <code class="xref py py-attr docutils literal notranslate"><span class="pre">evolved_time</span></code>.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="staticmethod">
<dt id="tenpy.algorithms.purification_tebd.PurificationTEBD2.suzuki_trotter_decomposition">
<em class="property">static </em><code class="descname">suzuki_trotter_decomposition</code><span class="sig-paren">(</span><em>order</em>, <em>N_steps</em><span class="sig-paren">)</span><a class="headerlink" href="#tenpy.algorithms.purification_tebd.PurificationTEBD2.suzuki_trotter_decomposition" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns list of necessary steps for the suzuki trotter decomposition.</p>
<p>We split the Hamiltonian as <span class="math notranslate nohighlight">\(H = H_{even} + H_{odd} = H[0] + H[1]\)</span>.
The Suzuki-Trotter decomposition is an approximation
<span class="math notranslate nohighlight">\(\exp(t H) \approx prod_{(j, k) \in ST} \exp(d[j] t H[k]) + O(t^{order+1 })\)</span>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>order</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int</span></dt>
<dd><p class="first last">The desired order of the Suzuki-Trotter decomposition.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>ST_decomposition</strong> <span class="classifier-delimiter">:</span> <span class="classifier">list of (int, int)</span></dt>
<dd><p class="first last">Indices <code class="docutils literal notranslate"><span class="pre">j,</span> <span class="pre">k</span></code> of the time-steps <code class="docutils literal notranslate"><span class="pre">d</span> <span class="pre">=</span> <span class="pre">suzuki_trotter_time_step(order)</span></code> and
the decomposition of <cite>H</cite>.
They are chosen such that a subsequent application of <code class="docutils literal notranslate"><span class="pre">exp(d[j]</span> <span class="pre">t</span> <span class="pre">H[k])</span></code> to a given
state <code class="docutils literal notranslate"><span class="pre">|psi&gt;</span></code> yields <code class="docutils literal notranslate"><span class="pre">(exp(N_steps</span> <span class="pre">t</span> <span class="pre">H[k])</span> <span class="pre">+</span> <span class="pre">O(N_steps</span> <span class="pre">t^{order+1}))|psi&gt;</span></code>.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="staticmethod">
<dt id="tenpy.algorithms.purification_tebd.PurificationTEBD2.suzuki_trotter_time_steps">
<em class="property">static </em><code class="descname">suzuki_trotter_time_steps</code><span class="sig-paren">(</span><em>order</em><span class="sig-paren">)</span><a class="headerlink" href="#tenpy.algorithms.purification_tebd.PurificationTEBD2.suzuki_trotter_time_steps" title="Permalink to this definition">¶</a></dt>
<dd><p>Return time steps of U for the Suzuki Trotter decomposition of desired order.</p>
<p>See <a class="reference internal" href="#tenpy.algorithms.purification_tebd.PurificationTEBD2.suzuki_trotter_decomposition" title="tenpy.algorithms.purification_tebd.PurificationTEBD2.suzuki_trotter_decomposition"><code class="xref py py-meth docutils literal notranslate"><span class="pre">suzuki_trotter_decomposition()</span></code></a> for details.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>order</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int</span></dt>
<dd><p class="first last">The desired order of the Suzuki-Trotter decomposition.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>time_steps</strong> <span class="classifier-delimiter">:</span> <span class="classifier">list of float</span></dt>
<dd><p class="first last">We need <code class="docutils literal notranslate"><span class="pre">U</span> <span class="pre">=</span> <span class="pre">exp(-i</span> <span class="pre">H_{even/odd}</span> <span class="pre">delta_t</span> <span class="pre">*</span> <span class="pre">dt)</span></code> for the <cite>dt</cite> returned in this list.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="tenpy.algorithms.purification_tebd.PurificationTEBD2.trunc_err_bonds">
<code class="descname">trunc_err_bonds</code><a class="headerlink" href="#tenpy.algorithms.purification_tebd.PurificationTEBD2.trunc_err_bonds" title="Permalink to this definition">¶</a></dt>
<dd><p>truncation error introduced on each non-trivial bond</p>
</dd></dl>

<dl class="method">
<dt id="tenpy.algorithms.purification_tebd.PurificationTEBD2.update">
<code class="descname">update</code><span class="sig-paren">(</span><em>N_steps</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tenpy/algorithms/purification_tebd.html#PurificationTEBD2.update"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tenpy.algorithms.purification_tebd.PurificationTEBD2.update" title="Permalink to this definition">¶</a></dt>
<dd><p>Evolve by <code class="docutils literal notranslate"><span class="pre">N_steps</span> <span class="pre">*</span> <span class="pre">U_param['dt']</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>N_steps</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int</span></dt>
<dd><p class="first last">The number of steps for which the whole lattice should be updated.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>trunc_err</strong> <span class="classifier-delimiter">:</span> <span class="classifier"><a class="reference internal" href="tenpy.algorithms.truncation.html#tenpy.algorithms.truncation.TruncationError" title="tenpy.algorithms.truncation.TruncationError"><code class="xref py py-class docutils literal notranslate"><span class="pre">TruncationError</span></code></a></span></dt>
<dd><p class="first last">The error of the represented state which is introduced due to the truncation during
this sequence of update steps.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="tenpy.algorithms.purification_tebd.PurificationTEBD2.update_bond">
<code class="descname">update_bond</code><span class="sig-paren">(</span><em>i</em>, <em>U_bond</em><span class="sig-paren">)</span><a class="headerlink" href="#tenpy.algorithms.purification_tebd.PurificationTEBD2.update_bond" title="Permalink to this definition">¶</a></dt>
<dd><p>Updates the B matrices on a given bond.</p>
<p>Function that updates the B matrices, the bond matrix s between and the
bond dimension chi for bond i. This would look something like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">|</span>           <span class="o">|</span>             <span class="o">|</span>
<span class="o">|</span>     <span class="o">...</span> <span class="o">-</span> <span class="n">B1</span>  <span class="o">-</span>  <span class="n">s</span>  <span class="o">-</span>  <span class="n">B2</span> <span class="o">-</span> <span class="o">...</span>
<span class="o">|</span>           <span class="o">|</span>             <span class="o">|</span>
<span class="o">|</span>           <span class="o">|-------------|</span>
<span class="o">|</span>           <span class="o">|</span>      <span class="n">U</span>      <span class="o">|</span>
<span class="o">|</span>           <span class="o">|-------------|</span>
<span class="o">|</span>           <span class="o">|</span>             <span class="o">|</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>i</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int</span></dt>
<dd><p class="first last">Bond index; we update the matrices at sites <code class="docutils literal notranslate"><span class="pre">i-1,</span> <span class="pre">i</span></code>.</p>
</dd>
<dt><strong>U_bond</strong> <span class="classifier-delimiter">:</span> <span class="classifier"><a class="reference internal" href="tenpy.linalg.np_conserved.html#tenpy.linalg.np_conserved.Array" title="tenpy.linalg.np_conserved.Array"><code class="xref py py-class docutils literal notranslate"><span class="pre">Array</span></code></a></span></dt>
<dd><p class="first last">The bond operator which we apply to the wave function.
We expect labels <code class="docutils literal notranslate"><span class="pre">'p0',</span> <span class="pre">'p1',</span> <span class="pre">'p0*',</span> <span class="pre">'p1*'</span></code> for <cite>U_bond</cite>.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>trunc_err</strong> <span class="classifier-delimiter">:</span> <span class="classifier"><a class="reference internal" href="tenpy.algorithms.truncation.html#tenpy.algorithms.truncation.TruncationError" title="tenpy.algorithms.truncation.TruncationError"><code class="xref py py-class docutils literal notranslate"><span class="pre">TruncationError</span></code></a></span></dt>
<dd><p class="first last">The error of the represented state which is introduced by the truncation
during this update step.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="tenpy.algorithms.purification_tebd.PurificationTEBD2.update_bond_imag">
<code class="descname">update_bond_imag</code><span class="sig-paren">(</span><em>i</em>, <em>U_bond</em><span class="sig-paren">)</span><a class="headerlink" href="#tenpy.algorithms.purification_tebd.PurificationTEBD2.update_bond_imag" title="Permalink to this definition">¶</a></dt>
<dd><p>Update a bond with a (possibly non-unitary) <cite>U_bond</cite>.</p>
<p>Similar as <a class="reference internal" href="#tenpy.algorithms.purification_tebd.PurificationTEBD2.update_bond" title="tenpy.algorithms.purification_tebd.PurificationTEBD2.update_bond"><code class="xref py py-meth docutils literal notranslate"><span class="pre">update_bond()</span></code></a>; but after the SVD just keep the <cite>A, S, B</cite> canonical form.
In that way, one can sweep left or right without using old singular values,
thus preserving the canonical form during imaginary time evolution.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>i</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int</span></dt>
<dd><p class="first last">Bond index; we update the matrices at sites <code class="docutils literal notranslate"><span class="pre">i-1,</span> <span class="pre">i</span></code>.</p>
</dd>
<dt><strong>U_bond</strong> <span class="classifier-delimiter">:</span> <span class="classifier"><a class="reference internal" href="tenpy.linalg.np_conserved.html#tenpy.linalg.np_conserved.Array" title="tenpy.linalg.np_conserved.Array"><code class="xref py py-class docutils literal notranslate"><span class="pre">Array</span></code></a></span></dt>
<dd><p class="first last">The bond operator which we apply to the wave function.
We expect labels <code class="docutils literal notranslate"><span class="pre">'p0',</span> <span class="pre">'p1',</span> <span class="pre">'p0*',</span> <span class="pre">'p1*'</span></code>.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>trunc_err</strong> <span class="classifier-delimiter">:</span> <span class="classifier"><a class="reference internal" href="tenpy.algorithms.truncation.html#tenpy.algorithms.truncation.TruncationError" title="tenpy.algorithms.truncation.TruncationError"><code class="xref py py-class docutils literal notranslate"><span class="pre">TruncationError</span></code></a></span></dt>
<dd><p class="first last">The error of the represented state which is introduced by the truncation
during this update step.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="tenpy.algorithms.purification_tebd.PurificationTEBD2.update_imag">
<code class="descname">update_imag</code><span class="sig-paren">(</span><em>N_steps</em><span class="sig-paren">)</span><a class="headerlink" href="#tenpy.algorithms.purification_tebd.PurificationTEBD2.update_imag" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform an update suitable for imaginary time evolution.</p>
<p>Instead of the even/odd brick structure used for ordinary TEBD,
we ‘sweep’ from left to right and right to left, similar as DMRG.
Thanks to that, we are actually able to preserve the canonical form.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>N_steps</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int</span></dt>
<dd><p class="first last">The number of steps for which the whole lattice should be updated.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>trunc_err</strong> <span class="classifier-delimiter">:</span> <span class="classifier"><a class="reference internal" href="tenpy.algorithms.truncation.html#tenpy.algorithms.truncation.TruncationError" title="tenpy.algorithms.truncation.TruncationError"><code class="xref py py-class docutils literal notranslate"><span class="pre">TruncationError</span></code></a></span></dt>
<dd><p class="first last">The error of the represented state which is introduced due to the truncation during
this sequence of update steps.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="tenpy.algorithms.purification_tebd.PurificationTEBD2.update_step">
<code class="descname">update_step</code><span class="sig-paren">(</span><em>U_idx_dt</em>, <em>odd</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tenpy/algorithms/purification_tebd.html#PurificationTEBD2.update_step"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tenpy.algorithms.purification_tebd.PurificationTEBD2.update_step" title="Permalink to this definition">¶</a></dt>
<dd><p>Updates bonds in unit cell.</p>
<p>Depending on the choice of <cite>odd</cite>, perform a sweep to the left or right,
updating once per site with a time step given by U_idx_dt.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>U_idx_dt</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int</span></dt>
<dd><p class="first last">Time step index in <code class="docutils literal notranslate"><span class="pre">self._U</span></code>,
evolve with <code class="docutils literal notranslate"><span class="pre">Us[i]</span> <span class="pre">=</span> <span class="pre">self.U[U_idx_dt][i]</span></code> at bond <code class="docutils literal notranslate"><span class="pre">(i-1,i)</span></code>.</p>
</dd>
<dt><strong>odd</strong> <span class="classifier-delimiter">:</span> <span class="classifier">bool/int</span></dt>
<dd><p class="first last">Indication of whether to update even (<code class="docutils literal notranslate"><span class="pre">odd=False,0</span></code>) or even (<code class="docutils literal notranslate"><span class="pre">odd=True,1</span></code>) sites</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>trunc_err</strong> <span class="classifier-delimiter">:</span> <span class="classifier"><a class="reference internal" href="tenpy.algorithms.truncation.html#tenpy.algorithms.truncation.TruncationError" title="tenpy.algorithms.truncation.TruncationError"><code class="xref py py-class docutils literal notranslate"><span class="pre">TruncationError</span></code></a></span></dt>
<dd><p class="first last">The error of the represented state which is introduced due to the truncation
during this sequence of update steps.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="tenpy.algorithms.purification_tebd.Disentangler">
<em class="property">class </em><code class="descclassname">tenpy.algorithms.purification_tebd.</code><code class="descname">Disentangler</code><span class="sig-paren">(</span><em>parent</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tenpy/algorithms/purification_tebd.html#Disentangler"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tenpy.algorithms.purification_tebd.Disentangler" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Prototype for a disentangler. Trivial, does nothing.</p>
<p>In purification, we write <span class="math notranslate nohighlight">\(\rho_P = Tr_Q{|\psi_{P,Q}&gt;&lt;\psi_{P,Q}|}\)</span>. Thus, we
can actually apply any unitary to the auxiliar <cite>Q</cite> space of <span class="math notranslate nohighlight">\(|\psi&gt;\)</span> without
changing the physical expectation values.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">We have to apply the <em>same</em> unitary to the ‘bra’ and ‘ket’ used for expectation values
/ correlation functions!</p>
</div>
<p>However, the unitary can strongly influence the entanglement structure of <span class="math notranslate nohighlight">\(|\psi&gt;\)</span>.
Therefore, the <a class="reference internal" href="#tenpy.algorithms.purification_tebd.PurificationTEBD" title="tenpy.algorithms.purification_tebd.PurificationTEBD"><code class="xref py py-class docutils literal notranslate"><span class="pre">PurificationTEBD</span></code></a> includes a hook in
<a class="reference internal" href="#tenpy.algorithms.purification_tebd.PurificationTEBD.update_bond" title="tenpy.algorithms.purification_tebd.PurificationTEBD.update_bond"><code class="xref py py-meth docutils literal notranslate"><span class="pre">PurificationTEBD.update_bond()</span></code></a> (and similar methods) to find and apply a disentangling
unitary to the auxiliar indices of a two-site wave function by calling (<code class="docutils literal notranslate"><span class="pre">__call__</span></code> method)
a <cite>Disentangler</cite>.</p>
<p>This class is a ‘trivial’ disentangler which does <em>nothing</em> to the two-site wave function;
derived classes use different strategies to find various disentanglers.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>parent</strong> <span class="classifier-delimiter">:</span> <span class="classifier"><a class="reference internal" href="tenpy.algorithms.tebd.html#tenpy.algorithms.tebd.Engine" title="tenpy.algorithms.tebd.Engine"><code class="xref py py-class docutils literal notranslate"><span class="pre">Engine</span></code></a></span></dt>
<dd><p class="first last">The parent class calling the disentangler.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Attributes:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>parent</strong> <span class="classifier-delimiter">:</span> <span class="classifier"><a class="reference internal" href="tenpy.algorithms.tebd.html#tenpy.algorithms.tebd.Engine" title="tenpy.algorithms.tebd.Engine"><code class="xref py py-class docutils literal notranslate"><span class="pre">Engine</span></code></a></span></dt>
<dd><p class="first last">The parent class calling the disentangler.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">__call__</span></code>(theta)</td>
<td>Find and apply a unitary to disentangle <cite>theta</cite>.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="class">
<dt id="tenpy.algorithms.purification_tebd.BackwardDisentangler">
<em class="property">class </em><code class="descclassname">tenpy.algorithms.purification_tebd.</code><code class="descname">BackwardDisentangler</code><span class="sig-paren">(</span><em>parent</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tenpy/algorithms/purification_tebd.html#BackwardDisentangler"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tenpy.algorithms.purification_tebd.BackwardDisentangler" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#tenpy.algorithms.purification_tebd.Disentangler" title="tenpy.algorithms.purification_tebd.Disentangler"><code class="xref py py-class docutils literal notranslate"><span class="pre">tenpy.algorithms.purification_tebd.Disentangler</span></code></a></p>
<p>Disentangle with backward time evolution.</p>
<p>See <a class="reference internal" href="../literature.html#karrasch2013" id="id1">[Karrasch2013]</a> for details; only useful during real-time evolution.</p>
<p>For the infinite temperature state, <code class="docutils literal notranslate"><span class="pre">theta</span> <span class="pre">=</span> <span class="pre">delta_{p0,</span> <span class="pre">q0}*delta_{p1,</span> <span class="pre">q1}</span></code>.
Thus, an application of <cite>U_bond</cite> to <code class="docutils literal notranslate"><span class="pre">p0,</span> <span class="pre">p1</span></code> can be reverted completely by applying
<code class="docutils literal notranslate"><span class="pre">U_bond^{dagger}</span></code> to <code class="docutils literal notranslate"><span class="pre">q0,</span> <span class="pre">q1</span></code>, resulting in the same state.
This works also for finite temperatures, since <cite>exp(-beta H)</cite> and <cite>exp(-i H t)</cite> commute.
Once we apply an operator to measure correlation function, the disentangling
breaks down, yet for a local operator only in it’s light-cone.</p>
<p>Arguments and return values are the same as for <a class="reference internal" href="#tenpy.algorithms.purification_tebd.Disentangler" title="tenpy.algorithms.purification_tebd.Disentangler"><code class="xref py py-class docutils literal notranslate"><span class="pre">Disentangler</span></code></a>.</p>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">__call__</span></code>(theta)</td>
<td>Find and apply a unitary to disentangle <cite>theta</cite>.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="class">
<dt id="tenpy.algorithms.purification_tebd.RenyiDisentangler">
<em class="property">class </em><code class="descclassname">tenpy.algorithms.purification_tebd.</code><code class="descname">RenyiDisentangler</code><span class="sig-paren">(</span><em>parent</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tenpy/algorithms/purification_tebd.html#RenyiDisentangler"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tenpy.algorithms.purification_tebd.RenyiDisentangler" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#tenpy.algorithms.purification_tebd.Disentangler" title="tenpy.algorithms.purification_tebd.Disentangler"><code class="xref py py-class docutils literal notranslate"><span class="pre">tenpy.algorithms.purification_tebd.Disentangler</span></code></a></p>
<p>Iterative find <cite>U</cite> which minimized the second Renyi entropy.</p>
<p>See <a class="reference internal" href="../literature.html#hauschild2017" id="id2">[Hauschild2017]</a></p>
<p>Reads of the following <cite>TEBD_params</cite> as break criteria for the iteration:</p>
<table border="1" class="docutils">
<colgroup>
<col width="21%" />
<col width="8%" />
<col width="71%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">key</th>
<th class="head">type</th>
<th class="head">description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>disent_eps</td>
<td>float</td>
<td>Break, if the change in the Renyi entropy <code class="docutils literal notranslate"><span class="pre">S(n=2)</span></code>
per iteration is smaller than this value.</td>
</tr>
<tr class="row-odd"><td>disent_max_iter</td>
<td>float</td>
<td>Maximum number of iterations to perform.</td>
</tr>
</tbody>
</table>
<p>Arguments and return values are the same as for <code class="xref py py-meth docutils literal notranslate"><span class="pre">disentangle()</span></code>.</p>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">__call__</span></code>(theta)</td>
<td>Find optimal <cite>U</cite> which minimizes the second Renyi entropy.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#tenpy.algorithms.purification_tebd.RenyiDisentangler.iter" title="tenpy.algorithms.purification_tebd.RenyiDisentangler.iter"><code class="xref py py-obj docutils literal notranslate"><span class="pre">iter</span></code></a>(theta,&nbsp;U)</td>
<td>Given <cite>theta</cite> and <cite>U</cite>, find another <cite>U</cite> which reduces the 2nd Renyi entropy.</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="tenpy.algorithms.purification_tebd.RenyiDisentangler.iter">
<code class="descname">iter</code><span class="sig-paren">(</span><em>theta</em>, <em>U</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tenpy/algorithms/purification_tebd.html#RenyiDisentangler.iter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tenpy.algorithms.purification_tebd.RenyiDisentangler.iter" title="Permalink to this definition">¶</a></dt>
<dd><p>Given <cite>theta</cite> and <cite>U</cite>, find another <cite>U</cite> which reduces the 2nd Renyi entropy.</p>
<p>Temporarily view the different <cite>U</cite> as independt and mimizied one of them -
this corresponds to a linearization of the cost function.
Defining <cite>Utheta</cite> as the application of <cite>U</cite> to <cite>theata</cite>, and combining the <cite>p</cite> legs of
<cite>theta</cite> with <code class="docutils literal notranslate"><span class="pre">'vL',</span> <span class="pre">'vR'</span></code>, this function contracts:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">|</span>     <span class="o">.----</span><span class="n">theta</span><span class="o">----.</span>
<span class="o">|</span>     <span class="o">|</span>    <span class="o">|</span>   <span class="o">|</span>    <span class="o">|</span>
<span class="o">|</span>     <span class="o">|</span>    <span class="n">q0</span>  <span class="n">q1</span>   <span class="o">|</span>
<span class="o">|</span>     <span class="o">|</span>             <span class="o">|</span>
<span class="o">|</span>     <span class="o">|</span>        <span class="n">q1</span><span class="o">*</span>  <span class="o">|</span>
<span class="o">|</span>     <span class="o">|</span>        <span class="o">|</span>    <span class="o">|</span>
<span class="o">|</span>     <span class="o">|</span>  <span class="o">.-</span><span class="n">Utheta</span><span class="o">*-.</span>
<span class="o">|</span>     <span class="o">|</span>  <span class="o">|</span> <span class="o">|</span>
<span class="o">|</span>     <span class="o">|</span>  <span class="o">.-</span><span class="n">Utheta</span><span class="o">--.</span>
<span class="o">|</span>     <span class="o">|</span>        <span class="o">|</span>    <span class="o">|</span>
<span class="o">|</span>     <span class="o">|</span>    <span class="n">q0</span><span class="o">*</span> <span class="o">|</span>    <span class="o">|</span>
<span class="o">|</span>     <span class="o">|</span>    <span class="o">|</span>   <span class="o">|</span>    <span class="o">|</span>
<span class="o">|</span>     <span class="o">.----</span><span class="n">Utheta</span><span class="o">*-.</span>
</pre></div>
</div>
<p>The trace yields the second Renyi entropy <cite>S2</cite>. Further, we calculate the unitary <cite>U</cite>
with maximum overlap with this network.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>theta</strong> <span class="classifier-delimiter">:</span> <span class="classifier"><a class="reference internal" href="tenpy.linalg.np_conserved.html#tenpy.linalg.np_conserved.Array" title="tenpy.linalg.np_conserved.Array"><code class="xref py py-class docutils literal notranslate"><span class="pre">Array</span></code></a></span></dt>
<dd><p class="first last">Two-site wave function to be disentangled.</p>
</dd>
<dt><strong>U</strong> <span class="classifier-delimiter">:</span> <span class="classifier"><a class="reference internal" href="tenpy.linalg.np_conserved.html#tenpy.linalg.np_conserved.Array" title="tenpy.linalg.np_conserved.Array"><code class="xref py py-class docutils literal notranslate"><span class="pre">Array</span></code></a></span></dt>
<dd><p class="first last">The previous guess for <cite>U</cite>; with legs <code class="docutils literal notranslate"><span class="pre">'q0',</span> <span class="pre">'q1',</span> <span class="pre">'q0*',</span> <span class="pre">'q1*'</span></code>.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>S2</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">Renyi entopy (n=2), <span class="math notranslate nohighlight">\(S2 = \frac{1}{1-2} \log tr(\rho_L^2)\)</span> of <cite>U theta</cite>.</p>
</dd>
<dt><strong>new_U</strong> <span class="classifier-delimiter">:</span> <span class="classifier"><a class="reference internal" href="tenpy.linalg.np_conserved.html#tenpy.linalg.np_conserved.Array" title="tenpy.linalg.np_conserved.Array"><code class="xref py py-class docutils literal notranslate"><span class="pre">Array</span></code></a></span></dt>
<dd><p class="first last">Unitary with legs <code class="docutils literal notranslate"><span class="pre">'q0',</span> <span class="pre">'q1',</span> <span class="pre">'q0*',</span> <span class="pre">'q1*'</span></code>, which should disentangle <cite>theta</cite>.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="tenpy.algorithms.purification_tebd.NormDisentangler">
<em class="property">class </em><code class="descclassname">tenpy.algorithms.purification_tebd.</code><code class="descname">NormDisentangler</code><span class="sig-paren">(</span><em>parent</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tenpy/algorithms/purification_tebd.html#NormDisentangler"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tenpy.algorithms.purification_tebd.NormDisentangler" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#tenpy.algorithms.purification_tebd.Disentangler" title="tenpy.algorithms.purification_tebd.Disentangler"><code class="xref py py-class docutils literal notranslate"><span class="pre">tenpy.algorithms.purification_tebd.Disentangler</span></code></a></p>
<p>Find optimal <cite>U</cite> for which the truncation of U|theta&gt; has maximal overlap with U|theta&gt;.</p>
<p>Reads of the following <cite>TEBD_params</cite> as break criteria for the iteration:</p>
<table border="1" class="docutils">
<colgroup>
<col width="20%" />
<col width="11%" />
<col width="69%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">key</th>
<th class="head">type</th>
<th class="head">description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>disent_eps</td>
<td>float</td>
<td>Break, if the change in the Renyi entropy <code class="docutils literal notranslate"><span class="pre">S(n=2)</span></code>
per iteration is smaller than this value.</td>
</tr>
<tr class="row-odd"><td>disent_max_iter</td>
<td>float</td>
<td>Maximum number of iterations to perform.</td>
</tr>
<tr class="row-even"><td>disent_trunc_par</td>
<td>dict</td>
<td>Truncation parameters; defaults to <cite>trunc_params</cite>.</td>
</tr>
<tr class="row-odd"><td>disent_norm_chi</td>
<td>iterable</td>
<td>To find the optimal U it can help to increase <cite>chi_max</cite>
of <cite>disent_trunc_par</cite> slowly, the default is
<code class="docutils literal notranslate"><span class="pre">range(1,</span> <span class="pre">disent_trunc_par['chi_max']+1)</span></code>.
However, that’s <strong>very</strong> slow for large <cite>chi_max</cite>,
so we allow to change it. (In fact, it makes the
disentangler <em>scale</em> worse than the rest of TEBD.)</td>
</tr>
</tbody>
</table>
<p>Arguments and return values are the same as for <code class="xref py py-meth docutils literal notranslate"><span class="pre">disentangle()</span></code>.</p>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">__call__</span></code>(theta)</td>
<td>Find and apply a unitary to disentangle <cite>theta</cite>.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#tenpy.algorithms.purification_tebd.NormDisentangler.iter" title="tenpy.algorithms.purification_tebd.NormDisentangler.iter"><code class="xref py py-obj docutils literal notranslate"><span class="pre">iter</span></code></a>(theta,&nbsp;U,&nbsp;trunc_params)</td>
<td>Given <cite>theta</cite> and <cite>U</cite>, find <cite>U2</cite> maximizing <code class="docutils literal notranslate"><span class="pre">&lt;theta|U2</span> <span class="pre">truncate(U</span> <span class="pre">|theta&gt;)</span></code>.</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="tenpy.algorithms.purification_tebd.NormDisentangler.iter">
<code class="descname">iter</code><span class="sig-paren">(</span><em>theta</em>, <em>U</em>, <em>trunc_params</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tenpy/algorithms/purification_tebd.html#NormDisentangler.iter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tenpy.algorithms.purification_tebd.NormDisentangler.iter" title="Permalink to this definition">¶</a></dt>
<dd><p>Given <cite>theta</cite> and <cite>U</cite>, find <cite>U2</cite> maximizing <code class="docutils literal notranslate"><span class="pre">&lt;theta|U2</span> <span class="pre">truncate(U</span> <span class="pre">|theta&gt;)</span></code>.</p>
<p>Finds unitary <cite>U2</cite> which maximizes Tr(U</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>theta</strong> <span class="classifier-delimiter">:</span> <span class="classifier"><a class="reference internal" href="tenpy.linalg.np_conserved.html#tenpy.linalg.np_conserved.Array" title="tenpy.linalg.np_conserved.Array"><code class="xref py py-class docutils literal notranslate"><span class="pre">Array</span></code></a></span></dt>
<dd><p class="first last">Two-site wave function to be disentangled.</p>
</dd>
<dt><strong>U</strong> <span class="classifier-delimiter">:</span> <span class="classifier"><a class="reference internal" href="tenpy.linalg.np_conserved.html#tenpy.linalg.np_conserved.Array" title="tenpy.linalg.np_conserved.Array"><code class="xref py py-class docutils literal notranslate"><span class="pre">Array</span></code></a></span></dt>
<dd><p class="first last">The previous guess for <cite>U</cite>; with legs <code class="docutils literal notranslate"><span class="pre">'q0',</span> <span class="pre">'q1',</span> <span class="pre">'q0*',</span> <span class="pre">'q1*'</span></code>.</p>
</dd>
<dt><strong>trunc_params</strong> <span class="classifier-delimiter">:</span> <span class="classifier">dict</span></dt>
<dd><p class="first last">The truncation parameters (similar as <cite>self.trunc_params</cite>) used to truncate <cite>U|theta&gt;</cite>.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>trunc_err</strong> <span class="classifier-delimiter">:</span> <span class="classifier">TruncationError</span></dt>
<dd><p class="first last">Norm error discarded during the truncation of <code class="docutils literal notranslate"><span class="pre">U|theta&gt;</span></code>.</p>
</dd>
<dt><strong>new_U</strong> <span class="classifier-delimiter">:</span> <span class="classifier"><a class="reference internal" href="tenpy.linalg.np_conserved.html#tenpy.linalg.np_conserved.Array" title="tenpy.linalg.np_conserved.Array"><code class="xref py py-class docutils literal notranslate"><span class="pre">Array</span></code></a></span></dt>
<dd><p class="first last">Unitary with legs <code class="docutils literal notranslate"><span class="pre">'q0',</span> <span class="pre">'q1',</span> <span class="pre">'q0*',</span> <span class="pre">'q1*'</span></code>.
Chosen such that <code class="docutils literal notranslate"><span class="pre">new_U|theta&gt;</span></code> has maximal overlap with the truncated <code class="docutils literal notranslate"><span class="pre">U|theta&gt;</span></code>.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="tenpy.algorithms.purification_tebd.DiagonalizeDisentangler">
<em class="property">class </em><code class="descclassname">tenpy.algorithms.purification_tebd.</code><code class="descname">DiagonalizeDisentangler</code><span class="sig-paren">(</span><em>parent</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tenpy/algorithms/purification_tebd.html#DiagonalizeDisentangler"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tenpy.algorithms.purification_tebd.DiagonalizeDisentangler" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#tenpy.algorithms.purification_tebd.Disentangler" title="tenpy.algorithms.purification_tebd.Disentangler"><code class="xref py py-class docutils literal notranslate"><span class="pre">tenpy.algorithms.purification_tebd.Disentangler</span></code></a></p>
<p>Disentangle by diagonalizing the two-site density matrix in the auxiliar space.</p>
<p>See <a class="reference external" href="https://arxiv.org/abs/1704.01974">arXiv:1704.01974</a>.
Problem: Sorting by eigenvalues breaks the charge conservation!
Instead we just sort within the charge blocks.
For non-trivial charges, this might increase the entropy!</p>
<p>Arguments and return values are the same as for <a class="reference internal" href="#tenpy.algorithms.purification_tebd.Disentangler" title="tenpy.algorithms.purification_tebd.Disentangler"><code class="xref py py-class docutils literal notranslate"><span class="pre">Disentangler</span></code></a>.</p>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">__call__</span></code>(theta)</td>
<td>Find and apply a unitary to disentangle <cite>theta</cite>.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="class">
<dt id="tenpy.algorithms.purification_tebd.GradientDescentDisentangler">
<em class="property">class </em><code class="descclassname">tenpy.algorithms.purification_tebd.</code><code class="descname">GradientDescentDisentangler</code><span class="sig-paren">(</span><em>parent</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tenpy/algorithms/purification_tebd.html#GradientDescentDisentangler"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tenpy.algorithms.purification_tebd.GradientDescentDisentangler" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#tenpy.algorithms.purification_tebd.Disentangler" title="tenpy.algorithms.purification_tebd.Disentangler"><code class="xref py py-class docutils literal notranslate"><span class="pre">tenpy.algorithms.purification_tebd.Disentangler</span></code></a></p>
<p>Gradient-descent optimization, similar to <a class="reference internal" href="#tenpy.algorithms.purification_tebd.RenyiDisentangler" title="tenpy.algorithms.purification_tebd.RenyiDisentangler"><code class="xref py py-class docutils literal notranslate"><span class="pre">RenyiDisentangler</span></code></a>.</p>
<p>Reads of the following <cite>TEBD_params</cite>:</p>
<table border="1" class="docutils">
<colgroup>
<col width="21%" />
<col width="8%" />
<col width="71%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">key</th>
<th class="head">type</th>
<th class="head">description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>disent_eps</td>
<td>float</td>
<td>Break, if the change in the Renyi entropy <code class="docutils literal notranslate"><span class="pre">S(n=2)</span></code>
per iteration is smaller than this value.</td>
</tr>
<tr class="row-odd"><td>disent_max_iter</td>
<td>float</td>
<td>Maximum number of iterations to perform.</td>
</tr>
<tr class="row-even"><td>disent_n</td>
<td>float</td>
<td>Renyi index of the entropy to be used.
<code class="docutils literal notranslate"><span class="pre">n=1</span></code> for von-Neumann entropy.</td>
</tr>
</tbody>
</table>
<p>Arguments and return values are the same as for <a class="reference internal" href="#tenpy.algorithms.purification_tebd.Disentangler" title="tenpy.algorithms.purification_tebd.Disentangler"><code class="xref py py-class docutils literal notranslate"><span class="pre">Disentangler</span></code></a>.</p>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">__call__</span></code>(theta)</td>
<td>Find and apply a unitary to disentangle <cite>theta</cite>.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#tenpy.algorithms.purification_tebd.GradientDescentDisentangler.iter" title="tenpy.algorithms.purification_tebd.GradientDescentDisentangler.iter"><code class="xref py py-obj docutils literal notranslate"><span class="pre">iter</span></code></a>(theta)</td>
<td>Given <cite>theta</cite>, find a unitary <cite>U</cite> towards minimizing the n-th Renyi entropy.</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="tenpy.algorithms.purification_tebd.GradientDescentDisentangler.iter">
<code class="descname">iter</code><span class="sig-paren">(</span><em>theta</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tenpy/algorithms/purification_tebd.html#GradientDescentDisentangler.iter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tenpy.algorithms.purification_tebd.GradientDescentDisentangler.iter" title="Permalink to this definition">¶</a></dt>
<dd><p>Given <cite>theta</cite>, find a unitary <cite>U</cite> towards minimizing the n-th Renyi entropy.</p>
<p>This function calulates the gradiant <span class="math notranslate nohighlight">\(dS = \partial S(U theta, n) /\partial U\)</span>.
and then <code class="docutils literal notranslate"><span class="pre">U(t)</span> <span class="pre">=</span> <span class="pre">exp(-t*dS)</span></code>, where we choose the <cite>t</cite> from stepsizes which
minimizes the entropy of <code class="docutils literal notranslate"><span class="pre">U(t)</span> <span class="pre">theta</span></code>.</p>
<p>When <code class="docutils literal notranslate"><span class="pre">R[i]</span></code> is the derivative <span class="math notranslate nohighlight">\(\partial S(Y, n) \partial Y_i\)</span> of the (n-th Renyi)
entropy, <code class="docutils literal notranslate"><span class="pre">dS</span></code> is given by:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">|</span>     <span class="o">.----</span><span class="n">X</span><span class="o">--</span><span class="n">R</span><span class="o">--</span><span class="n">Z</span><span class="o">----.</span>
<span class="o">|</span>     <span class="o">|</span>    <span class="o">|</span>     <span class="o">|</span>    <span class="o">|</span>
<span class="o">|</span>     <span class="o">|</span>    <span class="n">q0</span>    <span class="n">q1</span>   <span class="o">|</span>
<span class="o">|</span>     <span class="o">|</span>               <span class="o">|</span>
<span class="o">|</span>     <span class="o">|</span>    <span class="n">q0</span><span class="o">*</span>   <span class="n">q1</span><span class="o">*</span>  <span class="o">|</span>
<span class="o">|</span>     <span class="o">|</span>    <span class="o">|</span>     <span class="o">|</span>    <span class="o">|</span>
<span class="o">|</span>     <span class="o">.----</span><span class="n">X</span><span class="o">*-</span><span class="n">Y</span><span class="o">--</span><span class="n">Z</span><span class="o">*---.</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>theta</strong> <span class="classifier-delimiter">:</span> <span class="classifier"><a class="reference internal" href="tenpy.linalg.np_conserved.html#tenpy.linalg.np_conserved.Array" title="tenpy.linalg.np_conserved.Array"><code class="xref py py-class docutils literal notranslate"><span class="pre">Array</span></code></a></span></dt>
<dd><p class="first last">Two-site wave function to be disentangled</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>S</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">n-th Renyi entopy of new_theta</p>
</dd>
<dt><strong>theta</strong> <span class="classifier-delimiter">:</span> <span class="classifier"><a class="reference internal" href="tenpy.linalg.np_conserved.html#tenpy.linalg.np_conserved.Array" title="tenpy.linalg.np_conserved.Array"><code class="xref py py-class docutils literal notranslate"><span class="pre">Array</span></code></a></span></dt>
<dd><p class="first last">The <em>disentangled</em> wave function <code class="docutils literal notranslate"><span class="pre">new_U</span> <span class="pre">theta</span></code>.</p>
</dd>
<dt><strong>new_U</strong> <span class="classifier-delimiter">:</span> <span class="classifier"><a class="reference internal" href="tenpy.linalg.np_conserved.html#tenpy.linalg.np_conserved.Array" title="tenpy.linalg.np_conserved.Array"><code class="xref py py-class docutils literal notranslate"><span class="pre">Array</span></code></a></span></dt>
<dd><p class="first last">Unitary with legs <code class="docutils literal notranslate"><span class="pre">'q0',</span> <span class="pre">'q1',</span> <span class="pre">'q0*',</span> <span class="pre">'q1*'</span></code>, which was used to disentangle <cite>theta</cite>.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="tenpy.algorithms.purification_tebd.NoiseDisentangler">
<em class="property">class </em><code class="descclassname">tenpy.algorithms.purification_tebd.</code><code class="descname">NoiseDisentangler</code><span class="sig-paren">(</span><em>parent</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tenpy/algorithms/purification_tebd.html#NoiseDisentangler"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tenpy.algorithms.purification_tebd.NoiseDisentangler" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#tenpy.algorithms.purification_tebd.Disentangler" title="tenpy.algorithms.purification_tebd.Disentangler"><code class="xref py py-class docutils literal notranslate"><span class="pre">tenpy.algorithms.purification_tebd.Disentangler</span></code></a></p>
<p>Apply a little bit of random noise. Useful as pre-step to <a class="reference internal" href="#tenpy.algorithms.purification_tebd.RenyiDisentangler" title="tenpy.algorithms.purification_tebd.RenyiDisentangler"><code class="xref py py-class docutils literal notranslate"><span class="pre">RenyiDisentangler</span></code></a>.</p>
<p>Arguments and return values are the same as for <a class="reference internal" href="#tenpy.algorithms.purification_tebd.Disentangler" title="tenpy.algorithms.purification_tebd.Disentangler"><code class="xref py py-class docutils literal notranslate"><span class="pre">Disentangler</span></code></a>.</p>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">__call__</span></code>(theta)</td>
<td>Find and apply a unitary to disentangle <cite>theta</cite>.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="class">
<dt id="tenpy.algorithms.purification_tebd.LastDisentangler">
<em class="property">class </em><code class="descclassname">tenpy.algorithms.purification_tebd.</code><code class="descname">LastDisentangler</code><span class="sig-paren">(</span><em>parent</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tenpy/algorithms/purification_tebd.html#LastDisentangler"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tenpy.algorithms.purification_tebd.LastDisentangler" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#tenpy.algorithms.purification_tebd.Disentangler" title="tenpy.algorithms.purification_tebd.Disentangler"><code class="xref py py-class docutils literal notranslate"><span class="pre">tenpy.algorithms.purification_tebd.Disentangler</span></code></a></p>
<p>Use the last total ‘U’ used in <code class="xref py py-meth docutils literal notranslate"><span class="pre">disentangle()</span></code> for the same _update_index as guess.</p>
<p>Useful as a starting point in a <a class="reference internal" href="#tenpy.algorithms.purification_tebd.CompositeDisentangler" title="tenpy.algorithms.purification_tebd.CompositeDisentangler"><code class="xref py py-class docutils literal notranslate"><span class="pre">CompositeDisentangler</span></code></a> to reduce the number of
iterations for a following disentangler.</p>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">__call__</span></code>(theta)</td>
<td>Find and apply a unitary to disentangle <cite>theta</cite>.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="class">
<dt id="tenpy.algorithms.purification_tebd.CompositeDisentangler">
<em class="property">class </em><code class="descclassname">tenpy.algorithms.purification_tebd.</code><code class="descname">CompositeDisentangler</code><span class="sig-paren">(</span><em>disentanglers</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tenpy/algorithms/purification_tebd.html#CompositeDisentangler"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tenpy.algorithms.purification_tebd.CompositeDisentangler" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#tenpy.algorithms.purification_tebd.Disentangler" title="tenpy.algorithms.purification_tebd.Disentangler"><code class="xref py py-class docutils literal notranslate"><span class="pre">tenpy.algorithms.purification_tebd.Disentangler</span></code></a></p>
<p>Concatenate multiple disentanglers.</p>
<p>Applies multiple disentanglers, one after another (in iteration order).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>disentanglers</strong> <span class="classifier-delimiter">:</span> <span class="classifier">list of <a class="reference internal" href="#tenpy.algorithms.purification_tebd.Disentangler" title="tenpy.algorithms.purification_tebd.Disentangler"><code class="xref py py-class docutils literal notranslate"><span class="pre">Disentangler</span></code></a></span></dt>
<dd><p class="first last">The disentanglers to be used.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Attributes:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>disentanglers</strong> <span class="classifier-delimiter">:</span> <span class="classifier">list of <a class="reference internal" href="#tenpy.algorithms.purification_tebd.Disentangler" title="tenpy.algorithms.purification_tebd.Disentangler"><code class="xref py py-class docutils literal notranslate"><span class="pre">Disentangler</span></code></a></span></dt>
<dd><p class="first last">The disentanglers to be used.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">__call__</span></code>(theta)</td>
<td>Find and apply a unitary to disentangle <cite>theta</cite>.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="class">
<dt id="tenpy.algorithms.purification_tebd.MinDisentangler">
<em class="property">class </em><code class="descclassname">tenpy.algorithms.purification_tebd.</code><code class="descname">MinDisentangler</code><span class="sig-paren">(</span><em>disentanglers</em>, <em>parent</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tenpy/algorithms/purification_tebd.html#MinDisentangler"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tenpy.algorithms.purification_tebd.MinDisentangler" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#tenpy.algorithms.purification_tebd.Disentangler" title="tenpy.algorithms.purification_tebd.Disentangler"><code class="xref py py-class docutils literal notranslate"><span class="pre">tenpy.algorithms.purification_tebd.Disentangler</span></code></a></p>
<p>Chose the disentangler giving the smallest entropy.</p>
<p>Apply each of the disentanglers to the given <cite>theta</cite>, use the result with smallest entropy.
Reads the TEBD_param <code class="docutils literal notranslate"><span class="pre">'disent_min_n'</span></code> which selects the <a class="reference internal" href="tenpy.tools.math.html#tenpy.tools.math.entropy" title="tenpy.tools.math.entropy"><code class="xref py py-func docutils literal notranslate"><span class="pre">entropy()</span></code></a>
to be used for comparison.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>disentanglers</strong> <span class="classifier-delimiter">:</span> <span class="classifier">list of <a class="reference internal" href="#tenpy.algorithms.purification_tebd.Disentangler" title="tenpy.algorithms.purification_tebd.Disentangler"><code class="xref py py-class docutils literal notranslate"><span class="pre">Disentangler</span></code></a></span></dt>
<dd><p class="first last">The disentanglers to be used.</p>
</dd>
<dt><strong>parent</strong> <span class="classifier-delimiter">:</span> <span class="classifier"><a class="reference internal" href="tenpy.algorithms.tebd.html#tenpy.algorithms.tebd.Engine" title="tenpy.algorithms.tebd.Engine"><code class="xref py py-class docutils literal notranslate"><span class="pre">Engine</span></code></a></span></dt>
<dd><p class="first last">The parent class calling the disentangler.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Attributes:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>n</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">Selects the entropy to be used for comparison.</p>
</dd>
<dt><strong>disentanglers</strong> <span class="classifier-delimiter">:</span> <span class="classifier">list of <a class="reference internal" href="#tenpy.algorithms.purification_tebd.Disentangler" title="tenpy.algorithms.purification_tebd.Disentangler"><code class="xref py py-class docutils literal notranslate"><span class="pre">Disentangler</span></code></a></span></dt>
<dd><p class="first last">The disentanglers to be used.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">__call__</span></code>(theta)</td>
<td>Find and apply a unitary to disentangle <cite>theta</cite>.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="tenpy.algorithms.purification_tebd.get_disentangler">
<code class="descclassname">tenpy.algorithms.purification_tebd.</code><code class="descname">get_disentangler</code><span class="sig-paren">(</span><em>method</em>, <em>parent</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tenpy/algorithms/purification_tebd.html#get_disentangler"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tenpy.algorithms.purification_tebd.get_disentangler" title="Permalink to this definition">¶</a></dt>
<dd><p>Parse the parameter <cite>method</cite> and construct a <a class="reference internal" href="#tenpy.algorithms.purification_tebd.Disentangler" title="tenpy.algorithms.purification_tebd.Disentangler"><code class="xref py py-class docutils literal notranslate"><span class="pre">Disentangler</span></code></a> instance.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>method</strong> <span class="classifier-delimiter">:</span> <span class="classifier">str | <code class="docutils literal notranslate"><span class="pre">None</span></code></span></dt>
<dd><p class="first last">The method to be used, of the form ‘method1-method2-min(method3,method4-method5)’.
The usage should be clear from the examples, the precise rule follows:
We parse the full <cite>method</cite> string as a <cite>composite</cite>, and define
<code class="docutils literal notranslate"><span class="pre">composite</span> <span class="pre">:=</span> <span class="pre">min_atom</span> <span class="pre">['-'</span> <span class="pre">min_atom</span> <span class="pre">...]</span></code>,
<code class="docutils literal notranslate"><span class="pre">min_atom</span> <span class="pre">:=</span> <span class="pre">{</span> <span class="pre">'min('</span> <span class="pre">composite</span> <span class="pre">[','</span> <span class="pre">composite</span> <span class="pre">...]</span> <span class="pre">')'</span> <span class="pre">}</span> <span class="pre">|</span> <span class="pre">atom</span></code>, and
<code class="docutils literal notranslate"><span class="pre">atom</span> <span class="pre">:=</span> <span class="pre">{any</span> <span class="pre">key</span> <span class="pre">of</span> <span class="pre">`disentanglers_atom_parse_dict`}</span></code>.</p>
</dd>
<dt><strong>parent</strong> <span class="classifier-delimiter">:</span> <span class="classifier"><a class="reference internal" href="tenpy.algorithms.tebd.html#tenpy.algorithms.tebd.Engine" title="tenpy.algorithms.tebd.Engine"><code class="xref py py-class docutils literal notranslate"><span class="pre">Engine</span></code></a></span></dt>
<dd><p class="first last">The parent class calling the disentangler.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>disentangler</strong> <span class="classifier-delimiter">:</span> <span class="classifier"><a class="reference internal" href="#tenpy.algorithms.purification_tebd.Disentangler" title="tenpy.algorithms.purification_tebd.Disentangler"><code class="xref py py-class docutils literal notranslate"><span class="pre">Disentangler</span></code></a></span></dt>
<dd><p class="first last">Disentangler instance, which can be called to disentangle a 2-site <cite>theta</cite>
with the specified <cite>method</cite>.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">get_disentangler</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
<span class="go">Disentangler(p)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">get_disentangler</span><span class="p">(</span><span class="s1">&#39;last-renyi&#39;</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
<span class="go">Disentangler([LastDisentangler(p), RenyiDisentangler(p)], p)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">get_disentangler</span><span class="p">(</span><span class="s1">&#39;min(None,noise-renyi,min(backwards,last)-graddesc)&#39;</span><span class="p">)</span>
<span class="go">MinDisentangler([Disentangler,</span>
<span class="go">                 CompositeDisentangler([NoiseDisentangler(p), RenyiDisentangler(p)], p),</span>
<span class="go">                 CompositeDisentangler([MinDisentangler([BackwardDisentangler(p),</span>
<span class="go">                                                         LastDisentangler(p)]),</span>
<span class="go">                                        GradientDescentDisentangler(p)], p), p)</span>
</pre></div>
</div>
</dd></dl>

</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/logo.png" alt="Logo"/>
            </a></p>
  <h4>Previous topic</h4>
  <p class="topless"><a href="tenpy.algorithms.network_contractor.html"
                        title="previous chapter">tenpy.algorithms.network_contractor module</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="tenpy.algorithms.tebd.html"
                        title="next chapter">tenpy.algorithms.tebd module</a></p>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
<h3><a href="../index.html">Table of Contents</a></h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../userguide.html">User Guide</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="tenpy.html">Reference</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="tenpy.html#subpackages">Subpackages</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="tenpy.algorithms.html">tenpy.algorithms package</a></li>
<li class="toctree-l3"><a class="reference internal" href="tenpy.linalg.html">tenpy.linalg package</a></li>
<li class="toctree-l3"><a class="reference internal" href="tenpy.models.html">tenpy.models package</a></li>
<li class="toctree-l3"><a class="reference internal" href="tenpy.networks.html">tenpy.networks package</a></li>
<li class="toctree-l3"><a class="reference internal" href="tenpy.tools.html">tenpy.tools package</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="tenpy.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="tenpy.html#module-tenpy">Module contents</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="tenpy.algorithms.tebd.html" title="tenpy.algorithms.tebd module"
             >next</a> |</li>
        <li class="right" >
          <a href="tenpy.algorithms.network_contractor.html" title="tenpy.algorithms.network_contractor module"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">TeNPy 0.3.0 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="tenpy.html" >Reference</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="tenpy.algorithms.html" >tenpy.algorithms package</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2016-2019, TeNPy Developers.
      Last updated on Mar 06, 2019.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.8.4.
    </div>
  </body>
</html>