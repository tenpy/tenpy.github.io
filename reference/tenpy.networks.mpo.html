
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>mpo &#8212; TeNPy 0.5.0 documentation</title>
    <link rel="stylesheet" href="../_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css" />
    
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/language_data.js"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <link rel="shortcut icon" href="../_static/logo.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="MPO" href="tenpy.networks.mpo.MPO.html" />
    <link rel="prev" title="build_initial_state" href="tenpy.networks.mps.build_initial_state.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="tenpy.networks.mpo.MPO.html" title="MPO"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="tenpy.networks.mps.build_initial_state.html" title="build_initial_state"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">TeNPy 0.5.0 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="tenpy.networks.html" accesskey="U">networks</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="mpo">
<h1>mpo<a class="headerlink" href="#mpo" title="Permalink to this headline">¶</a></h1>
<ul class="simple">
<li><p>full name: tenpy.networks.mpo</p></li>
<li><p>parent module: <a class="reference internal" href="tenpy.networks.html#module-tenpy.networks" title="tenpy.networks"><code class="xref py py-mod docutils literal notranslate"><span class="pre">tenpy.networks</span></code></a></p></li>
<li><p>type: module</p></li>
</ul>
<p class="rubric">Classes</p>
<div class="graphviz"><img src="../_images/inheritance-82c6240b566cc89144b2aad19e7137b764a30664.png" alt="Inheritance diagram of tenpy.networks.mpo" usemap="#inheritance84c0921704" class="inheritance graphviz" /></div>
<map id="inheritance84c0921704" name="inheritance84c0921704">
<area shape="rect" id="node1" href="tenpy.networks.mpo.MPO.html#tenpy.networks.mpo.MPO" target="_top" title="Matrix product operator, finite (MPO) or infinite (iMPO)." alt="" coords="5,5,77,31"/>
<area shape="rect" id="node2" href="tenpy.networks.mpo.MPOEnvironment.html#tenpy.networks.mpo.MPOEnvironment" target="_top" title="Stores partial contractions of :math:`&lt;bra|H|ket&gt;` for an MPO `H`." alt="" coords="201,79,335,104"/>
<area shape="rect" id="node3" href="tenpy.networks.mps.MPSEnvironment.html#tenpy.networks.mps.MPSEnvironment" target="_top" title="Stores partial contractions of :math:`&lt;bra|Op|ket&gt;` for local operators `Op`." alt="" coords="202,5,334,31"/>
<area shape="rect" id="node4" href="tenpy.networks.mpo.MPOGraph.html#tenpy.networks.mpo.MPOGraph" target="_top" title="Representation of an MPO by a graph, based on a &#39;finite state machine&#39;." alt="" coords="409,5,500,31"/>
</map><table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="tenpy.networks.mpo.MPO.html#tenpy.networks.mpo.MPO" title="tenpy.networks.mpo.MPO"><code class="xref py py-obj docutils literal notranslate"><span class="pre">MPO</span></code></a>(sites, Ws[, bc, IdL, IdR, max_range])</p></td>
<td><p>Matrix product operator, finite (MPO) or infinite (iMPO).</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="tenpy.networks.mpo.MPOEnvironment.html#tenpy.networks.mpo.MPOEnvironment" title="tenpy.networks.mpo.MPOEnvironment"><code class="xref py py-obj docutils literal notranslate"><span class="pre">MPOEnvironment</span></code></a>(bra, H, ket[, init_LP, …])</p></td>
<td><p>Stores partial contractions of <span class="math notranslate nohighlight">\(&lt;bra|H|ket&gt;\)</span> for an MPO <cite>H</cite>.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="tenpy.networks.mpo.MPOGraph.html#tenpy.networks.mpo.MPOGraph" title="tenpy.networks.mpo.MPOGraph"><code class="xref py py-obj docutils literal notranslate"><span class="pre">MPOGraph</span></code></a>(sites[, bc, max_range])</p></td>
<td><p>Representation of an MPO by a graph, based on a ‘finite state machine’.</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Functions</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="tenpy.networks.mpo.grid_insert_ops.html#tenpy.networks.mpo.grid_insert_ops" title="tenpy.networks.mpo.grid_insert_ops"><code class="xref py py-obj docutils literal notranslate"><span class="pre">grid_insert_ops</span></code></a>(site, grid)</p></td>
<td><p>Replaces entries representing operators in a grid of <code class="docutils literal notranslate"><span class="pre">W[i]</span></code> with npc.Arrays.</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Module description</p>
<span class="target" id="module-tenpy.networks.mpo"></span><p>Matrix product operator (MPO).</p>
<p>An MPO is the generalization of an <a class="reference internal" href="tenpy.networks.mps.MPS.html#tenpy.networks.mps.MPS" title="tenpy.networks.mps.MPS"><code class="xref py py-class docutils literal notranslate"><span class="pre">MPS</span></code></a> to operators. Graphically:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">|</span>      <span class="o">^</span>        <span class="o">^</span>        <span class="o">^</span>
<span class="o">|</span>      <span class="o">|</span>        <span class="o">|</span>        <span class="o">|</span>
<span class="o">|</span>  <span class="o">-&gt;-</span> <span class="n">W</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-&gt;-</span> <span class="n">W</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-&gt;-</span> <span class="n">W</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">-&gt;-</span> <span class="o">...</span>
<span class="o">|</span>      <span class="o">|</span>        <span class="o">|</span>        <span class="o">|</span>
<span class="o">|</span>      <span class="o">^</span>        <span class="o">^</span>        <span class="o">^</span>
</pre></div>
</div>
<p>So each ‘matrix’ has two physical legs <code class="docutils literal notranslate"><span class="pre">p,</span> <span class="pre">p*</span></code> instead of just one,
i.e. the entries of the ‘matrices’ are local operators.
Valid boundary conditions of an MPO are the same as for an MPS
(i.e. <code class="docutils literal notranslate"><span class="pre">'finite'</span> <span class="pre">|</span> <span class="pre">'segment'</span> <span class="pre">|</span> <span class="pre">'infinite'</span></code>).
(In general, you can view the MPO as an MPS with larger physical space and bring it into
canoncial form. However, unlike for an MPS, this doesn’t simplify calculations.
Thus, an MPO has no <cite>form</cite>.)</p>
<p>We use the following label convention for the <cite>W</cite> (where arrows indicate <cite>qconj</cite>):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">|</span>            <span class="n">p</span><span class="o">*</span>
<span class="o">|</span>            <span class="o">^</span>
<span class="o">|</span>            <span class="o">|</span>
<span class="o">|</span>     <span class="n">wL</span> <span class="o">-&gt;-</span> <span class="n">W</span> <span class="o">-&gt;-</span> <span class="n">wR</span>
<span class="o">|</span>            <span class="o">|</span>
<span class="o">|</span>            <span class="o">^</span>
<span class="o">|</span>            <span class="n">p</span>
</pre></div>
</div>
<p>If an MPO describes a sum of local terms (e.g. most Hamiltonians),
some bond indices correspond to ‘only identities to the left/right’.
We store these indices in <cite>IdL</cite> and <cite>IdR</cite> (if there are such indices).</p>
<p>Similar as for the MPS, a bond index <code class="docutils literal notranslate"><span class="pre">i</span></code> is <em>left</em> of site <cite>i</cite>,
i.e. between sites <code class="docutils literal notranslate"><span class="pre">i-1</span></code> and <code class="docutils literal notranslate"><span class="pre">i</span></code>.</p>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/logo.png" alt="Logo"/>
            </a></p>
  <h4>Previous topic</h4>
  <p class="topless"><a href="tenpy.networks.mps.build_initial_state.html"
                        title="previous chapter">build_initial_state</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="tenpy.networks.mpo.MPO.html"
                        title="next chapter">MPO</a></p>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
<h3><a href="../index.html">Table of Contents</a></h3>
<p class="caption"><span class="caption-text">User guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../INSTALL.html">Installation instructions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../releases.html">Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../introductions.html">Introductions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../literature.html">Literature</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contributing.html">Contributing</a></li>
</ul>
<p class="caption"><span class="caption-text">Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../main.html">Tenpy main module</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="tenpy.algorithms.html">algorithms</a></li>
<li class="toctree-l1"><a class="reference internal" href="tenpy.linalg.html">linalg</a></li>
<li class="toctree-l1"><a class="reference internal" href="tenpy.models.html">models</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="tenpy.networks.html">networks</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="tenpy.networks.site.html">site</a></li>
<li class="toctree-l2"><a class="reference internal" href="tenpy.networks.mps.html">mps</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">mpo</a><ul>
<li class="toctree-l3"><a class="reference internal" href="tenpy.networks.mpo.MPO.html">MPO</a></li>
<li class="toctree-l3"><a class="reference internal" href="tenpy.networks.mpo.MPOEnvironment.html">MPOEnvironment</a></li>
<li class="toctree-l3"><a class="reference internal" href="tenpy.networks.mpo.MPOGraph.html">MPOGraph</a></li>
<li class="toctree-l3"><a class="reference internal" href="tenpy.networks.mpo.grid_insert_ops.html">grid_insert_ops</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="tenpy.networks.terms.html">terms</a></li>
<li class="toctree-l2"><a class="reference internal" href="tenpy.networks.purification_mps.html">purification_mps</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="tenpy.tools.html">tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="tenpy.version.html">version</a></li>
</ul>

        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="tenpy.networks.mpo.MPO.html" title="MPO"
             >next</a> |</li>
        <li class="right" >
          <a href="tenpy.networks.mps.build_initial_state.html" title="build_initial_state"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">TeNPy 0.5.0 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="tenpy.networks.html" >networks</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2016-2019, TeNPy Developers.
      Last updated on Jan 06, 2020.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 2.2.2.
    </div>
  </body>
</html>