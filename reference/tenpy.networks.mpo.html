
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>tenpy.networks.mpo module &#8212; TeNPy 0.3.0 documentation</title>
    <link rel="stylesheet" href="../_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/language_data.js"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <link rel="shortcut icon" href="../_static/logo.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="tenpy.networks.mps module" href="tenpy.networks.mps.html" />
    <link rel="prev" title="tenpy.networks package" href="tenpy.networks.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="tenpy.networks.mps.html" title="tenpy.networks.mps module"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="tenpy.networks.html" title="tenpy.networks package"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">TeNPy 0.3.0 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="tenpy.html" >Reference</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="tenpy.networks.html" accesskey="U">tenpy.networks package</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="module-tenpy.networks.mpo">
<span id="tenpy-networks-mpo-module"></span><h1>tenpy.networks.mpo module<a class="headerlink" href="#module-tenpy.networks.mpo" title="Permalink to this headline">¶</a></h1>
<p>Matrix product operator (MPO).</p>
<p>An MPO is the generalization of an <a class="reference internal" href="tenpy.networks.mps.html#tenpy.networks.mps.MPS" title="tenpy.networks.mps.MPS"><code class="xref py py-class docutils literal notranslate"><span class="pre">MPS</span></code></a> to operators. Graphically:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">|</span>      <span class="o">^</span>        <span class="o">^</span>        <span class="o">^</span>
<span class="o">|</span>      <span class="o">|</span>        <span class="o">|</span>        <span class="o">|</span>
<span class="o">|</span>  <span class="o">-&gt;-</span> <span class="n">W</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-&gt;-</span> <span class="n">W</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-&gt;-</span> <span class="n">W</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">-&gt;-</span> <span class="o">...</span>
<span class="o">|</span>      <span class="o">|</span>        <span class="o">|</span>        <span class="o">|</span>
<span class="o">|</span>      <span class="o">^</span>        <span class="o">^</span>        <span class="o">^</span>
</pre></div>
</div>
<p>So each ‘matrix’ has two physical legs <code class="docutils literal notranslate"><span class="pre">p,</span> <span class="pre">p*</span></code> instead of just one,
i.e. the entries of the ‘matrices’ are local operators.
Valid boundary conditions of an MPO are the same as for an MPS
(i.e. <code class="docutils literal notranslate"><span class="pre">'finite'</span> <span class="pre">|</span> <span class="pre">'segment'</span> <span class="pre">|</span> <span class="pre">'infinite'</span></code>).
(In general, you can view the MPO as an MPS with larger physical space and bring it into
canoncial form. However, unlike for an MPS, this doesn’t simplify calculations.
Thus, an MPO has no <cite>form</cite>.)</p>
<p>We use the following label convention for the <cite>W</cite> (where arrows indicate <cite>qconj</cite>):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">|</span>            <span class="n">p</span><span class="o">*</span>
<span class="o">|</span>            <span class="o">^</span>
<span class="o">|</span>            <span class="o">|</span>
<span class="o">|</span>     <span class="n">wL</span> <span class="o">-&gt;-</span> <span class="n">W</span> <span class="o">-&gt;-</span> <span class="n">wR</span>
<span class="o">|</span>            <span class="o">|</span>
<span class="o">|</span>            <span class="o">^</span>
<span class="o">|</span>            <span class="n">p</span>
</pre></div>
</div>
<p>If an MPO describes a sum of local terms (e.g. most Hamiltonians),
some bond indices correspond to ‘only identities to the left/right’.
We store these indices in <cite>IdL</cite> and <cite>IdR</cite> (if there are such indices).</p>
<p>Similar as for the MPS, a bond index <code class="docutils literal notranslate"><span class="pre">i</span></code> is <em>left</em> of site <cite>i</cite>,
i.e. between sites <code class="docutils literal notranslate"><span class="pre">i-1</span></code> and <code class="docutils literal notranslate"><span class="pre">i</span></code>.</p>
<dl class="class">
<dt id="tenpy.networks.mpo.MPO">
<em class="property">class </em><code class="descclassname">tenpy.networks.mpo.</code><code class="descname">MPO</code><span class="sig-paren">(</span><em>sites</em>, <em>Ws</em>, <em>bc='finite'</em>, <em>IdL=None</em>, <em>IdR=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tenpy/networks/mpo.html#MPO"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tenpy.networks.mpo.MPO" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Matrix product operator, finite (MPO) or infinite (iMPO).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>sites</strong> <span class="classifier-delimiter">:</span> <span class="classifier">list of <code class="xref py py-class docutils literal notranslate"><span class="pre">Site</span></code></span></dt>
<dd><p class="first last">Defines the local Hilbert space for each site.</p>
</dd>
<dt><strong>Ws</strong> <span class="classifier-delimiter">:</span> <span class="classifier">list of <a class="reference internal" href="tenpy.linalg.np_conserved.html#tenpy.linalg.np_conserved.Array" title="tenpy.linalg.np_conserved.Array"><code class="xref py py-class docutils literal notranslate"><span class="pre">Array</span></code></a></span></dt>
<dd><p class="first last">The matrices of the MPO. Should have labels <code class="docutils literal notranslate"><span class="pre">wL,</span> <span class="pre">wR,</span> <span class="pre">p,</span> <span class="pre">p*</span></code>.</p>
</dd>
<dt><strong>bc</strong> <span class="classifier-delimiter">:</span> <span class="classifier">{‘finite’ | ‘segment’ | ‘infinite’}</span></dt>
<dd><p class="first last">Boundary conditions as described in <a class="reference internal" href="tenpy.networks.mps.html#module-tenpy.networks.mps" title="tenpy.networks.mps"><code class="xref py py-mod docutils literal notranslate"><span class="pre">mps</span></code></a>.
<code class="docutils literal notranslate"><span class="pre">'finite'</span></code> requires <code class="docutils literal notranslate"><span class="pre">Ws[0].get_leg('wL').ind_len</span> <span class="pre">=</span> <span class="pre">1</span></code>.</p>
</dd>
<dt><strong>IdL</strong> <span class="classifier-delimiter">:</span> <span class="classifier">(iterable of) {int | None}</span></dt>
<dd><p class="first last">Indices on the bonds, which correpond to ‘only identities to the left’.
A single entry holds for all bonds.</p>
</dd>
<dt><strong>IdR</strong> <span class="classifier-delimiter">:</span> <span class="classifier">(iterable of) {int | None}</span></dt>
<dd><p class="first last">Indices on the bonds, which correpond to ‘only identities to the right’.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Attributes:</th><td class="field-body"><dl class="first last docutils">
<dt><a class="reference internal" href="#tenpy.networks.mpo.MPO.L" title="tenpy.networks.mpo.MPO.L"><code class="xref py py-obj docutils literal notranslate"><span class="pre">L</span></code></a> <span class="classifier-delimiter">:</span> <span class="classifier">int</span></dt>
<dd><p class="first last">Number of physical sites.</p>
</dd>
<dt><strong>chinfo</strong> <span class="classifier-delimiter">:</span> <span class="classifier"><a class="reference internal" href="tenpy.linalg.np_conserved.html#tenpy.linalg.np_conserved.ChargeInfo" title="tenpy.linalg.np_conserved.ChargeInfo"><code class="xref py py-class docutils literal notranslate"><span class="pre">ChargeInfo</span></code></a></span></dt>
<dd><p class="first last">The nature of the charge.</p>
</dd>
<dt><strong>sites</strong> <span class="classifier-delimiter">:</span> <span class="classifier">list of <code class="xref py py-class docutils literal notranslate"><span class="pre">Site</span></code></span></dt>
<dd><p class="first last">Defines the local Hilbert space for each site.</p>
</dd>
<dt><strong>dtype</strong> <span class="classifier-delimiter">:</span> <span class="classifier">type</span></dt>
<dd><p class="first last">The data type of the <cite>_W</cite>.</p>
</dd>
<dt><strong>bc</strong> <span class="classifier-delimiter">:</span> <span class="classifier">{‘finite’ | ‘segment’ | ‘infinite’}</span></dt>
<dd><p class="first last">Boundary conditions as described in <a class="reference internal" href="tenpy.networks.mps.html#module-tenpy.networks.mps" title="tenpy.networks.mps"><code class="xref py py-mod docutils literal notranslate"><span class="pre">mps</span></code></a>.
<code class="docutils literal notranslate"><span class="pre">'finite'</span></code> requires <code class="docutils literal notranslate"><span class="pre">Ws[0].get_leg('wL').ind_len</span> <span class="pre">=</span> <span class="pre">1</span></code>.</p>
</dd>
<dt><strong>IdL</strong> <span class="classifier-delimiter">:</span> <span class="classifier">list of {int | None}</span></dt>
<dd><p class="first last">Indices on the bonds, which correpond to ‘only identities to the left’.
<code class="docutils literal notranslate"><span class="pre">None</span></code> for bonds where it is not set.</p>
</dd>
<dt><strong>IdR</strong> <span class="classifier-delimiter">:</span> <span class="classifier">list of {int | None}</span></dt>
<dd><p class="first last">Indices on the bonds, which correpond to ‘only identities to the right’.
<code class="docutils literal notranslate"><span class="pre">None</span></code> for bonds where it is not set.</p>
</dd>
<dt><strong>grouped</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int</span></dt>
<dd><p class="first last">Number of sites grouped together, see <a class="reference internal" href="#tenpy.networks.mpo.MPO.group_sites" title="tenpy.networks.mpo.MPO.group_sites"><code class="xref py py-meth docutils literal notranslate"><span class="pre">group_sites()</span></code></a>.</p>
</dd>
<dt><strong>_W</strong> <span class="classifier-delimiter">:</span> <span class="classifier">list of <a class="reference internal" href="tenpy.linalg.np_conserved.html#tenpy.linalg.np_conserved.Array" title="tenpy.linalg.np_conserved.Array"><code class="xref py py-class docutils literal notranslate"><span class="pre">Array</span></code></a></span></dt>
<dd><p class="first last">The matrices of the MPO. Labels are <code class="docutils literal notranslate"><span class="pre">'wL',</span> <span class="pre">'wR',</span> <span class="pre">'p',</span> <span class="pre">'p*'</span></code>.</p>
</dd>
<dt><strong>_valid_bc</strong> <span class="classifier-delimiter">:</span> <span class="classifier">tuple of str</span></dt>
<dd><p class="first last">Valid boundary conditions. The same as for an MPS.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#tenpy.networks.mpo.MPO.from_grids" title="tenpy.networks.mpo.MPO.from_grids"><code class="xref py py-obj docutils literal notranslate"><span class="pre">from_grids</span></code></a>(sites,&nbsp;grids[,&nbsp;bc,&nbsp;IdL,&nbsp;IdR,&nbsp;…])</td>
<td>Initialize an MPO from <cite>grids</cite>.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#tenpy.networks.mpo.MPO.get_IdL" title="tenpy.networks.mpo.MPO.get_IdL"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_IdL</span></code></a>(i)</td>
<td>Return index of <cite>IdL</cite> at bond to the <em>left</em> of site <cite>i</cite>.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#tenpy.networks.mpo.MPO.get_IdR" title="tenpy.networks.mpo.MPO.get_IdR"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_IdR</span></code></a>(i)</td>
<td>Return index of <cite>IdR</cite> at bond to the <em>right</em> of site <cite>i</cite>.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#tenpy.networks.mpo.MPO.get_W" title="tenpy.networks.mpo.MPO.get_W"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_W</span></code></a>(i[,&nbsp;copy])</td>
<td>Return <cite>W</cite> at site <cite>i</cite>.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#tenpy.networks.mpo.MPO.get_full_hamiltonian" title="tenpy.networks.mpo.MPO.get_full_hamiltonian"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_full_hamiltonian</span></code></a>([maxsize])</td>
<td>extract the full Hamiltonian as a d**L x d**L matrix</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#tenpy.networks.mpo.MPO.get_grouped_mpo" title="tenpy.networks.mpo.MPO.get_grouped_mpo"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_grouped_mpo</span></code></a>(blocklen)</td>
<td>contract blocklen subsequent tensors into a single one and return result as a new MPO object</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#tenpy.networks.mpo.MPO.group_sites" title="tenpy.networks.mpo.MPO.group_sites"><code class="xref py py-obj docutils literal notranslate"><span class="pre">group_sites</span></code></a>([n,&nbsp;grouped_sites])</td>
<td>Modify <cite>self</cite> inplace to group sites.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#tenpy.networks.mpo.MPO.set_W" title="tenpy.networks.mpo.MPO.set_W"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_W</span></code></a>(i,&nbsp;W)</td>
<td>Set <cite>W</cite> at site <cite>i</cite>.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#tenpy.networks.mpo.MPO.test_sanity" title="tenpy.networks.mpo.MPO.test_sanity"><code class="xref py py-obj docutils literal notranslate"><span class="pre">test_sanity</span></code></a>()</td>
<td>Sanity check.</td>
</tr>
</tbody>
</table>
<dl class="attribute">
<dt id="tenpy.networks.mpo.MPO.L">
<code class="descname">L</code><a class="headerlink" href="#tenpy.networks.mpo.MPO.L" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of physical sites. For an iMPO the len of the MPO unit cell.</p>
</dd></dl>

<dl class="attribute">
<dt id="tenpy.networks.mpo.MPO.chi">
<code class="descname">chi</code><a class="headerlink" href="#tenpy.networks.mpo.MPO.chi" title="Permalink to this definition">¶</a></dt>
<dd><p>Dimensions of the (nontrivial) virtual bonds.</p>
</dd></dl>

<dl class="attribute">
<dt id="tenpy.networks.mpo.MPO.dim">
<code class="descname">dim</code><a class="headerlink" href="#tenpy.networks.mpo.MPO.dim" title="Permalink to this definition">¶</a></dt>
<dd><p>List of local physical dimensions.</p>
</dd></dl>

<dl class="attribute">
<dt id="tenpy.networks.mpo.MPO.finite">
<code class="descname">finite</code><a class="headerlink" href="#tenpy.networks.mpo.MPO.finite" title="Permalink to this definition">¶</a></dt>
<dd><p>Distinguish MPO (<code class="docutils literal notranslate"><span class="pre">True;</span> <span class="pre">bc='finite',</span> <span class="pre">'segment'</span></code> ) vs. iMPO (<code class="docutils literal notranslate"><span class="pre">False;</span> <span class="pre">bc='infinite'</span></code>)</p>
</dd></dl>

<dl class="classmethod">
<dt id="tenpy.networks.mpo.MPO.from_grids">
<em class="property">classmethod </em><code class="descname">from_grids</code><span class="sig-paren">(</span><em>sites</em>, <em>grids</em>, <em>bc='finite'</em>, <em>IdL=None</em>, <em>IdR=None</em>, <em>Ws_qtotal=None</em>, <em>leg0=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tenpy/networks/mpo.html#MPO.from_grids"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tenpy.networks.mpo.MPO.from_grids" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize an MPO from <cite>grids</cite>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>sites</strong> <span class="classifier-delimiter">:</span> <span class="classifier">list of <code class="xref py py-class docutils literal notranslate"><span class="pre">Site</span></code></span></dt>
<dd><p class="first last">Defines the local Hilbert space for each site.</p>
</dd>
<dt><strong>grids</strong> <span class="classifier-delimiter">:</span> <span class="classifier">list of list of list of entries</span></dt>
<dd><p class="first last">For each site (outer-most list) a matrix-grid (corresponding to <code class="docutils literal notranslate"><span class="pre">wL,</span> <span class="pre">wR</span></code>)
with entries being or representing (see <a class="reference internal" href="#tenpy.networks.mpo.grid_insert_ops" title="tenpy.networks.mpo.grid_insert_ops"><code class="xref py py-func docutils literal notranslate"><span class="pre">grid_insert_ops()</span></code></a>) onsite-operators.</p>
</dd>
<dt><strong>bc</strong> <span class="classifier-delimiter">:</span> <span class="classifier">{‘finite’ | ‘segment’ | ‘infinite’}</span></dt>
<dd><p class="first last">Boundary conditions as described in <a class="reference internal" href="tenpy.networks.mps.html#module-tenpy.networks.mps" title="tenpy.networks.mps"><code class="xref py py-mod docutils literal notranslate"><span class="pre">mps</span></code></a>.</p>
</dd>
<dt><strong>IdL</strong> <span class="classifier-delimiter">:</span> <span class="classifier">(iterable of) {int | None}</span></dt>
<dd><p class="first last">Indices on the bonds, which correpond to ‘only identities to the left’.
A single entry holds for all bonds.</p>
</dd>
<dt><strong>IdR</strong> <span class="classifier-delimiter">:</span> <span class="classifier">(iterable of) {int | None}</span></dt>
<dd><p class="first last">Indices on the bonds, which correpond to ‘only identities to the right’.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="#tenpy.networks.mpo.grid_insert_ops" title="tenpy.networks.mpo.grid_insert_ops"><code class="xref py py-func docutils literal notranslate"><span class="pre">grid_insert_ops()</span></code></a></dt>
<dd>used to plug in <cite>entries</cite> of the grid</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">grid_outer</span></code></dt>
<dd>Used <a class="reference internal" href="tenpy.linalg.np_conserved.html#tenpy.linalg.np_conserved.grid_outer" title="tenpy.linalg.np_conserved.grid_outer"><code class="xref py py-func docutils literal notranslate"><span class="pre">grid_outer()</span></code></a> for final conversion.</dd>
</dl>
</div>
</dd></dl>

<dl class="method">
<dt id="tenpy.networks.mpo.MPO.get_IdL">
<code class="descname">get_IdL</code><span class="sig-paren">(</span><em>i</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tenpy/networks/mpo.html#MPO.get_IdL"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tenpy.networks.mpo.MPO.get_IdL" title="Permalink to this definition">¶</a></dt>
<dd><p>Return index of <cite>IdL</cite> at bond to the <em>left</em> of site <cite>i</cite>.</p>
<p>May be <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p>
</dd></dl>

<dl class="method">
<dt id="tenpy.networks.mpo.MPO.get_IdR">
<code class="descname">get_IdR</code><span class="sig-paren">(</span><em>i</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tenpy/networks/mpo.html#MPO.get_IdR"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tenpy.networks.mpo.MPO.get_IdR" title="Permalink to this definition">¶</a></dt>
<dd><p>Return index of <cite>IdR</cite> at bond to the <em>right</em> of site <cite>i</cite>.</p>
<p>May be <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p>
</dd></dl>

<dl class="method">
<dt id="tenpy.networks.mpo.MPO.get_W">
<code class="descname">get_W</code><span class="sig-paren">(</span><em>i</em>, <em>copy=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tenpy/networks/mpo.html#MPO.get_W"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tenpy.networks.mpo.MPO.get_W" title="Permalink to this definition">¶</a></dt>
<dd><p>Return <cite>W</cite> at site <cite>i</cite>.</p>
</dd></dl>

<dl class="method">
<dt id="tenpy.networks.mpo.MPO.get_full_hamiltonian">
<code class="descname">get_full_hamiltonian</code><span class="sig-paren">(</span><em>maxsize=1000000.0</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tenpy/networks/mpo.html#MPO.get_full_hamiltonian"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tenpy.networks.mpo.MPO.get_full_hamiltonian" title="Permalink to this definition">¶</a></dt>
<dd><p>extract the full Hamiltonian as a d**L x d**L matrix</p>
</dd></dl>

<dl class="method">
<dt id="tenpy.networks.mpo.MPO.get_grouped_mpo">
<code class="descname">get_grouped_mpo</code><span class="sig-paren">(</span><em>blocklen</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tenpy/networks/mpo.html#MPO.get_grouped_mpo"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tenpy.networks.mpo.MPO.get_grouped_mpo" title="Permalink to this definition">¶</a></dt>
<dd><p>contract blocklen subsequent tensors into a single one and return result as a new MPO object</p>
</dd></dl>

<dl class="method">
<dt id="tenpy.networks.mpo.MPO.group_sites">
<code class="descname">group_sites</code><span class="sig-paren">(</span><em>n=2</em>, <em>grouped_sites=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tenpy/networks/mpo.html#MPO.group_sites"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tenpy.networks.mpo.MPO.group_sites" title="Permalink to this definition">¶</a></dt>
<dd><p>Modify <cite>self</cite> inplace to group sites.</p>
<p>Group each <cite>n</cite> sites together using the <a class="reference internal" href="tenpy.networks.site.html#tenpy.networks.site.GroupedSite" title="tenpy.networks.site.GroupedSite"><code class="xref py py-class docutils literal notranslate"><span class="pre">GroupedSite</span></code></a>.
This might allow to do TEBD with a Trotter decomposition,
or help the convergence of DMRG (in case of too long range interactions).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>n</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int</span></dt>
<dd><p class="first last">Number of sites to be grouped together.</p>
</dd>
<dt><strong>grouped_sites</strong> <span class="classifier-delimiter">:</span> <span class="classifier">None | list of <a class="reference internal" href="tenpy.networks.site.html#tenpy.networks.site.GroupedSite" title="tenpy.networks.site.GroupedSite"><code class="xref py py-class docutils literal notranslate"><span class="pre">GroupedSite</span></code></a></span></dt>
<dd><p class="first last">The sites grouped together.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="tenpy.networks.mpo.MPO.set_W">
<code class="descname">set_W</code><span class="sig-paren">(</span><em>i</em>, <em>W</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tenpy/networks/mpo.html#MPO.set_W"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tenpy.networks.mpo.MPO.set_W" title="Permalink to this definition">¶</a></dt>
<dd><p>Set <cite>W</cite> at site <cite>i</cite>.</p>
</dd></dl>

<dl class="method">
<dt id="tenpy.networks.mpo.MPO.test_sanity">
<code class="descname">test_sanity</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tenpy/networks/mpo.html#MPO.test_sanity"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tenpy.networks.mpo.MPO.test_sanity" title="Permalink to this definition">¶</a></dt>
<dd><p>Sanity check. Raises Errors if something is wrong.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="tenpy.networks.mpo.MPOGraph">
<em class="property">class </em><code class="descclassname">tenpy.networks.mpo.</code><code class="descname">MPOGraph</code><span class="sig-paren">(</span><em>sites</em>, <em>bc='finite'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tenpy/networks/mpo.html#MPOGraph"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tenpy.networks.mpo.MPOGraph" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Representation of an MPO by a graph, based on a ‘finite state machine’.</p>
<p>This representation is used for building H_MPO from the interactions.
The idea is to view the MPO as a kind of ‘finite state machine’.
The <strong>states</strong> or <strong>keys</strong> of this finite state machine life on the MPO bonds <em>between</em> the
<cite>Ws</cite>. They label the indices of the virtul bonds of the MPOs, i.e., the indices on legs
<code class="docutils literal notranslate"><span class="pre">wL</span></code> and <code class="docutils literal notranslate"><span class="pre">wR</span></code>. They can be anything hash-able like a <code class="docutils literal notranslate"><span class="pre">str</span></code>, <code class="docutils literal notranslate"><span class="pre">int</span></code> or a tuple of them.</p>
<p>The <strong>edges</strong> of the graph are the entries <code class="docutils literal notranslate"><span class="pre">W[keyL,</span> <span class="pre">keyR]</span></code>, which itself are onsite operators
on the local Hilbert space. The indices <cite>keyL</cite> and <cite>keyR</cite> correspond to the legs <code class="docutils literal notranslate"><span class="pre">'wL',</span> <span class="pre">'wR'</span></code>
of the MPO. The entry <code class="docutils literal notranslate"><span class="pre">W[keyL,</span> <span class="pre">keyR]</span></code> connects the state <code class="docutils literal notranslate"><span class="pre">keyL</span></code> on bond <code class="docutils literal notranslate"><span class="pre">(i-1,</span> <span class="pre">i)</span></code>
with the state <code class="docutils literal notranslate"><span class="pre">keyR</span></code> on bond <code class="docutils literal notranslate"><span class="pre">(i,</span> <span class="pre">i+1)</span></code>.</p>
<p>The keys <code class="docutils literal notranslate"><span class="pre">'IdR'</span></code> (for ‘idenity left’) and <code class="docutils literal notranslate"><span class="pre">'IdR'</span></code> (for ‘identity right’) are reserved to
represent only <code class="docutils literal notranslate"><span class="pre">'Id'</span></code> (=identity) operators to the left and right of the bond, respectively.</p>
<div class="admonition-todo admonition" id="index-0">
<p class="first admonition-title">Todo</p>
<p class="last">might be useful to add a “cleanup” function which removes operators cancelling each other
and/or unused states. Or better use a ‘compress’ of the MPO?</p>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>sites</strong> <span class="classifier-delimiter">:</span> <span class="classifier">list of <code class="xref py py-class docutils literal notranslate"><span class="pre">Site</span></code></span></dt>
<dd><p class="first last">Local sites of the Hilbert space.</p>
</dd>
<dt><strong>bc</strong> <span class="classifier-delimiter">:</span> <span class="classifier">{‘finite’, ‘infinite’}</span></dt>
<dd><p class="first last">MPO boundary conditions.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Attributes:</th><td class="field-body"><dl class="first last docutils">
<dt><a class="reference internal" href="#tenpy.networks.mpo.MPOGraph.L" title="tenpy.networks.mpo.MPOGraph.L"><code class="xref py py-obj docutils literal notranslate"><span class="pre">L</span></code></a></dt>
<dd><p class="first last">Number of physical sites.</p>
</dd>
<dt><strong>sites</strong> <span class="classifier-delimiter">:</span> <span class="classifier">list of <code class="xref py py-class docutils literal notranslate"><span class="pre">Site</span></code></span></dt>
<dd><p class="first last">Defines the local Hilbert space for each site.</p>
</dd>
<dt><strong>chinfo</strong> <span class="classifier-delimiter">:</span> <span class="classifier"><a class="reference internal" href="tenpy.linalg.np_conserved.html#tenpy.linalg.np_conserved.ChargeInfo" title="tenpy.linalg.np_conserved.ChargeInfo"><code class="xref py py-class docutils literal notranslate"><span class="pre">ChargeInfo</span></code></a></span></dt>
<dd><p class="first last">The nature of the charge.</p>
</dd>
<dt><strong>bc</strong> <span class="classifier-delimiter">:</span> <span class="classifier">{‘finite’, ‘infinite’}</span></dt>
<dd><p class="first last">MPO boundary conditions.</p>
</dd>
<dt><strong>states</strong> <span class="classifier-delimiter">:</span> <span class="classifier">list of set of keys</span></dt>
<dd><p class="first last"><code class="docutils literal notranslate"><span class="pre">states[i]</span></code> gives the possible keys at the virtual bond <code class="docutils literal notranslate"><span class="pre">(i-1,</span> <span class="pre">i)</span></code> of the MPO.</p>
</dd>
<dt><strong>graph</strong> <span class="classifier-delimiter">:</span> <span class="classifier">list of dict of dict of list of tuples</span></dt>
<dd><p class="first last">For each site <cite>i</cite> a dictionary <code class="docutils literal notranslate"><span class="pre">{keyL:</span> <span class="pre">{keyR:</span> <span class="pre">[(opname,</span> <span class="pre">strength)]}}</span></code> with
<code class="docutils literal notranslate"><span class="pre">keyL</span> <span class="pre">in</span> <span class="pre">vertices[i]</span></code> and <code class="docutils literal notranslate"><span class="pre">keyR</span> <span class="pre">in</span> <span class="pre">vertices[i+1]</span></code>.</p>
</dd>
<dt><strong>_grid_legs</strong> <span class="classifier-delimiter">:</span> <span class="classifier">None | list of LegCharge</span></dt>
<dd><p class="first last">The charges for the MPO</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#tenpy.networks.mpo.MPOGraph.add" title="tenpy.networks.mpo.MPOGraph.add"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add</span></code></a>(i,&nbsp;keyL,&nbsp;keyR,&nbsp;opname,&nbsp;strength[,&nbsp;check_op])</td>
<td>Insert an edge into the graph.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#tenpy.networks.mpo.MPOGraph.add_missing_IdL_IdR" title="tenpy.networks.mpo.MPOGraph.add_missing_IdL_IdR"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_missing_IdL_IdR</span></code></a>()</td>
<td>Add missing identity (‘Id’) edges connecting <code class="docutils literal notranslate"><span class="pre">'IdL'-&gt;'IdL'</span> <span class="pre">and</span> <span class="pre">``'IdR'-&gt;'IdR'</span></code>.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#tenpy.networks.mpo.MPOGraph.add_string" title="tenpy.networks.mpo.MPOGraph.add_string"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_string</span></code></a>(i,&nbsp;j,&nbsp;key[,&nbsp;opname,&nbsp;check_op])</td>
<td>Insert a bunch of edges for an ‘operator string’ into the graph.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#tenpy.networks.mpo.MPOGraph.build_MPO" title="tenpy.networks.mpo.MPOGraph.build_MPO"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_MPO</span></code></a>([Ws_qtotal,&nbsp;leg0])</td>
<td>Build the MPO represented by the graph (<cite>self</cite>).</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#tenpy.networks.mpo.MPOGraph.has_edge" title="tenpy.networks.mpo.MPOGraph.has_edge"><code class="xref py py-obj docutils literal notranslate"><span class="pre">has_edge</span></code></a>(i,&nbsp;keyL,&nbsp;keyR)</td>
<td>True if there is an edge from <cite>keyL</cite> on bond (i-1, i) to <cite>keyR</cite> on bond (i, i+1).</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#tenpy.networks.mpo.MPOGraph.test_sanity" title="tenpy.networks.mpo.MPOGraph.test_sanity"><code class="xref py py-obj docutils literal notranslate"><span class="pre">test_sanity</span></code></a>()</td>
<td>Sanity check.</td>
</tr>
</tbody>
</table>
<dl class="attribute">
<dt id="tenpy.networks.mpo.MPOGraph.L">
<code class="descname">L</code><a class="headerlink" href="#tenpy.networks.mpo.MPOGraph.L" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of physical sites. For an iMPS the length of the unit cell.</p>
</dd></dl>

<dl class="method">
<dt id="tenpy.networks.mpo.MPOGraph.add">
<code class="descname">add</code><span class="sig-paren">(</span><em>i</em>, <em>keyL</em>, <em>keyR</em>, <em>opname</em>, <em>strength</em>, <em>check_op=True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tenpy/networks/mpo.html#MPOGraph.add"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tenpy.networks.mpo.MPOGraph.add" title="Permalink to this definition">¶</a></dt>
<dd><p>Insert an edge into the graph.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>i</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int</span></dt>
<dd><p class="first last">Site index at which the edge of the graph is to be inserted.</p>
</dd>
<dt><strong>keyL</strong> <span class="classifier-delimiter">:</span> <span class="classifier">hashable</span></dt>
<dd><p class="first last">The state at bond (i-1, i) to connect from.</p>
</dd>
<dt><strong>keyR</strong> <span class="classifier-delimiter">:</span> <span class="classifier">hashable</span></dt>
<dd><p class="first last">The state at bond (i, i+1) to connect to.</p>
</dd>
<dt><strong>opname</strong> <span class="classifier-delimiter">:</span> <span class="classifier">str</span></dt>
<dd><p class="first last">Name of the operator.</p>
</dd>
<dt><strong>strength</strong> <span class="classifier-delimiter">:</span> <span class="classifier">str</span></dt>
<dd><p class="first last">Prefactor of the operator to be inserted.</p>
</dd>
<dt><strong>check_op</strong> <span class="classifier-delimiter">:</span> <span class="classifier">bool</span></dt>
<dd><p class="first last">Wheter to check that ‘opname’ exists on the given <cite>site</cite>.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="tenpy.networks.mpo.MPOGraph.add_missing_IdL_IdR">
<code class="descname">add_missing_IdL_IdR</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tenpy/networks/mpo.html#MPOGraph.add_missing_IdL_IdR"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tenpy.networks.mpo.MPOGraph.add_missing_IdL_IdR" title="Permalink to this definition">¶</a></dt>
<dd><p>Add missing identity (‘Id’) edges connecting <code class="docutils literal notranslate"><span class="pre">'IdL'-&gt;'IdL'</span> <span class="pre">and</span> <span class="pre">``'IdR'-&gt;'IdR'</span></code>.</p>
<p>For <code class="docutils literal notranslate"><span class="pre">bc='infinite'</span></code>, insert missing identities at <em>all</em> bonds.
For <code class="docutils literal notranslate"><span class="pre">bc='finite'</span> <span class="pre">|</span> <span class="pre">'segment'</span></code> only insert
<code class="docutils literal notranslate"><span class="pre">'IdL'-&gt;'IdL'</span></code> to the left of the rightmost existing ‘IdL’ and
<code class="docutils literal notranslate"><span class="pre">'IdR'-&gt;'IdR'</span></code> to the right of the leftmost existing ‘IdR’.</p>
<p>This function should be called <em>after</em> all other operators have been inserted.</p>
</dd></dl>

<dl class="method">
<dt id="tenpy.networks.mpo.MPOGraph.add_string">
<code class="descname">add_string</code><span class="sig-paren">(</span><em>i</em>, <em>j</em>, <em>key</em>, <em>opname='Id'</em>, <em>check_op=True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tenpy/networks/mpo.html#MPOGraph.add_string"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tenpy.networks.mpo.MPOGraph.add_string" title="Permalink to this definition">¶</a></dt>
<dd><p>Insert a bunch of edges for an ‘operator string’ into the graph.</p>
<p>Terms like <span class="math notranslate nohighlight">\(S^z_i S^z_j\)</span> actually stand for
<span class="math notranslate nohighlight">\(S^z_i \otimes \prod_{i &lt; k &lt; j} \mathbb{1}_k \otimes S^z_j\)</span>.
This function adds the <span class="math notranslate nohighlight">\(\mathbb{1}\)</span> terms to the graph.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>i, j: int</strong></dt>
<dd><p class="first last">An edge is inserted on all bonds between <cite>i</cite> and <cite>j</cite>, <cite>i &lt; j</cite>.
<cite>j</cite> can be larger than <a class="reference internal" href="#tenpy.networks.mpo.MPOGraph.L" title="tenpy.networks.mpo.MPOGraph.L"><code class="xref py py-attr docutils literal notranslate"><span class="pre">L</span></code></a>, in which case the operators are supposed to act on
different MPS unit cells.</p>
</dd>
<dt><strong>key: hashable</strong></dt>
<dd><p class="first last">The state at bond (i-1, i) to connect from and on bond (j-1, j) to connect to.
Also used for the intermediate states.
No operator is inserted on a site <cite>i &lt; k &lt; j</cite> if <code class="docutils literal notranslate"><span class="pre">has_edge(k,</span> <span class="pre">key,</span> <span class="pre">key)</span></code>.</p>
</dd>
<dt><strong>opname</strong> <span class="classifier-delimiter">:</span> <span class="classifier">str</span></dt>
<dd><p class="first last">Name of the operator to be used for the string.
Useful for the Jordan-Wigner transformation to fermions.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>label_j</strong> <span class="classifier-delimiter">:</span> <span class="classifier">hashable</span></dt>
<dd><p class="first last">The <cite>key</cite> on the left of site j to connect to. Usually the same as the parameter <cite>key</cite>,
except if <code class="docutils literal notranslate"><span class="pre">j</span> <span class="pre">-</span> <span class="pre">i</span> <span class="pre">&gt;</span> <span class="pre">self.L</span></code>, in which case we use the additional labels <code class="docutils literal notranslate"><span class="pre">(key,</span> <span class="pre">1)</span></code>,
<code class="docutils literal notranslate"><span class="pre">(key,</span> <span class="pre">2)</span></code>, … to generate couplings over multiple unit cells.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="tenpy.networks.mpo.MPOGraph.build_MPO">
<code class="descname">build_MPO</code><span class="sig-paren">(</span><em>Ws_qtotal=None</em>, <em>leg0=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tenpy/networks/mpo.html#MPOGraph.build_MPO"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tenpy.networks.mpo.MPOGraph.build_MPO" title="Permalink to this definition">¶</a></dt>
<dd><p>Build the MPO represented by the graph (<cite>self</cite>).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>Ws_qtotal</strong> <span class="classifier-delimiter">:</span> <span class="classifier">None | (list of) charges</span></dt>
<dd><p class="first last">The <cite>qtotal</cite> for each of the Ws to be generated., default (<code class="docutils literal notranslate"><span class="pre">None</span></code>) means 0 charge.
A single qtotal holds for each site.</p>
</dd>
<dt><strong>leg0</strong> <span class="classifier-delimiter">:</span> <span class="classifier">None | <code class="xref py py-class docutils literal notranslate"><span class="pre">npc.LegCharge</span></code></span></dt>
<dd><p class="first last">The charges to be used for the very first leg (which is a gauge freedom).
If <code class="docutils literal notranslate"><span class="pre">None</span></code> (default), use zeros.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>mpo</strong> <span class="classifier-delimiter">:</span> <span class="classifier"><a class="reference internal" href="#tenpy.networks.mpo.MPO" title="tenpy.networks.mpo.MPO"><code class="xref py py-class docutils literal notranslate"><span class="pre">MPO</span></code></a></span></dt>
<dd><p class="first last">the MPO which self represents.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="tenpy.networks.mpo.MPOGraph.has_edge">
<code class="descname">has_edge</code><span class="sig-paren">(</span><em>i</em>, <em>keyL</em>, <em>keyR</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tenpy/networks/mpo.html#MPOGraph.has_edge"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tenpy.networks.mpo.MPOGraph.has_edge" title="Permalink to this definition">¶</a></dt>
<dd><p>True if there is an edge from <cite>keyL</cite> on bond (i-1, i) to <cite>keyR</cite> on bond (i, i+1).</p>
</dd></dl>

<dl class="method">
<dt id="tenpy.networks.mpo.MPOGraph.test_sanity">
<code class="descname">test_sanity</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tenpy/networks/mpo.html#MPOGraph.test_sanity"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tenpy.networks.mpo.MPOGraph.test_sanity" title="Permalink to this definition">¶</a></dt>
<dd><p>Sanity check. Raises ValueErrors, if something is wrong.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="tenpy.networks.mpo.MPOEnvironment">
<em class="property">class </em><code class="descclassname">tenpy.networks.mpo.</code><code class="descname">MPOEnvironment</code><span class="sig-paren">(</span><em>bra</em>, <em>H</em>, <em>ket</em>, <em>firstLP=None</em>, <em>lastRP=None</em>, <em>age_LP=0</em>, <em>age_RP=0</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tenpy/networks/mpo.html#MPOEnvironment"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tenpy.networks.mpo.MPOEnvironment" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="tenpy.networks.mps.html#tenpy.networks.mps.MPSEnvironment" title="tenpy.networks.mps.MPSEnvironment"><code class="xref py py-class docutils literal notranslate"><span class="pre">tenpy.networks.mps.MPSEnvironment</span></code></a></p>
<p>Stores partial contractions of <span class="math notranslate nohighlight">\(&lt;bra|H|ket&gt;\)</span> for an MPO <cite>H</cite>.</p>
<p>The network for a contraction <span class="math notranslate nohighlight">\(&lt;bra|H|ket&gt;\)</span> of an MPO <cite>H</cite> bewteen two MPS looks like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">|</span>     <span class="o">.------&gt;-</span><span class="n">M</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">--&gt;-</span><span class="n">M</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">--&gt;-</span><span class="n">M</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">--&gt;-</span> <span class="o">...</span>  <span class="o">-&gt;--.</span>
<span class="o">|</span>     <span class="o">|</span>        <span class="o">|</span>       <span class="o">|</span>       <span class="o">|</span>                 <span class="o">|</span>
<span class="o">|</span>     <span class="o">|</span>        <span class="o">^</span>       <span class="o">^</span>       <span class="o">^</span>                 <span class="o">|</span>
<span class="o">|</span>     <span class="o">|</span>        <span class="o">|</span>       <span class="o">|</span>       <span class="o">|</span>                 <span class="o">|</span>
<span class="o">|</span>     <span class="n">LP</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-&gt;-</span><span class="n">W</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">--&gt;-</span><span class="n">W</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">--&gt;-</span><span class="n">W</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">--&gt;-</span> <span class="o">...</span>  <span class="o">-&gt;-</span> <span class="n">RP</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="o">|</span>     <span class="o">|</span>        <span class="o">|</span>       <span class="o">|</span>       <span class="o">|</span>                 <span class="o">|</span>
<span class="o">|</span>     <span class="o">|</span>        <span class="o">^</span>       <span class="o">^</span>       <span class="o">^</span>                 <span class="o">|</span>
<span class="o">|</span>     <span class="o">|</span>        <span class="o">|</span>       <span class="o">|</span>       <span class="o">|</span>                 <span class="o">|</span>
<span class="o">|</span>     <span class="o">.------&lt;-</span><span class="n">N</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*-&lt;-</span><span class="n">N</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*-&lt;-</span><span class="n">N</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*-&lt;-</span> <span class="o">...</span>  <span class="o">-&lt;--.</span>
</pre></div>
</div>
<p>We use the following label convention (where arrows indicate <cite>qconj</cite>):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">|</span>    <span class="o">.--&gt;-</span> <span class="n">vR</span>           <span class="n">vL</span> <span class="o">-&gt;-.</span>
<span class="o">|</span>    <span class="o">|</span>                        <span class="o">|</span>
<span class="o">|</span>    <span class="n">LP</span><span class="o">-&gt;-</span> <span class="n">wR</span>           <span class="n">wL</span> <span class="o">-&gt;-</span><span class="n">RP</span>
<span class="o">|</span>    <span class="o">|</span>                        <span class="o">|</span>
<span class="o">|</span>    <span class="o">.--&lt;-</span> <span class="n">vR</span><span class="o">*</span>         <span class="n">vL</span><span class="o">*</span> <span class="o">-&lt;-.</span>
</pre></div>
</div>
<p>To avoid recalculations of the whole network e.g. in the DMRG sweeps,
we store the contractions up to some site index in this class.
For <code class="docutils literal notranslate"><span class="pre">bc='finite','segment'</span></code>, the very left and right part <code class="docutils literal notranslate"><span class="pre">LP[0]</span></code> and
<code class="docutils literal notranslate"><span class="pre">RP[-1]</span></code> are trivial and don’t change in the DMRG algorithm,
but for iDMRG (<code class="docutils literal notranslate"><span class="pre">bc='infinite'</span></code>) they are also updated
(by inserting another unit cell to the left/right).</p>
<p>The MPS <cite>bra</cite> and <cite>ket</cite> have to be in canonical form.
All the environments are constructed without the singular values on the open bond.
In other words, we contract left-canonical <cite>A</cite> to the left parts <cite>LP</cite>
and right-canonical <cite>B</cite> to the right parts <cite>RP</cite>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>bra</strong> <span class="classifier-delimiter">:</span> <span class="classifier"><a class="reference internal" href="tenpy.networks.mps.html#tenpy.networks.mps.MPS" title="tenpy.networks.mps.MPS"><code class="xref py py-class docutils literal notranslate"><span class="pre">MPS</span></code></a></span></dt>
<dd><p class="first last">The MPS to project on. Should be given in usual ‘ket’ form;
we call <cite>conj()</cite> on the matrices directly.</p>
</dd>
<dt><strong>H</strong> <span class="classifier-delimiter">:</span> <span class="classifier"><a class="reference internal" href="#tenpy.networks.mpo.MPO" title="tenpy.networks.mpo.MPO"><code class="xref py py-class docutils literal notranslate"><span class="pre">MPO</span></code></a></span></dt>
<dd><p class="first last">The MPO sandwiched between <cite>bra</cite> and <cite>ket</cite>.
Should have ‘IdL’ and ‘IdR’ set on the first and last bond.</p>
</dd>
<dt><strong>ket</strong> <span class="classifier-delimiter">:</span> <span class="classifier"><code class="xref py py-class docutils literal notranslate"><span class="pre">MPS</span></code></span></dt>
<dd><p class="first last">The MPS on which <cite>H</cite> acts. May be identical with <cite>bra</cite>.</p>
</dd>
<dt><strong>firstLP</strong> <span class="classifier-delimiter">:</span> <span class="classifier"><code class="docutils literal notranslate"><span class="pre">None</span></code> | <a class="reference internal" href="tenpy.linalg.np_conserved.html#tenpy.linalg.np_conserved.Array" title="tenpy.linalg.np_conserved.Array"><code class="xref py py-class docutils literal notranslate"><span class="pre">Array</span></code></a></span></dt>
<dd><p class="first last">Initial very left part. If <code class="docutils literal notranslate"><span class="pre">None</span></code>, build trivial one.</p>
</dd>
<dt><strong>rightRP</strong> <span class="classifier-delimiter">:</span> <span class="classifier"><code class="docutils literal notranslate"><span class="pre">None</span></code> | <a class="reference internal" href="tenpy.linalg.np_conserved.html#tenpy.linalg.np_conserved.Array" title="tenpy.linalg.np_conserved.Array"><code class="xref py py-class docutils literal notranslate"><span class="pre">Array</span></code></a></span></dt>
<dd><p class="first last">Initial very right part. If <code class="docutils literal notranslate"><span class="pre">None</span></code>, build trivial one.</p>
</dd>
<dt><strong>age_LP</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int</span></dt>
<dd><p class="first last">The number of physical sites involved into the contraction yielding <cite>firstLP</cite>.</p>
</dd>
<dt><strong>age_RP</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int</span></dt>
<dd><p class="first last">The number of physical sites involved into the contraction yielding <cite>lastRP</cite>.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Attributes:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>H</strong> <span class="classifier-delimiter">:</span> <span class="classifier"><a class="reference internal" href="#tenpy.networks.mpo.MPO" title="tenpy.networks.mpo.MPO"><code class="xref py py-class docutils literal notranslate"><span class="pre">MPO</span></code></a></span></dt>
<dd><p class="first last">The MPO sandwiched between <cite>bra</cite> and <cite>ket</cite>.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#tenpy.networks.mpo.MPOEnvironment.del_LP" title="tenpy.networks.mpo.MPOEnvironment.del_LP"><code class="xref py py-obj docutils literal notranslate"><span class="pre">del_LP</span></code></a>(i)</td>
<td>Delete stored part strictly to the left of site <cite>i</cite>.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#tenpy.networks.mpo.MPOEnvironment.del_RP" title="tenpy.networks.mpo.MPOEnvironment.del_RP"><code class="xref py py-obj docutils literal notranslate"><span class="pre">del_RP</span></code></a>(i)</td>
<td>Delete storde part scrictly to the right of site <cite>i</cite>.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#tenpy.networks.mpo.MPOEnvironment.expectation_value" title="tenpy.networks.mpo.MPOEnvironment.expectation_value"><code class="xref py py-obj docutils literal notranslate"><span class="pre">expectation_value</span></code></a>(ops[,&nbsp;sites,&nbsp;axes])</td>
<td>Expectation value <code class="docutils literal notranslate"><span class="pre">&lt;bra|ops|ket&gt;</span></code> of (n-site) operator(s).</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#tenpy.networks.mpo.MPOEnvironment.full_contraction" title="tenpy.networks.mpo.MPOEnvironment.full_contraction"><code class="xref py py-obj docutils literal notranslate"><span class="pre">full_contraction</span></code></a>(i0)</td>
<td>Calculate the energy by a full contraction of the network.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#tenpy.networks.mpo.MPOEnvironment.get_LP" title="tenpy.networks.mpo.MPOEnvironment.get_LP"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_LP</span></code></a>(i[,&nbsp;store])</td>
<td>Calculate LP at given site from nearest available one (including <cite>i</cite>).</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#tenpy.networks.mpo.MPOEnvironment.get_LP_age" title="tenpy.networks.mpo.MPOEnvironment.get_LP_age"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_LP_age</span></code></a>(i)</td>
<td>Return number of physical sites in the contractions of get_LP(i).</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#tenpy.networks.mpo.MPOEnvironment.get_RP" title="tenpy.networks.mpo.MPOEnvironment.get_RP"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_RP</span></code></a>(i[,&nbsp;store])</td>
<td>Calculate RP at given site from nearest available one (including <cite>i</cite>).</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#tenpy.networks.mpo.MPOEnvironment.get_RP_age" title="tenpy.networks.mpo.MPOEnvironment.get_RP_age"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_RP_age</span></code></a>(i)</td>
<td>Return number of physical sites in the contractions of get_LP(i).</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#tenpy.networks.mpo.MPOEnvironment.set_LP" title="tenpy.networks.mpo.MPOEnvironment.set_LP"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_LP</span></code></a>(i,&nbsp;LP,&nbsp;age)</td>
<td>Store part to the left of site <cite>i</cite>.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#tenpy.networks.mpo.MPOEnvironment.set_RP" title="tenpy.networks.mpo.MPOEnvironment.set_RP"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_RP</span></code></a>(i,&nbsp;RP,&nbsp;age)</td>
<td>Store part to the right of site 1i1.</td>
</tr>
</tbody>
</table>
<table border="1" class="docutils">
<colgroup>
<col width="60%" />
<col width="40%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><strong>test_sanity</strong></td>
<td>&#160;</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="tenpy.networks.mpo.MPOEnvironment.del_LP">
<code class="descname">del_LP</code><span class="sig-paren">(</span><em>i</em><span class="sig-paren">)</span><a class="headerlink" href="#tenpy.networks.mpo.MPOEnvironment.del_LP" title="Permalink to this definition">¶</a></dt>
<dd><p>Delete stored part strictly to the left of site <cite>i</cite>.</p>
</dd></dl>

<dl class="method">
<dt id="tenpy.networks.mpo.MPOEnvironment.del_RP">
<code class="descname">del_RP</code><span class="sig-paren">(</span><em>i</em><span class="sig-paren">)</span><a class="headerlink" href="#tenpy.networks.mpo.MPOEnvironment.del_RP" title="Permalink to this definition">¶</a></dt>
<dd><p>Delete storde part scrictly to the right of site <cite>i</cite>.</p>
</dd></dl>

<dl class="method">
<dt id="tenpy.networks.mpo.MPOEnvironment.expectation_value">
<code class="descname">expectation_value</code><span class="sig-paren">(</span><em>ops</em>, <em>sites=None</em>, <em>axes=None</em><span class="sig-paren">)</span><a class="headerlink" href="#tenpy.networks.mpo.MPOEnvironment.expectation_value" title="Permalink to this definition">¶</a></dt>
<dd><p>Expectation value <code class="docutils literal notranslate"><span class="pre">&lt;bra|ops|ket&gt;</span></code> of (n-site) operator(s).</p>
<p>Calculates n-site expectation values of operators sandwiched between bra and ket.
For examples the contraction for a two-site operator on site <cite>i</cite> would look like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">|</span>          <span class="o">.--</span><span class="n">S</span><span class="o">--</span><span class="n">B</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">--</span><span class="n">B</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">--.</span>
<span class="o">|</span>          <span class="o">|</span>     <span class="o">|</span>     <span class="o">|</span>       <span class="o">|</span>
<span class="o">|</span>          <span class="o">|</span>     <span class="o">|-----|</span>       <span class="o">|</span>
<span class="o">|</span>          <span class="n">LP</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">|</span> <span class="n">op</span>  <span class="o">|</span>       <span class="n">RP</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
<span class="o">|</span>          <span class="o">|</span>     <span class="o">|-----|</span>       <span class="o">|</span>
<span class="o">|</span>          <span class="o">|</span>     <span class="o">|</span>     <span class="o">|</span>       <span class="o">|</span>
<span class="o">|</span>          <span class="o">.--</span><span class="n">S</span><span class="o">--</span><span class="n">B</span><span class="o">*</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-</span><span class="n">B</span><span class="o">*</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">-.</span>
</pre></div>
</div>
<p>Here, the <cite>B</cite> are taken from <cite>ket</cite>, the <cite>B*</cite> from <cite>bra</cite>.
The call structure is the same as for <code class="xref py py-meth docutils literal notranslate"><span class="pre">MPS.expectation_value()</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>ops</strong> <span class="classifier-delimiter">:</span> <span class="classifier">(list of) { <a class="reference internal" href="tenpy.linalg.np_conserved.html#tenpy.linalg.np_conserved.Array" title="tenpy.linalg.np_conserved.Array"><code class="xref py py-class docutils literal notranslate"><span class="pre">Array</span></code></a> | str }</span></dt>
<dd><p class="first last">The operators, for wich the expectation value should be taken,
All operators should all have the same number of legs (namely <cite>2 n</cite>).
If less than <code class="docutils literal notranslate"><span class="pre">len(sites)</span></code> operators are given, we repeat them periodically.
Strings (like <code class="docutils literal notranslate"><span class="pre">'Id',</span> <span class="pre">'Sz'</span></code>) are translated into single-site operators defined by
<code class="xref py py-attr docutils literal notranslate"><span class="pre">sites</span></code>.</p>
</dd>
<dt><strong>sites</strong> <span class="classifier-delimiter">:</span> <span class="classifier">list</span></dt>
<dd><p class="first last">List of site indices. Expectation values are evaluated there.
If <code class="docutils literal notranslate"><span class="pre">None</span></code> (default), the entire chain is taken (clipping for finite b.c.)</p>
</dd>
<dt><strong>axes</strong> <span class="classifier-delimiter">:</span> <span class="classifier">None | (list of str, list of str)</span></dt>
<dd><p class="first last">Two lists of each <cite>n</cite> leg labels giving the physical legs of the operator used for
contraction. The first <cite>n</cite> legs are contracted with conjugated <cite>B</cite>,
the second <cite>n</cite> legs with the non-conjugated <cite>B</cite>.
<code class="docutils literal notranslate"><span class="pre">None</span></code> defaults to <code class="docutils literal notranslate"><span class="pre">(['p'],</span> <span class="pre">['p*'])</span></code> for single site (n=1), or
<code class="docutils literal notranslate"><span class="pre">(['p0',</span> <span class="pre">'p1',</span> <span class="pre">...</span> <span class="pre">'p{n-1}'],</span> <span class="pre">['p0*',</span> <span class="pre">'p1*',</span> <span class="pre">....</span> <span class="pre">'p{n-1}*'])</span></code> for <cite>n</cite> &gt; 1.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>exp_vals</strong> <span class="classifier-delimiter">:</span> <span class="classifier">1D ndarray</span></dt>
<dd><p class="first last">Expectation values, <code class="docutils literal notranslate"><span class="pre">exp_vals[i]</span> <span class="pre">=</span> <span class="pre">&lt;bra|ops[i]|ket&gt;</span></code>, where <code class="docutils literal notranslate"><span class="pre">ops[i]</span></code> acts on
site(s) <code class="docutils literal notranslate"><span class="pre">j,</span> <span class="pre">j+1,</span> <span class="pre">...,</span> <span class="pre">j+{n-1}</span></code> with <code class="docutils literal notranslate"><span class="pre">j=sites[i]</span></code>.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<p>One site examples (n=1):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">env</span><span class="o">.</span><span class="n">expectation_value</span><span class="p">(</span><span class="s1">&#39;Sz&#39;</span><span class="p">)</span>
<span class="go">[Sz0, Sz1, ..., Sz{L-1}]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">env</span><span class="o">.</span><span class="n">expectation_value</span><span class="p">([</span><span class="s1">&#39;Sz&#39;</span><span class="p">,</span> <span class="s1">&#39;Sx&#39;</span><span class="p">])</span>
<span class="go">[Sz0, Sx1, Sz2, Sx3, ... ]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">env</span><span class="o">.</span><span class="n">expectation_value</span><span class="p">(</span><span class="s1">&#39;Sz&#39;</span><span class="p">,</span> <span class="n">sites</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
<span class="go">[Sz0, Sz3, Sz4]</span>
</pre></div>
</div>
<p>Two site example (n=2), assuming homogeneous sites:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">SzSx</span> <span class="o">=</span> <span class="n">npc</span><span class="o">.</span><span class="n">outer</span><span class="p">(</span><span class="n">psi</span><span class="o">.</span><span class="n">sites</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Sz</span><span class="o">.</span><span class="n">replace_labels</span><span class="p">([</span><span class="s1">&#39;p&#39;</span><span class="p">,</span> <span class="s1">&#39;p*&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;p0&#39;</span><span class="p">,</span> <span class="s1">&#39;p0*&#39;</span><span class="p">]),</span>
<span class="go">                     psi.sites[1].Sx.replace_labels([&#39;p&#39;, &#39;p*&#39;], [&#39;p1&#39;, &#39;p1*&#39;]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">env</span><span class="o">.</span><span class="n">expectation_value</span><span class="p">(</span><span class="n">SzSx</span><span class="p">)</span>
<span class="go">[Sz0Sx1, Sz1Sx2, Sz2Sx3, ... ]   # with len L-1 for finite bc, or L for infinite</span>
</pre></div>
</div>
<p>Example measuring &lt;bra|SzSx|ket&gt; on each second site, for inhomogeneous sites:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">SzSx_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">npc</span><span class="o">.</span><span class="n">outer</span><span class="p">(</span><span class="n">psi</span><span class="o">.</span><span class="n">sites</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">Sz</span><span class="o">.</span><span class="n">replace_labels</span><span class="p">([</span><span class="s1">&#39;p&#39;</span><span class="p">,</span> <span class="s1">&#39;p*&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;p0&#39;</span><span class="p">,</span> <span class="s1">&#39;p0*&#39;</span><span class="p">]),</span>
<span class="go">                           psi.sites[i+1].Sx.replace_labels([&#39;p&#39;, &#39;p*&#39;], [&#39;p1&#39;, &#39;p1*&#39;]))</span>
<span class="go">                 for i in range(0, psi.L-1, 2)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">env</span><span class="o">.</span><span class="n">expectation_value</span><span class="p">(</span><span class="n">SzSx_list</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">psi</span><span class="o">.</span><span class="n">L</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="go">[Sz0Sx1, Sz2Sx3, Sz4Sx5, ...]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="tenpy.networks.mpo.MPOEnvironment.full_contraction">
<code class="descname">full_contraction</code><span class="sig-paren">(</span><em>i0</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tenpy/networks/mpo.html#MPOEnvironment.full_contraction"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tenpy.networks.mpo.MPOEnvironment.full_contraction" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the energy by a full contraction of the network.</p>
<p>The full contraction of the environments gives the value
<code class="docutils literal notranslate"><span class="pre">&lt;bra|H|ket&gt;</span> <span class="pre">/</span> <span class="pre">(norm(|bra&gt;)*norm(|ket&gt;))</span></code>,
i.e. if <cite>bra</cite> is <cite>ket</cite> and normalized, the total energy.
For this purpose, this function contracts
<code class="docutils literal notranslate"><span class="pre">get_LP(i0+1,</span> <span class="pre">store=False)</span></code> and <code class="docutils literal notranslate"><span class="pre">get_RP(i0,</span> <span class="pre">store=False)</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>i0</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int</span></dt>
<dd><p class="first last">Site index.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="tenpy.networks.mpo.MPOEnvironment.get_LP">
<code class="descname">get_LP</code><span class="sig-paren">(</span><em>i</em>, <em>store=True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tenpy/networks/mpo.html#MPOEnvironment.get_LP"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tenpy.networks.mpo.MPOEnvironment.get_LP" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate LP at given site from nearest available one (including <cite>i</cite>).</p>
<p>The returned <code class="docutils literal notranslate"><span class="pre">LP_i</span></code> corresponds to the following contraction,
where the M’s and the N’s are in the ‘A’ form:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">|</span>     <span class="o">.-------</span><span class="n">M</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">---</span> <span class="o">...</span> <span class="o">--</span><span class="n">M</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">---&gt;-</span>   <span class="s1">&#39;vR&#39;</span>
<span class="o">|</span>     <span class="o">|</span>       <span class="o">|</span>             <span class="o">|</span>
<span class="o">|</span>     <span class="n">LP</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">---</span><span class="n">W</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">---</span> <span class="o">...</span> <span class="o">--</span><span class="n">W</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">---&gt;-</span>   <span class="s1">&#39;wR&#39;</span>
<span class="o">|</span>     <span class="o">|</span>       <span class="o">|</span>             <span class="o">|</span>
<span class="o">|</span>     <span class="o">.-------</span><span class="n">N</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*--</span> <span class="o">...</span> <span class="o">--</span><span class="n">N</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">*--&lt;-</span>   <span class="s1">&#39;vR*&#39;</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>i</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int</span></dt>
<dd><p class="first last">The returned <cite>LP</cite> will contain the contraction <em>strictly</em> left of site <cite>i</cite>.</p>
</dd>
<dt><strong>store</strong> <span class="classifier-delimiter">:</span> <span class="classifier">bool</span></dt>
<dd><p class="first last">Wheter to store the calculated <cite>LP</cite> in <cite>self</cite> (<code class="docutils literal notranslate"><span class="pre">True</span></code>) or discard them (<code class="docutils literal notranslate"><span class="pre">False</span></code>).</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>LP_i</strong> <span class="classifier-delimiter">:</span> <span class="classifier"><a class="reference internal" href="tenpy.linalg.np_conserved.html#tenpy.linalg.np_conserved.Array" title="tenpy.linalg.np_conserved.Array"><code class="xref py py-class docutils literal notranslate"><span class="pre">Array</span></code></a></span></dt>
<dd><p class="first last">Contraction of everything left of site <cite>i</cite>,
with labels <code class="docutils literal notranslate"><span class="pre">'vR*',</span> <span class="pre">'wR',</span> <span class="pre">'vR'</span></code> for <cite>bra</cite>, <cite>H</cite>, <cite>ket</cite>.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="tenpy.networks.mpo.MPOEnvironment.get_LP_age">
<code class="descname">get_LP_age</code><span class="sig-paren">(</span><em>i</em><span class="sig-paren">)</span><a class="headerlink" href="#tenpy.networks.mpo.MPOEnvironment.get_LP_age" title="Permalink to this definition">¶</a></dt>
<dd><p>Return number of physical sites in the contractions of get_LP(i). Might be <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p>
</dd></dl>

<dl class="method">
<dt id="tenpy.networks.mpo.MPOEnvironment.get_RP">
<code class="descname">get_RP</code><span class="sig-paren">(</span><em>i</em>, <em>store=True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tenpy/networks/mpo.html#MPOEnvironment.get_RP"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tenpy.networks.mpo.MPOEnvironment.get_RP" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate RP at given site from nearest available one (including <cite>i</cite>).</p>
<blockquote>
<div><p>The returned <code class="docutils literal notranslate"><span class="pre">RP_i</span></code> corresponds to the following contraction,
where the M’s and the N’s are in the ‘B’ form:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">|</span>     <span class="s1">&#39;vL&#39;</span>  <span class="o">-&gt;---</span><span class="n">M</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">--</span> <span class="o">...</span> <span class="o">--</span><span class="n">M</span><span class="p">[</span><span class="n">L</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">----.</span>
<span class="o">|</span>                <span class="o">|</span>              <span class="o">|</span>         <span class="o">|</span>
<span class="o">|</span>     <span class="s1">&#39;wL&#39;</span>  <span class="o">-&gt;---</span><span class="n">W</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">--</span> <span class="o">...</span> <span class="o">--</span><span class="n">W</span><span class="p">[</span><span class="n">L</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">----</span><span class="n">RP</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="o">|</span>                <span class="o">|</span>              <span class="o">|</span>         <span class="o">|</span>
<span class="o">|</span>     <span class="s1">&#39;vL*&#39;</span> <span class="o">-&lt;---</span><span class="n">N</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">*-</span> <span class="o">...</span> <span class="o">--</span><span class="n">N</span><span class="p">[</span><span class="n">L</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">*---.</span>
</pre></div>
</div>
</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>i</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int</span></dt>
<dd><blockquote class="first">
<div><p>The returned <cite>RP</cite> will contain the contraction <em>strictly</em> rigth of site <cite>i</cite>.</p>
</div></blockquote>
<dl class="last docutils">
<dt>store <span class="classifier-delimiter">:</span> <span class="classifier">bool</span></dt>
<dd><p class="first last">Wheter to store the calculated <cite>RP</cite> in <cite>self</cite> (<code class="docutils literal notranslate"><span class="pre">True</span></code>) or discard them (<code class="docutils literal notranslate"><span class="pre">False</span></code>).</p>
</dd>
</dl>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>RP_i</strong> <span class="classifier-delimiter">:</span> <span class="classifier"><a class="reference internal" href="tenpy.linalg.np_conserved.html#tenpy.linalg.np_conserved.Array" title="tenpy.linalg.np_conserved.Array"><code class="xref py py-class docutils literal notranslate"><span class="pre">Array</span></code></a></span></dt>
<dd><p class="first last">Contraction of everything right of site <cite>i</cite>,
with labels <code class="docutils literal notranslate"><span class="pre">'vL*',</span> <span class="pre">'wL',</span> <span class="pre">'vL'</span></code> for <cite>bra</cite>, <cite>H</cite>, <cite>ket</cite>.
It looks like</p>
</dd>
<dt><strong>RP_i =     –M[i+1]–  …  —&gt;M[i-2]–&gt;.</strong></dt>
<dd><blockquote class="first">
<div><blockquote>
<div><div class="line-block">
<div class="line">|      |</div>
</div>
</div></blockquote>
<dl class="docutils">
<dt>–&gt;W[i+1]—&gt;  …  —&gt;W[i-2]–&gt;RP[-1]</dt>
<dd><div class="first line-block">
<div class="line">|      |</div>
</div>
<p class="last">^                     ^      |
|                     |      |</p>
</dd>
</dl>
<p>–&gt;N[i+1]*–&gt;  … –&gt;N[i-2]*–&gt;.</p>
</div></blockquote>
<p class="last">where the M’s and the N’s are in the ‘B’ form</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="tenpy.networks.mpo.MPOEnvironment.get_RP_age">
<code class="descname">get_RP_age</code><span class="sig-paren">(</span><em>i</em><span class="sig-paren">)</span><a class="headerlink" href="#tenpy.networks.mpo.MPOEnvironment.get_RP_age" title="Permalink to this definition">¶</a></dt>
<dd><p>Return number of physical sites in the contractions of get_LP(i). Might be <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p>
</dd></dl>

<dl class="method">
<dt id="tenpy.networks.mpo.MPOEnvironment.set_LP">
<code class="descname">set_LP</code><span class="sig-paren">(</span><em>i</em>, <em>LP</em>, <em>age</em><span class="sig-paren">)</span><a class="headerlink" href="#tenpy.networks.mpo.MPOEnvironment.set_LP" title="Permalink to this definition">¶</a></dt>
<dd><p>Store part to the left of site <cite>i</cite>.</p>
</dd></dl>

<dl class="method">
<dt id="tenpy.networks.mpo.MPOEnvironment.set_RP">
<code class="descname">set_RP</code><span class="sig-paren">(</span><em>i</em>, <em>RP</em>, <em>age</em><span class="sig-paren">)</span><a class="headerlink" href="#tenpy.networks.mpo.MPOEnvironment.set_RP" title="Permalink to this definition">¶</a></dt>
<dd><p>Store part to the right of site 1i1.</p>
</dd></dl>

<dl class="method">
<dt id="tenpy.networks.mpo.MPOEnvironment.test_sanity">
<code class="descname">test_sanity</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tenpy/networks/mpo.html#MPOEnvironment.test_sanity"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tenpy.networks.mpo.MPOEnvironment.test_sanity" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="function">
<dt id="tenpy.networks.mpo.grid_insert_ops">
<code class="descclassname">tenpy.networks.mpo.</code><code class="descname">grid_insert_ops</code><span class="sig-paren">(</span><em>site</em>, <em>grid</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tenpy/networks/mpo.html#grid_insert_ops"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tenpy.networks.mpo.grid_insert_ops" title="Permalink to this definition">¶</a></dt>
<dd><p>Replaces entries representing operators in a grid of <code class="docutils literal notranslate"><span class="pre">W[i]</span></code> with npc.Arrays.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>site</strong> <span class="classifier-delimiter">:</span> <span class="classifier"><a class="reference internal" href="tenpy.networks.site.html#module-tenpy.networks.site" title="tenpy.networks.site"><code class="xref py py-class docutils literal notranslate"><span class="pre">site</span></code></a></span></dt>
<dd><p class="first last">The site on which the grid acts.</p>
</dd>
<dt><strong>grid</strong> <span class="classifier-delimiter">:</span> <span class="classifier">list of list of <cite>entries</cite></span></dt>
<dd><p class="first last">Represents a single matrix <cite>W</cite> of an MPO, i.e. the lists correspond to the legs
<code class="docutils literal notranslate"><span class="pre">'vL',</span> <span class="pre">'vR'</span></code>, and entries to onsite operators acting on the given <cite>site</cite>.
<cite>entries</cite> may be <code class="docutils literal notranslate"><span class="pre">None</span></code>, <a class="reference internal" href="tenpy.linalg.np_conserved.html#tenpy.linalg.np_conserved.Array" title="tenpy.linalg.np_conserved.Array"><code class="xref py py-class docutils literal notranslate"><span class="pre">Array</span></code></a>, a single string
or of the form <code class="docutils literal notranslate"><span class="pre">[('opname',</span> <span class="pre">strength),</span> <span class="pre">...]</span></code>, where <code class="docutils literal notranslate"><span class="pre">'opname'</span></code> labels an operator in
the <cite>site</cite>.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>grid</strong> <span class="classifier-delimiter">:</span> <span class="classifier">list of list of {None | <a class="reference internal" href="tenpy.linalg.np_conserved.html#tenpy.linalg.np_conserved.Array" title="tenpy.linalg.np_conserved.Array"><code class="xref py py-class docutils literal notranslate"><span class="pre">Array</span></code></a>}</span></dt>
<dd><p class="first last">Copy of <cite>grid</cite> with entries <code class="docutils literal notranslate"><span class="pre">[('opname',</span> <span class="pre">strength),</span> <span class="pre">...]</span></code> replaced by
<code class="docutils literal notranslate"><span class="pre">sum([strength*site.get_op('opname')</span> <span class="pre">for</span> <span class="pre">opname,</span> <span class="pre">strength</span> <span class="pre">in</span> <span class="pre">entry])</span></code>
and entries <code class="docutils literal notranslate"><span class="pre">'opname'</span></code> replaced by <code class="docutils literal notranslate"><span class="pre">site.get_op('opname')</span></code>.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/logo.png" alt="Logo"/>
            </a></p>
  <h4>Previous topic</h4>
  <p class="topless"><a href="tenpy.networks.html"
                        title="previous chapter">tenpy.networks package</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="tenpy.networks.mps.html"
                        title="next chapter">tenpy.networks.mps module</a></p>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
<h3><a href="../index.html">Table of Contents</a></h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../userguide.html">User Guide</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="tenpy.html">Reference</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="tenpy.html#subpackages">Subpackages</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="tenpy.algorithms.html">tenpy.algorithms package</a></li>
<li class="toctree-l3"><a class="reference internal" href="tenpy.linalg.html">tenpy.linalg package</a></li>
<li class="toctree-l3"><a class="reference internal" href="tenpy.models.html">tenpy.models package</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="tenpy.networks.html">tenpy.networks package</a></li>
<li class="toctree-l3"><a class="reference internal" href="tenpy.tools.html">tenpy.tools package</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="tenpy.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="tenpy.html#module-tenpy">Module contents</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="tenpy.networks.mps.html" title="tenpy.networks.mps module"
             >next</a> |</li>
        <li class="right" >
          <a href="tenpy.networks.html" title="tenpy.networks package"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">TeNPy 0.3.0 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="tenpy.html" >Reference</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="tenpy.networks.html" >tenpy.networks package</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2016-2019, TeNPy Developers.
      Last updated on Mar 18, 2019.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.8.4.
    </div>
  </body>
</html>