
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>run &#8212; TeNPy 0.3.0 documentation</title>
    <link rel="stylesheet" href="../_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/language_data.js"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <link rel="shortcut icon" href="../_static/logo.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="tebd" href="tenpy.algorithms.tebd.html" />
    <link rel="prev" title="TwoSiteMixer" href="tenpy.algorithms.dmrg.TwoSiteMixer.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="tenpy.algorithms.tebd.html" title="tebd"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="tenpy.algorithms.dmrg.TwoSiteMixer.html" title="TwoSiteMixer"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">TeNPy 0.3.0 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../reference.html" >Tenpy Reference</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="tenpy.algorithms.html" >algorithms</a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="tenpy.algorithms.dmrg.html" accesskey="U">dmrg</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="run">
<h1>run<a class="headerlink" href="#run" title="Permalink to this headline">¶</a></h1>
<ul class="simple">
<li>full name: tenpy.algorithms.dmrg.run</li>
<li>parent module: <a class="reference internal" href="tenpy.algorithms.dmrg.html#module-tenpy.algorithms.dmrg" title="tenpy.algorithms.dmrg"><code class="xref py py-mod docutils literal notranslate"><span class="pre">tenpy.algorithms.dmrg</span></code></a></li>
<li>type: function</li>
</ul>
<dl class="function">
<dt id="tenpy.algorithms.dmrg.run">
<code class="descclassname">tenpy.algorithms.dmrg.</code><code class="descname">run</code><span class="sig-paren">(</span><em>psi</em>, <em>model</em>, <em>DMRG_params</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tenpy/algorithms/dmrg.html#run"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tenpy.algorithms.dmrg.run" title="Permalink to this definition">¶</a></dt>
<dd><p>Run the DMRG algorithm to find the ground state of the given model.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>psi</strong> <span class="classifier-delimiter">:</span> <span class="classifier"><a class="reference internal" href="tenpy.networks.mps.MPS.html#tenpy.networks.mps.MPS" title="tenpy.networks.mps.MPS"><code class="xref py py-class docutils literal notranslate"><span class="pre">MPS</span></code></a></span></dt>
<dd><p class="first last">Initial guess for the ground state, which is to be optimized in-place.</p>
</dd>
<dt><strong>model</strong> <span class="classifier-delimiter">:</span> <span class="classifier"><code class="xref py py-class docutils literal notranslate"><span class="pre">MPOModel</span></code></span></dt>
<dd><p class="first last">The model representing the Hamiltonian for which we want to find the ground state.</p>
</dd>
<dt><strong>DMRG_params</strong> <span class="classifier-delimiter">:</span> <span class="classifier">dict</span></dt>
<dd><p class="first">Further optional parameters as described in the following table.
Use <code class="docutils literal notranslate"><span class="pre">verbose&gt;0</span></code> to print the used parameters during runtime.</p>
<table border="1" class="last docutils">
<colgroup>
<col width="16%" />
<col width="10%" />
<col width="73%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">key</th>
<th class="head">type</th>
<th class="head">description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>LP</td>
<td>npc.Array</td>
<td>Initial left-most <cite>LP</cite> and right-most <cite>RP</cite> (‘left/right part’)</td>
</tr>
<tr class="row-odd"><td>RP</td>
<td>&#160;</td>
<td>of the environment. By default (<code class="docutils literal notranslate"><span class="pre">None</span></code>) generate trivial,
see <a class="reference internal" href="tenpy.networks.mpo.MPOEnvironment.html#tenpy.networks.mpo.MPOEnvironment" title="tenpy.networks.mpo.MPOEnvironment"><code class="xref py py-class docutils literal notranslate"><span class="pre">MPOEnvironment</span></code></a> for details.</td>
</tr>
<tr class="row-even"><td>LP_age</td>
<td>int</td>
<td>The ‘age’ (i.e. number of physical sites invovled into the</td>
</tr>
<tr class="row-odd"><td>RP_age</td>
<td>&#160;</td>
<td>contraction) of the left-most <cite>LP</cite> and right-most <cite>RP</cite>
of the environment.</td>
</tr>
<tr class="row-even"><td>mixer</td>
<td>str |
class</td>
<td>Chooses the <a class="reference internal" href="tenpy.algorithms.dmrg.Mixer.html#tenpy.algorithms.dmrg.Mixer" title="tenpy.algorithms.dmrg.Mixer"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mixer</span></code></a> to be used.
A string stands for one of the mixers defined in this module,
a class is used as custom mixer.
Default (<code class="docutils literal notranslate"><span class="pre">None</span></code>) uses no mixer, <code class="docutils literal notranslate"><span class="pre">True</span></code> uses <a class="reference internal" href="tenpy.algorithms.dmrg.Mixer.html#tenpy.algorithms.dmrg.Mixer" title="tenpy.algorithms.dmrg.Mixer"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mixer</span></code></a>.</td>
</tr>
<tr class="row-odd"><td>mixer_params</td>
<td>dict</td>
<td>Non-default initialization arguments of the mixer.
Options may be custom to the specified mixer, so they’re
documented in the class doc-string of the mixer.</td>
</tr>
<tr class="row-even"><td>orthogonal_to</td>
<td>list of
MPS</td>
<td>List of other matrix produc states to orthogonalize against.
Works only for finite systems.
This parameter can be used to find (a few) excited states as
follows. First, run DMRG to find the ground state and then
run DMRG again while orthogonalizing against the ground state,
which yields the first excited state (in the same symmetry
sector), and so on.</td>
</tr>
<tr class="row-odd"><td>engine</td>
<td>str |
class</td>
<td>Chooses the (derived class of) <a class="reference internal" href="tenpy.algorithms.dmrg.Engine.html#tenpy.algorithms.dmrg.Engine" title="tenpy.algorithms.dmrg.Engine"><code class="xref py py-class docutils literal notranslate"><span class="pre">Engine</span></code></a> to be used.
A string stands for one of the engines defined in this module,
a class (not an instance!) can be used as custom engine.</td>
</tr>
<tr class="row-even"><td>trunc_params</td>
<td>dict</td>
<td>Truncation parameters as described in
<a class="reference internal" href="tenpy.algorithms.truncation.truncate.html#tenpy.algorithms.truncation.truncate" title="tenpy.algorithms.truncation.truncate"><code class="xref py py-func docutils literal notranslate"><span class="pre">truncate()</span></code></a></td>
</tr>
<tr class="row-odd"><td>chi_list</td>
<td>dict |
None</td>
<td>A dictionary to gradually increase the <cite>chi_max</cite> parameter of
<cite>trunc_params</cite>. The key defines starting from which sweep
<cite>chi_max</cite> is set to the value, e.g. <code class="docutils literal notranslate"><span class="pre">{0:</span> <span class="pre">50,</span> <span class="pre">20:</span> <span class="pre">100}</span></code> uses
<code class="docutils literal notranslate"><span class="pre">chi_max=50</span></code> for the first 20 sweeps and <code class="docutils literal notranslate"><span class="pre">chi_max=100</span></code>
afterwards. Overwrites <cite>trunc_params[‘chi_list’]`</cite>.
By default (<code class="docutils literal notranslate"><span class="pre">None</span></code>) this feature is disabled.</td>
</tr>
<tr class="row-even"><td>lanczos_params</td>
<td>dict</td>
<td>Lanczos parameters as described in
<a class="reference internal" href="tenpy.linalg.lanczos.lanczos.html#tenpy.linalg.lanczos.lanczos" title="tenpy.linalg.lanczos.lanczos"><code class="xref py py-func docutils literal notranslate"><span class="pre">lanczos()</span></code></a></td>
</tr>
<tr class="row-odd"><td>N_sweeps_check</td>
<td>int</td>
<td>Number of sweeps to perform between checking convergence
criteria and giving a status update.</td>
</tr>
<tr class="row-even"><td>sweep_0</td>
<td>int</td>
<td>The number of sweeps already performed. (Useful for re-start).</td>
</tr>
<tr class="row-odd"><td>start_env</td>
<td>int</td>
<td>Number of initial sweeps performed without bond optimizaiton to
initialize the environment.</td>
</tr>
<tr class="row-even"><td>update_env</td>
<td>int</td>
<td>Number of sweeps without bond optimizaiton to update the
environment for infinite boundary conditions,
performed every <cite>N_sweeps_check</cite> sweeps.</td>
</tr>
<tr class="row-odd"><td>norm_tol</td>
<td>float</td>
<td>After the DMRG run, update the environment with at most
<cite>norm_tol_iter</cite> sweeps until
<code class="docutils literal notranslate"><span class="pre">np.linalg.norm(psi.norm_err())</span> <span class="pre">&lt;</span> <span class="pre">norm_tol</span></code>.</td>
</tr>
<tr class="row-even"><td>norm_tol_iter</td>
<td>float</td>
<td>Perform at most <cite>norm_tol_iter`*`update_env</cite> sweeps to
converge the norm error below <cite>norm_tol</cite>.
If the state is not converged after that, call
<code class="xref py py-meth docutils literal notranslate"><span class="pre">canonical_form()</span></code> instead.</td>
</tr>
<tr class="row-odd"><td>max_sweeps</td>
<td>int</td>
<td>Maximum number of sweeps to be performed.</td>
</tr>
<tr class="row-even"><td>min_sweeps</td>
<td>int</td>
<td>Minimum number of sweeps to be performed.
Defaults to 1.5*N_sweeps_check.</td>
</tr>
<tr class="row-odd"><td>max_E_err</td>
<td>float</td>
<td>Convergence if the change of the energy in each step
satisfies <code class="docutils literal notranslate"><span class="pre">-Delta</span> <span class="pre">E</span> <span class="pre">/</span> <span class="pre">max(|E|,</span> <span class="pre">1)</span> <span class="pre">&lt;</span> <span class="pre">max_E_err</span></code>. Note that
this is also satisfied if <code class="docutils literal notranslate"><span class="pre">Delta</span> <span class="pre">E</span> <span class="pre">&gt;</span> <span class="pre">0</span></code>,
i.e., if the energy increases (due to truncation).</td>
</tr>
<tr class="row-even"><td>max_S_err</td>
<td>float</td>
<td>Convergence if the relative change of the entropy in each step
satisfies <code class="docutils literal notranslate"><span class="pre">|Delta</span> <span class="pre">S|/S</span> <span class="pre">&lt;</span> <span class="pre">max_S_err</span></code></td>
</tr>
<tr class="row-odd"><td>max_hours</td>
<td>float</td>
<td>If the DMRG took longer (measured in wall-clock time),
‘shelve’ the simulation, i.e. stop and return with the flag
<code class="docutils literal notranslate"><span class="pre">shelve=True</span></code>.</td>
</tr>
<tr class="row-even"><td>P_tol_to_trunc</td>
<td>float</td>
<td>It’s reasonable to choose the Lanczos convergence criteria</td>
</tr>
<tr class="row-odd"><td>P_tol_max</td>
<td>&#160;</td>
<td><code class="docutils literal notranslate"><span class="pre">'P_tol'</span></code> not many magnitudes lower than the current</td>
</tr>
<tr class="row-even"><td>P_tol_min</td>
<td>&#160;</td>
<td>truncation error. Therefore, if <cite>P_tol_to_trunc</cite> is not
<code class="docutils literal notranslate"><span class="pre">None</span></code>, we update <cite>P_tol</cite> of <cite>lanczos_params</cite> to
<code class="docutils literal notranslate"><span class="pre">max_trunc_err*P_tol_to_trunc</span></code>,
restricted to the interval [<cite>P_tol_min</cite>, <cite>P_tol_max</cite>],
where <code class="docutils literal notranslate"><span class="pre">max_trunc_err</span></code> is the maximal truncation error
(discarded weight of the Schmidt values) due to truncation
right after each Lanczos optimization during the sweeps.</td>
</tr>
<tr class="row-odd"><td>E_tol_to_trunc</td>
<td>float</td>
<td>It’s reasonable to choose the Lanczos convergence criteria</td>
</tr>
<tr class="row-even"><td>E_tol_max</td>
<td>&#160;</td>
<td><code class="docutils literal notranslate"><span class="pre">'E_tol'</span></code> not many magnitudes lower than the current</td>
</tr>
<tr class="row-odd"><td>E_tol_min</td>
<td>&#160;</td>
<td>truncation error. Therefore, if <cite>E_tol_to_trunc</cite> is not
<code class="docutils literal notranslate"><span class="pre">None</span></code>, we update <cite>E_tol</cite> of <cite>lanczos_params</cite> to
<code class="docutils literal notranslate"><span class="pre">max_E_trunc*E_tol_to_trunc</span></code>,
restricted to the interval [<cite>E_tol_min</cite>, <cite>E_tol_max</cite>],
where <code class="docutils literal notranslate"><span class="pre">max_E_trunc</span></code> is the maximal energy difference due to
truncation right after each Lanczos optimization during the
sweeps.</td>
</tr>
</tbody>
</table>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>info</strong> <span class="classifier-delimiter">:</span> <span class="classifier">dict</span></dt>
<dd><p class="first last">A dictionary with keys <code class="docutils literal notranslate"><span class="pre">'E',</span> <span class="pre">'shelve',</span> <span class="pre">'bond_statistics',</span> <span class="pre">'sweep_statistics'</span></code></p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/logo.png" alt="Logo"/>
            </a></p>
  <h4>Previous topic</h4>
  <p class="topless"><a href="tenpy.algorithms.dmrg.TwoSiteMixer.html"
                        title="previous chapter">TwoSiteMixer</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="tenpy.algorithms.tebd.html"
                        title="next chapter">tebd</a></p>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
<h3><a href="../index.html">Table of Contents</a></h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../userguide.html">User Guide</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../reference.html">Tenpy Reference</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="tenpy.algorithms.html">algorithms</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="tenpy.algorithms.truncation.html">truncation</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="tenpy.algorithms.dmrg.html">dmrg</a></li>
<li class="toctree-l3"><a class="reference internal" href="tenpy.algorithms.tebd.html">tebd</a></li>
<li class="toctree-l3"><a class="reference internal" href="tenpy.algorithms.tdvp.html">tdvp</a></li>
<li class="toctree-l3"><a class="reference internal" href="tenpy.algorithms.purification_tebd.html">purification_tebd</a></li>
<li class="toctree-l3"><a class="reference internal" href="tenpy.algorithms.network_contractor.html">network_contractor</a></li>
<li class="toctree-l3"><a class="reference internal" href="tenpy.algorithms.exact_diag.html">exact_diag</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="tenpy.linalg.html">linalg</a></li>
<li class="toctree-l2"><a class="reference internal" href="tenpy.models.html">models</a></li>
<li class="toctree-l2"><a class="reference internal" href="tenpy.networks.html">networks</a></li>
<li class="toctree-l2"><a class="reference internal" href="tenpy.tools.html">tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="tenpy.version.html">version</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="tenpy.algorithms.tebd.html" title="tebd"
             >next</a> |</li>
        <li class="right" >
          <a href="tenpy.algorithms.dmrg.TwoSiteMixer.html" title="TwoSiteMixer"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">TeNPy 0.3.0 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../reference.html" >Tenpy Reference</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="tenpy.algorithms.html" >algorithms</a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="tenpy.algorithms.dmrg.html" >dmrg</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2016-2019, TeNPy Developers.
      Last updated on Mar 29, 2019.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.8.4.
    </div>
  </body>
</html>