
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>truncation &#8212; TeNPy 0.4.1 documentation</title>
    <link rel="stylesheet" href="../_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/language_data.js"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <link rel="shortcut icon" href="../_static/logo.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="TruncationError" href="tenpy.algorithms.truncation.TruncationError.html" />
    <link rel="prev" title="algorithms" href="tenpy.algorithms.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="tenpy.algorithms.truncation.TruncationError.html" title="TruncationError"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="tenpy.algorithms.html" title="algorithms"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">TeNPy 0.4.1 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../reference.html" >Tenpy Reference</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="tenpy.algorithms.html" accesskey="U">algorithms</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="truncation">
<h1>truncation<a class="headerlink" href="#truncation" title="Permalink to this headline">¶</a></h1>
<ul class="simple">
<li><p>full name: tenpy.algorithms.truncation</p></li>
<li><p>parent module: <a class="reference internal" href="tenpy.algorithms.html#module-tenpy.algorithms" title="tenpy.algorithms"><code class="xref py py-mod docutils literal notranslate"><span class="pre">tenpy.algorithms</span></code></a></p></li>
<li><p>type: module</p></li>
</ul>
<p class="rubric">Classes</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="tenpy.algorithms.truncation.TruncationError.html#tenpy.algorithms.truncation.TruncationError" title="tenpy.algorithms.truncation.TruncationError"><code class="xref py py-obj docutils literal notranslate"><span class="pre">TruncationError</span></code></a>([eps, ov])</p></td>
<td><p>Class representing a truncation error.</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Functions</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="tenpy.algorithms.truncation.svd_theta.html#tenpy.algorithms.truncation.svd_theta" title="tenpy.algorithms.truncation.svd_theta"><code class="xref py py-obj docutils literal notranslate"><span class="pre">svd_theta</span></code></a>(theta, trunc_par[, qtotal_LR, …])</p></td>
<td><p>Performs SVD of a matrix <cite>theta</cite> (= the wavefunction) and truncates it.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="tenpy.algorithms.truncation.truncate.html#tenpy.algorithms.truncation.truncate" title="tenpy.algorithms.truncation.truncate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">truncate</span></code></a>(S, trunc_par)</p></td>
<td><p>Given a Schmidt spectrum Y, determine which values to keep.</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Module description</p>
<span class="target" id="module-tenpy.algorithms.truncation"></span><p>Truncation of Schmidt values.</p>
<p>Often, it is necessary to truncate the number of states on a virtual bond of an MPS,
keeping only the state with the largest Schmidt values.
The function <code class="xref py py-func docutils literal notranslate"><span class="pre">truncation()</span></code> picks exactly those from a given Schmidt spectrum
<span class="math notranslate nohighlight">\(\lambda_a\)</span>, depending on some parameters explained in the doc-string of the function.</p>
<p>Further, we provide <a class="reference internal" href="tenpy.algorithms.truncation.TruncationError.html#tenpy.algorithms.truncation.TruncationError" title="tenpy.algorithms.truncation.TruncationError"><code class="xref py py-class docutils literal notranslate"><span class="pre">TruncationError</span></code></a> for a simple way to keep track of the
total truncation error.</p>
<p>The SVD on a virtual bond of an MPS actually gives a Schmidt decomposition
<span class="math notranslate nohighlight">\(|\psi\rangle = \sum_{a} \lambda_a |L_a\rangle |R_a\rangle\)</span>
where <span class="math notranslate nohighlight">\(|L_a\rangle\)</span> and <span class="math notranslate nohighlight">\(|R_a\rangle\)</span> form orthonormal bases of the parts
left and right of the virtual bond.
Let us assume that the state is properly normalized,
<span class="math notranslate nohighlight">\(\langle\psi | \psi\rangle = \sum_{a} \lambda^2 = 1\)</span>.
Assume that the singular values are ordered descending, and that we keep the first <span class="math notranslate nohighlight">\(\chi_c\)</span>
of the initially <span class="math notranslate nohighlight">\(\chi\)</span> Schmidt values.</p>
<p>Then we decompose the untuncated state as
<span class="math notranslate nohighlight">\(|\psi\rangle = \sqrt{1-\epsilon}|\psi_{tr}\rangle + \sqrt{\epsilon}|\psi_{tr}^\perp\rangle\)</span>
where
<span class="math notranslate nohighlight">\(|\psi_{tr}\rangle =
\frac{1}{\sqrt{1-\epsilon}} \sum_{a &lt; \chi_c} \lambda_a|L_a\rangle|R_a\rangle\)</span>
is the truncated state kept (normalized to 1),
<span class="math notranslate nohighlight">\(|\psi_{tr}^\perp\rangle =
\frac{1}{\sqrt{\epsilon}} \sum_{a &gt;= \chi_c} \lambda_a |L_a\rangle|R_a\rangle\)</span>
is the discarded part (orthogonal to the kept part) and the
<em>truncation error of a single truncation</em> is defined as
<span class="math notranslate nohighlight">\(\epsilon = 1 - |\langle \psi | \psi_{tr}\rangle |^2 = \sum_{a &gt;= \chi_c} \lambda_a^2\)</span>.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>For imaginary time evolution (e.g. with TEBD), you try to project out the ground state.
Then, looking at the truncation error defined in this module does <em>not</em> give you any
information how good the found state coincides with the actual ground state!
(Instead, the returned truncation error depends on the overlap with the initial state,
which is arbitrary &gt; 0)</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This module takes only track of the errors coming from the truncation of Schmidt values.
There might be other sources of error as well, for example TEBD has also an discretisation
error depending on the chosen time step.</p>
</div>
<div class="admonition-todo admonition" id="id1">
<p class="admonition-title">Todo</p>
<p>The <a class="reference external" href="https://en.wikipedia.org/wiki/Time-evolving_block_decimation">TEBD wikipedia article</a>
(in the section ‘Errors coming from the truncation of the Hilbert space’)
claims that there is a second more subtle error, which stems from the change of the Schmidt
basis <span class="math notranslate nohighlight">\(|R_a\rangle\)</span> on bond i-1 if we truncate bond i.
In the end, that leads just to a factor of 2 in TruncationError.__init__ ???
(I couldn’t follow the argument completely,
and the factor was definetly not included in the old TenPy.)</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/logo.png" alt="Logo"/>
            </a></p>
  <h4>Previous topic</h4>
  <p class="topless"><a href="tenpy.algorithms.html"
                        title="previous chapter">algorithms</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="tenpy.algorithms.truncation.TruncationError.html"
                        title="next chapter">TruncationError</a></p>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
<h3><a href="../index.html">Table of Contents</a></h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../userguide.html">User Guide</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../reference.html">Tenpy Reference</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="tenpy.algorithms.html">algorithms</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">truncation</a></li>
<li class="toctree-l3"><a class="reference internal" href="tenpy.algorithms.dmrg.html">dmrg</a></li>
<li class="toctree-l3"><a class="reference internal" href="tenpy.algorithms.mps_sweeps.html">mps_sweeps</a></li>
<li class="toctree-l3"><a class="reference internal" href="tenpy.algorithms.tebd.html">tebd</a></li>
<li class="toctree-l3"><a class="reference internal" href="tenpy.algorithms.tdvp.html">tdvp</a></li>
<li class="toctree-l3"><a class="reference internal" href="tenpy.algorithms.purification_tebd.html">purification_tebd</a></li>
<li class="toctree-l3"><a class="reference internal" href="tenpy.algorithms.network_contractor.html">network_contractor</a></li>
<li class="toctree-l3"><a class="reference internal" href="tenpy.algorithms.exact_diag.html">exact_diag</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="tenpy.linalg.html">linalg</a></li>
<li class="toctree-l2"><a class="reference internal" href="tenpy.models.html">models</a></li>
<li class="toctree-l2"><a class="reference internal" href="tenpy.networks.html">networks</a></li>
<li class="toctree-l2"><a class="reference internal" href="tenpy.tools.html">tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="tenpy.version.html">version</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="tenpy.algorithms.truncation.TruncationError.html" title="TruncationError"
             >next</a> |</li>
        <li class="right" >
          <a href="tenpy.algorithms.html" title="algorithms"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">TeNPy 0.4.1 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../reference.html" >Tenpy Reference</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="tenpy.algorithms.html" >algorithms</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2016-2019, TeNPy Developers.
      Last updated on Nov 26, 2019.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 2.2.1.
    </div>
  </body>
</html>