
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>Overview &#8212; TeNPy 0.4.1 documentation</title>
    <link rel="stylesheet" href="_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/language_data.js"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <link rel="shortcut icon" href="_static/logo.ico"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Literature" href="literature.html" />
    <link rel="prev" title="Installation instructions" href="INSTALL.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="literature.html" title="Literature"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="INSTALL.html" title="Installation instructions"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">TeNPy 0.4.1 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="userguide.html" accesskey="U">User Guide</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="overview">
<h1>Overview<a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h1>
<div class="section" id="repository">
<h2>Repository<a class="headerlink" href="#repository" title="Permalink to this headline">¶</a></h2>
<p>The root directory of this git repository contains the following folders:</p>
<dl class="simple">
<dt>tenpy</dt><dd><p>The actual source code of the library.
Every subfolder contains an <code class="docutils literal notranslate"><span class="pre">__init__.py</span></code> file with a summary what the modules in it are good for.
(This file is also necessary to mark the folder as part of the python package.
Consequently, other subfolders of the git repo should not include a <code class="docutils literal notranslate"><span class="pre">__init__.py</span></code> file.)</p>
</dd>
<dt>toycodes</dt><dd><p>Simple toy codes completely independet of the remaining library (i.e., codes in <code class="docutils literal notranslate"><span class="pre">tenpy/</span></code>).
These codes should be quite readable and intend to give a flavor of how (some of) the algorithms work.</p>
</dd>
<dt>examples</dt><dd><p>Some example files demonstrating the usage and interface of the library.</p>
</dd>
<dt>doc</dt><dd><p>A folder containing the documentation: the user guide is contained in the <code class="docutils literal notranslate"><span class="pre">*.rst</span></code> files.
The online documentation is autogenerated from these files and the docstrings of the library.
This folder contains a make file for building the documentation, run <code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">help</span></code> for the different options.
The necessary files for the reference in <code class="docutils literal notranslate"><span class="pre">doc/reference</span></code> can be auto-generated/updated with <code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">src2html</span></code>.</p>
</dd>
<dt>tests</dt><dd><p>Contains files with test routines, to be used with <cite>pytest</cite>.
If you are set up correctly and have <cite>pytest</cite> installed, you can run the test suite with
<code class="docutils literal notranslate"><span class="pre">pytest</span></code> from within the <code class="docutils literal notranslate"><span class="pre">tests/</span></code> folder.</p>
</dd>
<dt>build</dt><dd><p>This folder is not distributed with the code, but is generated by <code class="docutils literal notranslate"><span class="pre">setup.py</span></code> (or <code class="docutils literal notranslate"><span class="pre">compile.sh</span></code>, respectively).
It contains compiled versions of the Cython files, and can be ignored (and even removed without loosing functionality).</p>
</dd>
</dl>
</div>
<div class="section" id="code-structure-getting-started">
<h2>Code structure: getting started<a class="headerlink" href="#code-structure-getting-started" title="Permalink to this headline">¶</a></h2>
<p>There are several layers of abstraction in TeNPy.
While there is a certain hierarchy of how the concepts build up on each other, the user can decide to utilize only some of them.
A maximal flexibility is provided by an object oriented style based on classes, which can be inherited and adjusted to individual demands.</p>
<p>The following figure gives an overview of the most important modules, classes and functions in TeNPy.
Gray backgrounds indicate (sub)modules, yellow backgrounds indicate classes.
Red arrows indicate inheritance relations, dashed black arrows indicate a direct use.
(The individual models might be derived from the <a class="reference internal" href="reference/tenpy.models.model.NearestNeighborModel.html#tenpy.models.model.NearestNeighborModel" title="tenpy.models.model.NearestNeighborModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">NearestNeighborModel</span></code></a> depending on the geometry of the lattice.)
There is a clear hierarchy from high-level algorithms in the <a class="reference internal" href="reference/tenpy.algorithms.html#module-tenpy.algorithms" title="tenpy.algorithms"><code class="xref py py-mod docutils literal notranslate"><span class="pre">tenpy.algorithms</span></code></a> module down to basic
operations from linear algebra in the <a class="reference internal" href="reference/tenpy.linalg.html#module-tenpy.linalg" title="tenpy.linalg"><code class="xref py py-mod docutils literal notranslate"><span class="pre">tenpy.linalg</span></code></a> module.</p>
<img alt="_images/tenpy_layers.png" src="_images/tenpy_layers.png" />
<div class="section" id="most-basic-level-linear-algebra">
<h3>Most basic level: linear algebra<a class="headerlink" href="#most-basic-level-linear-algebra" title="Permalink to this headline">¶</a></h3>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>See <a class="reference internal" href="intro_npc.html"><span class="doc">Introduction to np_conserved</span></a> for more information on defining charges for arrays.</p>
</div>
<p>The most basic layer is given by in the <a class="reference internal" href="reference/tenpy.linalg.html#module-tenpy.linalg" title="tenpy.linalg"><code class="xref py py-mod docutils literal notranslate"><span class="pre">linalg</span></code></a> module, which provides basic features of linear algebra.
In particular, the <a class="reference internal" href="reference/tenpy.linalg.np_conserved.html#module-tenpy.linalg.np_conserved" title="tenpy.linalg.np_conserved"><code class="xref py py-mod docutils literal notranslate"><span class="pre">np_conserved</span></code></a> submodule implements an <a class="reference internal" href="reference/tenpy.linalg.np_conserved.Array.html#tenpy.linalg.np_conserved.Array" title="tenpy.linalg.np_conserved.Array"><code class="xref py py-class docutils literal notranslate"><span class="pre">Array</span></code></a> class which is used to represent
the tensors. The basic interface of <a class="reference internal" href="reference/tenpy.linalg.np_conserved.html#module-tenpy.linalg.np_conserved" title="tenpy.linalg.np_conserved"><code class="xref py py-mod docutils literal notranslate"><span class="pre">np_conserved</span></code></a> is very similar to that of the NumPy and SciPy libraries.
However, the <a class="reference internal" href="reference/tenpy.linalg.np_conserved.Array.html#tenpy.linalg.np_conserved.Array" title="tenpy.linalg.np_conserved.Array"><code class="xref py py-class docutils literal notranslate"><span class="pre">Array</span></code></a> class implements abelian charge conservation.
If no charges are to be used, one can use ‘trivial’ arrays, as shown in the following example code.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot;Basic use of the `Array` class with trivial arrays.&quot;&quot;&quot;</span>
<span class="c1"># Copyright 2019 TeNPy Developers, GNU GPLv3</span>

<span class="kn">import</span> <span class="nn">tenpy.linalg.np_conserved</span> <span class="k">as</span> <span class="nn">npc</span>

<span class="n">M</span> <span class="o">=</span> <span class="n">npc</span><span class="o">.</span><span class="n">Array</span><span class="o">.</span><span class="n">from_ndarray_trivial</span><span class="p">([[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]])</span>
<span class="n">v</span> <span class="o">=</span> <span class="n">npc</span><span class="o">.</span><span class="n">Array</span><span class="o">.</span><span class="n">from_ndarray_trivial</span><span class="p">([</span><span class="mf">2.</span><span class="p">,</span> <span class="mf">4.</span> <span class="o">+</span> <span class="mf">1.</span><span class="n">j</span><span class="p">])</span>
<span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">3.</span>  <span class="c1"># set indiviual entries like in numpy</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;|v&gt; =&quot;</span><span class="p">,</span> <span class="n">v</span><span class="o">.</span><span class="n">to_ndarray</span><span class="p">())</span>
<span class="c1"># |v&gt; = [ 3.+0.j  4.+1.j]</span>

<span class="n">M_v</span> <span class="o">=</span> <span class="n">npc</span><span class="o">.</span><span class="n">tensordot</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;M|v&gt; =&quot;</span><span class="p">,</span> <span class="n">M_v</span><span class="o">.</span><span class="n">to_ndarray</span><span class="p">())</span>
<span class="c1"># M|v&gt; = [ 4.+1.j  3.+0.j]</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&lt;v|M|v&gt; =&quot;</span><span class="p">,</span> <span class="n">npc</span><span class="o">.</span><span class="n">inner</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">conj</span><span class="p">(),</span> <span class="n">M_v</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="s1">&#39;range&#39;</span><span class="p">))</span>
<span class="c1"># &lt;v|M|v&gt; = (24+0j)</span>
</pre></div>
</div>
<p>The number and types of symmetries are specified in a <a class="reference internal" href="reference/tenpy.linalg.charges.ChargeInfo.html#tenpy.linalg.charges.ChargeInfo" title="tenpy.linalg.charges.ChargeInfo"><code class="xref py py-class docutils literal notranslate"><span class="pre">ChargeInfo</span></code></a> class.
An <a class="reference internal" href="reference/tenpy.linalg.np_conserved.Array.html#tenpy.linalg.np_conserved.Array" title="tenpy.linalg.np_conserved.Array"><code class="xref py py-class docutils literal notranslate"><span class="pre">Array</span></code></a> instance represents a tensor satisfying a charge rule specifying which blocks of it are nonzero.
Internally, it stores only the non-zero blocks of the tensor, along with one <a class="reference internal" href="reference/tenpy.linalg.charges.LegCharge.html#tenpy.linalg.charges.LegCharge" title="tenpy.linalg.charges.LegCharge"><code class="xref py py-class docutils literal notranslate"><span class="pre">LegCharge</span></code></a> instance for each
leg, which contains the <cite>charges</cite> and sign <cite>qconj</cite> for each leg.
We can combine multiple legs into a single larger <a class="reference internal" href="reference/tenpy.linalg.charges.LegPipe.html#tenpy.linalg.charges.LegPipe" title="tenpy.linalg.charges.LegPipe"><code class="xref py py-class docutils literal notranslate"><span class="pre">LegPipe</span></code></a>,
which is derived from the <a class="reference internal" href="reference/tenpy.linalg.charges.LegCharge.html#tenpy.linalg.charges.LegCharge" title="tenpy.linalg.charges.LegCharge"><code class="xref py py-class docutils literal notranslate"><span class="pre">LegCharge</span></code></a> and stores all the information necessary to later split the pipe.</p>
<p>The following code explicitly defines the spin-1/2 <span class="math notranslate nohighlight">\(S^+, S^-, S^z\)</span> operators and
uses them to generate and diagonalize the two-site Hamiltonian <span class="math notranslate nohighlight">\(H = \vec{S} \cdot \vec{S}\)</span>.
It prints the charge values (by default sorted ascending) and the eigenvalues of H.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot;Explicit definition of charges and spin-1/2 operators.&quot;&quot;&quot;</span>
<span class="c1"># Copyright 2019 TeNPy Developers, GNU GPLv3</span>

<span class="kn">import</span> <span class="nn">tenpy.linalg.np_conserved</span> <span class="k">as</span> <span class="nn">npc</span>

<span class="c1"># consider spin-1/2 with Sz-conservation</span>
<span class="n">chinfo</span> <span class="o">=</span> <span class="n">npc</span><span class="o">.</span><span class="n">ChargeInfo</span><span class="p">([</span><span class="mi">1</span><span class="p">])</span>  <span class="c1"># just a U(1) charge</span>
<span class="c1"># charges for up, down state</span>
<span class="n">p_leg</span> <span class="o">=</span> <span class="n">npc</span><span class="o">.</span><span class="n">LegCharge</span><span class="o">.</span><span class="n">from_qflat</span><span class="p">(</span><span class="n">chinfo</span><span class="p">,</span> <span class="p">[[</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]])</span>
<span class="n">Sz</span> <span class="o">=</span> <span class="n">npc</span><span class="o">.</span><span class="n">Array</span><span class="o">.</span><span class="n">from_ndarray</span><span class="p">([[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">]],</span> <span class="p">[</span><span class="n">p_leg</span><span class="p">,</span> <span class="n">p_leg</span><span class="o">.</span><span class="n">conj</span><span class="p">()])</span>
<span class="n">Sp</span> <span class="o">=</span> <span class="n">npc</span><span class="o">.</span><span class="n">Array</span><span class="o">.</span><span class="n">from_ndarray</span><span class="p">([[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]],</span> <span class="p">[</span><span class="n">p_leg</span><span class="p">,</span> <span class="n">p_leg</span><span class="o">.</span><span class="n">conj</span><span class="p">()])</span>
<span class="n">Sm</span> <span class="o">=</span> <span class="n">npc</span><span class="o">.</span><span class="n">Array</span><span class="o">.</span><span class="n">from_ndarray</span><span class="p">([[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]],</span> <span class="p">[</span><span class="n">p_leg</span><span class="p">,</span> <span class="n">p_leg</span><span class="o">.</span><span class="n">conj</span><span class="p">()])</span>

<span class="n">Hxy</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">npc</span><span class="o">.</span><span class="n">outer</span><span class="p">(</span><span class="n">Sp</span><span class="p">,</span> <span class="n">Sm</span><span class="p">)</span> <span class="o">+</span> <span class="n">npc</span><span class="o">.</span><span class="n">outer</span><span class="p">(</span><span class="n">Sm</span><span class="p">,</span> <span class="n">Sp</span><span class="p">))</span>
<span class="n">Hz</span> <span class="o">=</span> <span class="n">npc</span><span class="o">.</span><span class="n">outer</span><span class="p">(</span><span class="n">Sz</span><span class="p">,</span> <span class="n">Sz</span><span class="p">)</span>
<span class="n">H</span> <span class="o">=</span> <span class="n">Hxy</span> <span class="o">+</span> <span class="n">Hz</span>
<span class="c1"># here, H has 4 legs</span>
<span class="n">H</span><span class="o">.</span><span class="n">iset_leg_labels</span><span class="p">([</span><span class="s2">&quot;s1&quot;</span><span class="p">,</span> <span class="s2">&quot;t1&quot;</span><span class="p">,</span> <span class="s2">&quot;s2&quot;</span><span class="p">,</span> <span class="s2">&quot;t2&quot;</span><span class="p">])</span>
<span class="n">H</span> <span class="o">=</span> <span class="n">H</span><span class="o">.</span><span class="n">combine_legs</span><span class="p">([[</span><span class="s2">&quot;s1&quot;</span><span class="p">,</span> <span class="s2">&quot;s2&quot;</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;t1&quot;</span><span class="p">,</span> <span class="s2">&quot;t2&quot;</span><span class="p">]],</span> <span class="n">qconj</span><span class="o">=</span><span class="p">[</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="c1"># here, H has 2 legs</span>
<span class="nb">print</span><span class="p">(</span><span class="n">H</span><span class="o">.</span><span class="n">legs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">to_qflat</span><span class="p">()</span><span class="o">.</span><span class="n">flatten</span><span class="p">())</span>
<span class="c1"># prints [-2  0  0  2]</span>
<span class="n">E</span><span class="p">,</span> <span class="n">U</span> <span class="o">=</span> <span class="n">npc</span><span class="o">.</span><span class="n">eigh</span><span class="p">(</span><span class="n">H</span><span class="p">)</span>  <span class="c1"># diagonalize blocks individually</span>
<span class="nb">print</span><span class="p">(</span><span class="n">E</span><span class="p">)</span>
<span class="c1"># [ 0.25 -0.75  0.25  0.25]</span>
</pre></div>
</div>
</div>
<div class="section" id="sites-for-the-local-hilbert-space-and-tensor-networks">
<h3>Sites for the local Hilbert space and tensor networks<a class="headerlink" href="#sites-for-the-local-hilbert-space-and-tensor-networks" title="Permalink to this headline">¶</a></h3>
<p>The next basic concept is that of a local Hilbert space, which is represented by a <a class="reference internal" href="reference/tenpy.networks.site.Site.html#tenpy.networks.site.Site" title="tenpy.networks.site.Site"><code class="xref py py-class docutils literal notranslate"><span class="pre">Site</span></code></a> in TeNPy.
This class does not only label the local states and define the charges, but also
provides onsite operators. For example, the <a class="reference internal" href="reference/tenpy.networks.site.SpinHalfSite.html#tenpy.networks.site.SpinHalfSite" title="tenpy.networks.site.SpinHalfSite"><code class="xref py py-class docutils literal notranslate"><span class="pre">SpinHalfSite</span></code></a> provides the
<span class="math notranslate nohighlight">\(S^+, S^-, S^z\)</span> operators under the names <code class="docutils literal notranslate"><span class="pre">'Sp',</span> <span class="pre">'Sm',</span> <span class="pre">'Sz'</span></code>, defined as <a class="reference internal" href="reference/tenpy.linalg.np_conserved.Array.html#tenpy.linalg.np_conserved.Array" title="tenpy.linalg.np_conserved.Array"><code class="xref py py-class docutils literal notranslate"><span class="pre">Array</span></code></a> instances similarly as
in the code above.
Since the most common sites like for example the <a class="reference internal" href="reference/tenpy.networks.site.SpinSite.html#tenpy.networks.site.SpinSite" title="tenpy.networks.site.SpinSite"><code class="xref py py-class docutils literal notranslate"><span class="pre">SpinSite</span></code></a> (for general spin S=0.5, 1, 1.5,…), <a class="reference internal" href="reference/tenpy.networks.site.BosonSite.html#tenpy.networks.site.BosonSite" title="tenpy.networks.site.BosonSite"><code class="xref py py-class docutils literal notranslate"><span class="pre">BosonSite</span></code></a> and
<a class="reference internal" href="reference/tenpy.networks.site.FermionSite.html#tenpy.networks.site.FermionSite" title="tenpy.networks.site.FermionSite"><code class="xref py py-class docutils literal notranslate"><span class="pre">FermionSite</span></code></a> are predefined, a user of TeNPy usually does not need to define the local charges and operators explicitly.
The total Hilbert space, i.e, the tensor product of the local Hilbert spaces, is then just given by a
list of <a class="reference internal" href="reference/tenpy.networks.site.Site.html#tenpy.networks.site.Site" title="tenpy.networks.site.Site"><code class="xref py py-class docutils literal notranslate"><span class="pre">Site</span></code></a> instances. If desired, different kinds of <a class="reference internal" href="reference/tenpy.networks.site.Site.html#tenpy.networks.site.Site" title="tenpy.networks.site.Site"><code class="xref py py-class docutils literal notranslate"><span class="pre">Site</span></code></a> can be combined in that list.
This list is then given to classes representing tensor networks like the <a class="reference internal" href="reference/tenpy.networks.mps.MPS.html#tenpy.networks.mps.MPS" title="tenpy.networks.mps.MPS"><code class="xref py py-class docutils literal notranslate"><span class="pre">MPS</span></code></a> and
<a class="reference internal" href="reference/tenpy.networks.mpo.MPO.html#tenpy.networks.mpo.MPO" title="tenpy.networks.mpo.MPO"><code class="xref py py-class docutils literal notranslate"><span class="pre">MPO</span></code></a>.
The tensor network classes also use <a class="reference internal" href="reference/tenpy.linalg.np_conserved.Array.html#tenpy.linalg.np_conserved.Array" title="tenpy.linalg.np_conserved.Array"><code class="xref py py-class docutils literal notranslate"><span class="pre">Array</span></code></a> instances for the tensors of the represented network.</p>
<p>The following example illustrates the initialization of a spin-1/2 site, an <a class="reference internal" href="reference/tenpy.networks.mps.MPS.html#tenpy.networks.mps.MPS" title="tenpy.networks.mps.MPS"><code class="xref py py-class docutils literal notranslate"><span class="pre">MPS</span></code></a> representing the Neel state, and
an <a class="reference internal" href="reference/tenpy.networks.mpo.MPO.html#tenpy.networks.mpo.MPO" title="tenpy.networks.mpo.MPO"><code class="xref py py-class docutils literal notranslate"><span class="pre">MPO</span></code></a> representing the Heisenberg model by explicitly defining the <cite>W</cite> tensor.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot;Initialization of sites, MPS and MPO.&quot;&quot;&quot;</span>
<span class="c1"># Copyright 2019 TeNPy Developers, GNU GPLv3</span>

<span class="kn">from</span> <span class="nn">tenpy.networks.site</span> <span class="kn">import</span> <span class="n">SpinHalfSite</span>
<span class="kn">from</span> <span class="nn">tenpy.networks.mps</span> <span class="kn">import</span> <span class="n">MPS</span>
<span class="kn">from</span> <span class="nn">tenpy.networks.mpo</span> <span class="kn">import</span> <span class="n">MPO</span>

<span class="n">spin</span> <span class="o">=</span> <span class="n">SpinHalfSite</span><span class="p">(</span><span class="n">conserve</span><span class="o">=</span><span class="s2">&quot;Sz&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">spin</span><span class="o">.</span><span class="n">Sz</span><span class="o">.</span><span class="n">to_ndarray</span><span class="p">())</span>
<span class="c1"># [[ 0.5  0. ]</span>
<span class="c1">#  [ 0.  -0.5]]</span>

<span class="n">N</span> <span class="o">=</span> <span class="mi">6</span>  <span class="c1"># number of sites</span>
<span class="n">sites</span> <span class="o">=</span> <span class="p">[</span><span class="n">spin</span><span class="p">]</span> <span class="o">*</span> <span class="n">N</span>  <span class="c1"># repeat entry of list N times</span>
<span class="n">pstate</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;up&quot;</span><span class="p">,</span> <span class="s2">&quot;down&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">N</span> <span class="o">//</span> <span class="mi">2</span><span class="p">)</span>  <span class="c1"># Neel state</span>
<span class="n">psi</span> <span class="o">=</span> <span class="n">MPS</span><span class="o">.</span><span class="n">from_product_state</span><span class="p">(</span><span class="n">sites</span><span class="p">,</span> <span class="n">pstate</span><span class="p">,</span> <span class="n">bc</span><span class="o">=</span><span class="s2">&quot;finite&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&lt;Sz&gt; =&quot;</span><span class="p">,</span> <span class="n">psi</span><span class="o">.</span><span class="n">expectation_value</span><span class="p">(</span><span class="s2">&quot;Sz&quot;</span><span class="p">))</span>
<span class="c1"># &lt;Sz&gt; = [ 0.5 -0.5  0.5 -0.5]</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&lt;Sp_i Sm_j&gt; =&quot;</span><span class="p">,</span> <span class="n">psi</span><span class="o">.</span><span class="n">correlation_function</span><span class="p">(</span><span class="s2">&quot;Sp&quot;</span><span class="p">,</span> <span class="s2">&quot;Sm&quot;</span><span class="p">),</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="c1"># &lt;Sp_i Sm_j&gt; =</span>
<span class="c1"># [[1. 0. 0. 0. 0. 0.]</span>
<span class="c1">#  [0. 0. 0. 0. 0. 0.]</span>
<span class="c1">#  [0. 0. 1. 0. 0. 0.]</span>
<span class="c1">#  [0. 0. 0. 0. 0. 0.]</span>
<span class="c1">#  [0. 0. 0. 0. 1. 0.]</span>
<span class="c1">#  [0. 0. 0. 0. 0. 0.]]</span>

<span class="c1"># define an MPO</span>
<span class="n">Id</span><span class="p">,</span> <span class="n">Sp</span><span class="p">,</span> <span class="n">Sm</span><span class="p">,</span> <span class="n">Sz</span> <span class="o">=</span> <span class="n">spin</span><span class="o">.</span><span class="n">Id</span><span class="p">,</span> <span class="n">spin</span><span class="o">.</span><span class="n">Sp</span><span class="p">,</span> <span class="n">spin</span><span class="o">.</span><span class="n">Sm</span><span class="p">,</span> <span class="n">spin</span><span class="o">.</span><span class="n">Sz</span>
<span class="n">J</span><span class="p">,</span> <span class="n">Delta</span><span class="p">,</span> <span class="n">hz</span> <span class="o">=</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">0.2</span>
<span class="n">W_bulk</span> <span class="o">=</span> <span class="p">[[</span><span class="n">Id</span><span class="p">,</span> <span class="n">Sp</span><span class="p">,</span> <span class="n">Sm</span><span class="p">,</span> <span class="n">Sz</span><span class="p">,</span> <span class="o">-</span><span class="n">hz</span> <span class="o">*</span> <span class="n">Sz</span><span class="p">],</span> <span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">J</span> <span class="o">*</span> <span class="n">Sm</span><span class="p">],</span>
          <span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">J</span> <span class="o">*</span> <span class="n">Sp</span><span class="p">],</span> <span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">J</span> <span class="o">*</span> <span class="n">Delta</span> <span class="o">*</span> <span class="n">Sz</span><span class="p">],</span>
          <span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">Id</span><span class="p">]]</span>
<span class="n">W_first</span> <span class="o">=</span> <span class="p">[</span><span class="n">W_bulk</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>  <span class="c1"># first row</span>
<span class="n">W_last</span> <span class="o">=</span> <span class="p">[[</span><span class="n">row</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">W_bulk</span><span class="p">]</span>  <span class="c1"># last column</span>
<span class="n">Ws</span> <span class="o">=</span> <span class="p">[</span><span class="n">W_first</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="n">W_bulk</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">N</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="p">[</span><span class="n">W_last</span><span class="p">]</span>
<span class="n">H</span> <span class="o">=</span> <span class="n">MPO</span><span class="o">.</span><span class="n">from_grids</span><span class="p">([</span><span class="n">spin</span><span class="p">]</span> <span class="o">*</span> <span class="n">N</span><span class="p">,</span> <span class="n">Ws</span><span class="p">,</span> <span class="n">bc</span><span class="o">=</span><span class="s1">&#39;finite&#39;</span><span class="p">,</span> <span class="n">IdL</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">IdR</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&lt;psi|H|psi&gt; =&quot;</span><span class="p">,</span> <span class="n">H</span><span class="o">.</span><span class="n">expectation_value</span><span class="p">(</span><span class="n">psi</span><span class="p">))</span>
<span class="c1"># &lt;psi|H|psi&gt; = -1.25</span>
</pre></div>
</div>
</div>
<div class="section" id="models">
<h3>Models<a class="headerlink" href="#models" title="Permalink to this headline">¶</a></h3>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>See <a class="reference internal" href="intro_model.html"><span class="doc">Introduction to models</span></a> for more information on sites and how to define and extend models on your own.</p>
</div>
<p>Technically, the explicit definition of an <a class="reference internal" href="reference/tenpy.networks.mpo.MPO.html#tenpy.networks.mpo.MPO" title="tenpy.networks.mpo.MPO"><code class="xref py py-class docutils literal notranslate"><span class="pre">MPO</span></code></a> is already enough to call an algorithm like DMRG in <a class="reference internal" href="reference/tenpy.algorithms.dmrg.html#module-tenpy.algorithms.dmrg" title="tenpy.algorithms.dmrg"><code class="xref py py-mod docutils literal notranslate"><span class="pre">dmrg</span></code></a>.
However, writing down the <cite>W</cite> tensors is cumbersome especially for more complicated models.
Hence, TeNPy provides another layer of abstraction for the definition of models, which we discuss first.
Different kinds of algorithms require different representations of the Hamiltonian.
Therefore, the library offers to specify the model abstractly by the individual onsite terms and coupling terms of the Hamiltonian.
The following example illustrates this, again for the Heisenberg model.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot;Definition of a model: the XXZ chain.&quot;&quot;&quot;</span>
<span class="c1"># Copyright 2019 TeNPy Developers, GNU GPLv3</span>

<span class="kn">from</span> <span class="nn">tenpy.networks.site</span> <span class="kn">import</span> <span class="n">SpinSite</span>
<span class="kn">from</span> <span class="nn">tenpy.models.lattice</span> <span class="kn">import</span> <span class="n">Chain</span>
<span class="kn">from</span> <span class="nn">tenpy.models.model</span> <span class="kn">import</span> <span class="n">CouplingModel</span><span class="p">,</span> <span class="n">NearestNeighborModel</span><span class="p">,</span> <span class="n">MPOModel</span>


<span class="k">class</span> <span class="nc">XXZChain</span><span class="p">(</span><span class="n">CouplingModel</span><span class="p">,</span> <span class="n">NearestNeighborModel</span><span class="p">,</span> <span class="n">MPOModel</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">L</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">S</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">J</span><span class="o">=</span><span class="mf">1.</span><span class="p">,</span> <span class="n">Delta</span><span class="o">=</span><span class="mf">1.</span><span class="p">,</span> <span class="n">hz</span><span class="o">=</span><span class="mf">0.</span><span class="p">):</span>
        <span class="n">spin</span> <span class="o">=</span> <span class="n">SpinSite</span><span class="p">(</span><span class="n">S</span><span class="o">=</span><span class="n">S</span><span class="p">,</span> <span class="n">conserve</span><span class="o">=</span><span class="s2">&quot;Sz&quot;</span><span class="p">)</span>
        <span class="c1"># the lattice defines the geometry</span>
        <span class="n">lattice</span> <span class="o">=</span> <span class="n">Chain</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="n">spin</span><span class="p">,</span> <span class="n">bc</span><span class="o">=</span><span class="s2">&quot;open&quot;</span><span class="p">,</span> <span class="n">bc_MPS</span><span class="o">=</span><span class="s2">&quot;finite&quot;</span><span class="p">)</span>
        <span class="n">CouplingModel</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lattice</span><span class="p">)</span>
        <span class="c1"># add terms of the Hamiltonian</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_coupling</span><span class="p">(</span><span class="n">J</span> <span class="o">*</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;Sp&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;Sm&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>  <span class="c1"># Sp_i Sm_{i+1}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_coupling</span><span class="p">(</span><span class="n">J</span> <span class="o">*</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;Sp&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;Sm&quot;</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># Sp_i Sm_{i-1}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_coupling</span><span class="p">(</span><span class="n">J</span> <span class="o">*</span> <span class="n">Delta</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;Sz&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;Sz&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="c1"># (for site dependent prefactors, the strength can be an array)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_onsite</span><span class="p">(</span><span class="o">-</span><span class="n">hz</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;Sz&quot;</span><span class="p">)</span>

        <span class="c1"># finish initialization</span>
        <span class="c1"># generate MPO for DMRG</span>
        <span class="n">MPOModel</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lat</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">calc_H_MPO</span><span class="p">())</span>
        <span class="c1"># generate H_bond for TEBD</span>
        <span class="n">NearestNeighborModel</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lat</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">calc_H_bond</span><span class="p">())</span>
</pre></div>
</div>
<p>While this generates the same MPO as in the previous code, this example can easily be adjusted and generalized, for
example to a higher dimensional lattice by just specifying a different lattice.
Internally, the MPO is generated using a finite state machine picture.
This allows not only to translate more complicated Hamiltonians into their corresponding MPOs,
but also to automate the mapping from a higher dimensional lattice to the 1D chain along which the MPS
winds.
Note that this mapping introduces longer-range couplings, so the model can no longer be defined to be a
<a class="reference internal" href="reference/tenpy.models.model.NearestNeighborModel.html#tenpy.models.model.NearestNeighborModel" title="tenpy.models.model.NearestNeighborModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">NearestNeighborModel</span></code></a> suited for TEBD if another lattice than the <a class="reference internal" href="reference/tenpy.models.lattice.Chain.html#tenpy.models.lattice.Chain" title="tenpy.models.lattice.Chain"><code class="xref py py-class docutils literal notranslate"><span class="pre">Chain</span></code></a> is to be used.
Of course, many commonly studied models are also predefined.
For example, the following code initializes the Heisenberg model on a kagome lattice;
the spin liquid nature of the ground state of this model is highly debated in the current literature.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot;Initialization of the Heisenberg model on a kagome lattice.&quot;&quot;&quot;</span>
<span class="c1"># Copyright 2019 TeNPy Developers, GNU GPLv3</span>

<span class="kn">from</span> <span class="nn">tenpy.models.spins</span> <span class="kn">import</span> <span class="n">SpinModel</span>

<span class="n">model_params</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;S&quot;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span>  <span class="c1"># Spin 1/2</span>
    <span class="s2">&quot;lattice&quot;</span><span class="p">:</span> <span class="s2">&quot;Kagome&quot;</span><span class="p">,</span>
    <span class="s2">&quot;bc_MPS&quot;</span><span class="p">:</span> <span class="s2">&quot;infinite&quot;</span><span class="p">,</span>
    <span class="s2">&quot;bc_y&quot;</span><span class="p">:</span> <span class="s2">&quot;cylinder&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Ly&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>  <span class="c1"># defines cylinder circumference</span>
    <span class="s2">&quot;conserve&quot;</span><span class="p">:</span> <span class="s2">&quot;Sz&quot;</span><span class="p">,</span>  <span class="c1"># use Sz conservation</span>
    <span class="s2">&quot;Jx&quot;</span><span class="p">:</span> <span class="mf">1.</span><span class="p">,</span>
    <span class="s2">&quot;Jy&quot;</span><span class="p">:</span> <span class="mf">1.</span><span class="p">,</span>
    <span class="s2">&quot;Jz&quot;</span><span class="p">:</span> <span class="mf">1.</span>  <span class="c1"># Heisenberg coupling</span>
<span class="p">}</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">SpinModel</span><span class="p">(</span><span class="n">model_params</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="algorithms">
<h3>Algorithms<a class="headerlink" href="#algorithms" title="Permalink to this headline">¶</a></h3>
<p>The highest level in TeNPy is given by algorithms like DMRG and TEBD.
Using the previous concepts, setting up a simulation running those algorithms is a matter of just a few lines of code.
The following example runs a DMRG simulation, see <a class="reference internal" href="reference/tenpy.algorithms.dmrg.html#module-tenpy.algorithms.dmrg" title="tenpy.algorithms.dmrg"><code class="xref py py-mod docutils literal notranslate"><span class="pre">dmrg</span></code></a>, exemplary for the transverse field Ising model at the critical point.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot;Call of (finite) DMRG.&quot;&quot;&quot;</span>
<span class="c1"># Copyright 2019 TeNPy Developers, GNU GPLv3</span>

<span class="kn">from</span> <span class="nn">tenpy.networks.mps</span> <span class="kn">import</span> <span class="n">MPS</span>
<span class="kn">from</span> <span class="nn">tenpy.models.tf_ising</span> <span class="kn">import</span> <span class="n">TFIChain</span>
<span class="kn">from</span> <span class="nn">tenpy.algorithms</span> <span class="kn">import</span> <span class="n">dmrg</span>

<span class="n">N</span> <span class="o">=</span> <span class="mi">16</span>  <span class="c1"># number of sites</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">TFIChain</span><span class="p">({</span><span class="s2">&quot;L&quot;</span><span class="p">:</span> <span class="n">N</span><span class="p">,</span> <span class="s2">&quot;J&quot;</span><span class="p">:</span> <span class="mf">1.</span><span class="p">,</span> <span class="s2">&quot;g&quot;</span><span class="p">:</span> <span class="mf">1.</span><span class="p">,</span> <span class="s2">&quot;bc_MPS&quot;</span><span class="p">:</span> <span class="s2">&quot;finite&quot;</span><span class="p">})</span>
<span class="n">sites</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">lat</span><span class="o">.</span><span class="n">mps_sites</span><span class="p">()</span>
<span class="n">psi</span> <span class="o">=</span> <span class="n">MPS</span><span class="o">.</span><span class="n">from_product_state</span><span class="p">(</span><span class="n">sites</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;up&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">N</span><span class="p">,</span> <span class="s2">&quot;finite&quot;</span><span class="p">)</span>
<span class="n">dmrg_params</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;trunc_params&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;chi_max&quot;</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span> <span class="s2">&quot;svd_min&quot;</span><span class="p">:</span> <span class="mf">1.e-10</span><span class="p">},</span> <span class="s2">&quot;mixer&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">}</span>
<span class="n">info</span> <span class="o">=</span> <span class="n">dmrg</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">psi</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">dmrg_params</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;E =&quot;</span><span class="p">,</span> <span class="n">info</span><span class="p">[</span><span class="s1">&#39;E&#39;</span><span class="p">])</span>
<span class="c1"># E = -20.01638790048513</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;max. bond dimension =&quot;</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="n">psi</span><span class="o">.</span><span class="n">chi</span><span class="p">))</span>
<span class="c1"># max. bond dimension = 27</span>
</pre></div>
</div>
<p>The switch from DMRG to gls{iDMRG} in TeNPy is simply accomplished by a change of the parameter
<code class="docutils literal notranslate"><span class="pre">&quot;bc_MPS&quot;</span></code> from <code class="docutils literal notranslate"><span class="pre">&quot;finite&quot;</span></code> to <code class="docutils literal notranslate"><span class="pre">&quot;infinite&quot;</span></code>, both for the model and the state.
The returned <code class="docutils literal notranslate"><span class="pre">E</span></code> is then the energy density per site.
Due to the translation invariance, one can also evaluate the correlation length, here slightly away from the critical point.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot;Call of infinite DMRG.&quot;&quot;&quot;</span>
<span class="c1"># Copyright 2019 TeNPy Developers, GNU GPLv3</span>

<span class="kn">from</span> <span class="nn">tenpy.networks.mps</span> <span class="kn">import</span> <span class="n">MPS</span>
<span class="kn">from</span> <span class="nn">tenpy.models.tf_ising</span> <span class="kn">import</span> <span class="n">TFIChain</span>
<span class="kn">from</span> <span class="nn">tenpy.algorithms</span> <span class="kn">import</span> <span class="n">dmrg</span>

<span class="n">N</span> <span class="o">=</span> <span class="mi">2</span>  <span class="c1"># number of sites in unit cell</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">TFIChain</span><span class="p">({</span><span class="s2">&quot;L&quot;</span><span class="p">:</span> <span class="n">N</span><span class="p">,</span> <span class="s2">&quot;J&quot;</span><span class="p">:</span> <span class="mf">1.</span><span class="p">,</span> <span class="s2">&quot;g&quot;</span><span class="p">:</span> <span class="mf">1.1</span><span class="p">,</span> <span class="s2">&quot;bc_MPS&quot;</span><span class="p">:</span> <span class="s2">&quot;infinite&quot;</span><span class="p">})</span>
<span class="n">sites</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">lat</span><span class="o">.</span><span class="n">mps_sites</span><span class="p">()</span>
<span class="n">psi</span> <span class="o">=</span> <span class="n">MPS</span><span class="o">.</span><span class="n">from_product_state</span><span class="p">(</span><span class="n">sites</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;up&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">N</span><span class="p">,</span> <span class="s2">&quot;infinite&quot;</span><span class="p">)</span>
<span class="n">dmrg_params</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;trunc_params&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;chi_max&quot;</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span> <span class="s2">&quot;svd_min&quot;</span><span class="p">:</span> <span class="mf">1.e-10</span><span class="p">},</span> <span class="s2">&quot;mixer&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">}</span>
<span class="n">info</span> <span class="o">=</span> <span class="n">dmrg</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">psi</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">dmrg_params</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;E =&quot;</span><span class="p">,</span> <span class="n">info</span><span class="p">[</span><span class="s1">&#39;E&#39;</span><span class="p">])</span>
<span class="c1"># E = -1.342864022725017</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;max. bond dimension =&quot;</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="n">psi</span><span class="o">.</span><span class="n">chi</span><span class="p">))</span>
<span class="c1"># max. bond dimension = 56</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;corr. length =&quot;</span><span class="p">,</span> <span class="n">psi</span><span class="o">.</span><span class="n">correlation_length</span><span class="p">())</span>
<span class="c1"># corr. length = 4.915809146764157</span>
</pre></div>
</div>
<p>Running time evolution with TEBD requires an additional loop, during which the desired observables have to be measured.
The following code shows this directly for the infinite version of TEBD.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot;Call of (infinite) TEBD.&quot;&quot;&quot;</span>
<span class="c1"># Copyright 2019 TeNPy Developers, GNU GPLv3</span>

<span class="kn">from</span> <span class="nn">tenpy.networks.mps</span> <span class="kn">import</span> <span class="n">MPS</span>
<span class="kn">from</span> <span class="nn">tenpy.models.tf_ising</span> <span class="kn">import</span> <span class="n">TFIChain</span>
<span class="kn">from</span> <span class="nn">tenpy.algorithms</span> <span class="kn">import</span> <span class="n">tebd</span>

<span class="n">M</span> <span class="o">=</span> <span class="n">TFIChain</span><span class="p">({</span><span class="s2">&quot;L&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;J&quot;</span><span class="p">:</span> <span class="mf">1.</span><span class="p">,</span> <span class="s2">&quot;g&quot;</span><span class="p">:</span> <span class="mf">1.5</span><span class="p">,</span> <span class="s2">&quot;bc_MPS&quot;</span><span class="p">:</span> <span class="s2">&quot;infinite&quot;</span><span class="p">})</span>
<span class="n">psi</span> <span class="o">=</span> <span class="n">MPS</span><span class="o">.</span><span class="n">from_product_state</span><span class="p">(</span><span class="n">M</span><span class="o">.</span><span class="n">lat</span><span class="o">.</span><span class="n">mps_sites</span><span class="p">(),</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;infinite&quot;</span><span class="p">)</span>
<span class="n">tebd_params</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;order&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
    <span class="s2">&quot;delta_tau_list&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.001</span><span class="p">,</span> <span class="mf">1.e-5</span><span class="p">],</span>
    <span class="s2">&quot;max_error_E&quot;</span><span class="p">:</span> <span class="mf">1.e-6</span><span class="p">,</span>
    <span class="s2">&quot;trunc_params&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;chi_max&quot;</span><span class="p">:</span> <span class="mi">30</span><span class="p">,</span>
        <span class="s2">&quot;svd_min&quot;</span><span class="p">:</span> <span class="mf">1.e-10</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="n">eng</span> <span class="o">=</span> <span class="n">tebd</span><span class="o">.</span><span class="n">Engine</span><span class="p">(</span><span class="n">psi</span><span class="p">,</span> <span class="n">M</span><span class="p">,</span> <span class="n">tebd_params</span><span class="p">)</span>
<span class="n">eng</span><span class="o">.</span><span class="n">run_GS</span><span class="p">()</span>  <span class="c1"># imaginary time evolution with TEBD</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;E =&quot;</span><span class="p">,</span> <span class="nb">sum</span><span class="p">(</span><span class="n">psi</span><span class="o">.</span><span class="n">expectation_value</span><span class="p">(</span><span class="n">M</span><span class="o">.</span><span class="n">H_bond</span><span class="p">))</span> <span class="o">/</span> <span class="n">psi</span><span class="o">.</span><span class="n">L</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;final bond dimensions: &quot;</span><span class="p">,</span> <span class="n">psi</span><span class="o">.</span><span class="n">chi</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="index.html">
              <img class="logo" src="_static/logo.png" alt="Logo"/>
            </a></p>
  <h3><a href="index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Overview</a><ul>
<li><a class="reference internal" href="#repository">Repository</a></li>
<li><a class="reference internal" href="#code-structure-getting-started">Code structure: getting started</a><ul>
<li><a class="reference internal" href="#most-basic-level-linear-algebra">Most basic level: linear algebra</a></li>
<li><a class="reference internal" href="#sites-for-the-local-hilbert-space-and-tensor-networks">Sites for the local Hilbert space and tensor networks</a></li>
<li><a class="reference internal" href="#models">Models</a></li>
<li><a class="reference internal" href="#algorithms">Algorithms</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="INSTALL.html"
                        title="previous chapter">Installation instructions</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="literature.html"
                        title="next chapter">Literature</a></p>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
<h3><a href="index.html">Table of Contents</a></h3>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="userguide.html">User Guide</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="userguide.html#content">Content</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="INSTALL.html">Installation instructions</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="literature.html">Literature</a></li>
<li class="toctree-l3"><a class="reference internal" href="intro_npc.html">Introduction to np_conserved</a></li>
<li class="toctree-l3"><a class="reference internal" href="intro_model.html">Introduction to models</a></li>
<li class="toctree-l3"><a class="reference internal" href="intro_JordanWigner.html">Fermions and the Jordan-Wigner transformation</a></li>
<li class="toctree-l3"><a class="reference internal" href="contributing.html">Contributing</a></li>
<li class="toctree-l3"><a class="reference internal" href="todo.html">To-Do list</a></li>
<li class="toctree-l3"><a class="reference internal" href="changelog.html">CHANGELOG</a></li>
<li class="toctree-l3"><a class="reference internal" href="license.html">TeNPy developer team</a></li>
<li class="toctree-l3"><a class="reference internal" href="license.html#license">License</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="reference.html">Tenpy Reference</a></li>
</ul>

        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="literature.html" title="Literature"
             >next</a> |</li>
        <li class="right" >
          <a href="INSTALL.html" title="Installation instructions"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">TeNPy 0.4.1 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="userguide.html" >User Guide</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2016-2019, TeNPy Developers.
      Last updated on Dec 17, 2019.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 2.2.2.
    </div>
  </body>
</html>